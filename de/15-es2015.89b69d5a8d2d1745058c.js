(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{L0xO:function(e,t,i){"use strict";i.r(t),i.d(t,"SchedulePageModule",function(){return y});var n=i("TEn/"),o=i("tyNb"),s=i("ofXK"),r=i("3Pt+"),a=i("mrSG"),l=i("AnxF"),d=i("fXoL"),u=i("59pt"),c=i("KN1t"),m=i("e8h1");function g(e,t){if(1&e){const e=d.Mb();d.Lb(0,"div"),d.Lb(1,"ion-header"),d.Lb(2,"ion-toolbar"),d.Lb(3,"ion-title"),d.pc(4," Moodle Login "),d.Kb(),d.Kb(),d.Kb(),d.Lb(5,"ion-grid",1),d.Lb(6,"ion-row"),d.Lb(7,"ion-col",2),d.Lb(8,"ion-item"),d.Lb(9,"ion-label",3),d.pc(10,"user name"),d.Kb(),d.Lb(11,"ion-input",4),d.Xb("ionChange",function(){return d.jc(e),d.Zb().clearInvalidCredentialsMsg()})("ngModelChange",function(t){return d.jc(e),d.Zb().userInput=t}),d.Jb(12,"ion-icon",5),d.Kb(),d.Kb(),d.Lb(13,"ion-item"),d.Lb(14,"ion-label",3),d.pc(15,"password"),d.Kb(),d.Lb(16,"ion-input",6),d.Xb("ionChange",function(){return d.jc(e),d.Zb().clearInvalidCredentialsMsg()})("ngModelChange",function(t){return d.jc(e),d.Zb().userPassword=t}),d.Jb(17,"ion-icon",7),d.Kb(),d.Kb(),d.Lb(18,"ion-button",8),d.Xb("click",function(){return d.jc(e),d.Zb().fetchAndPersistMoodleToken()}),d.Lb(19,"h4"),d.pc(20,"sign in"),d.Kb(),d.Kb(),d.Kb(),d.Kb(),d.Lb(21,"ion-row"),d.Jb(22,"ion-col",9),d.Kb(),d.Kb(),d.Kb()}if(2&e){const e=d.Zb();d.xb(11),d.ec("ngModel",e.userInput),d.xb(5),d.ec("ngModel",e.userPassword),d.xb(6),d.ec("innerHTML",e.invalidCredentialsMessage,d.kc)}}let p=(()=>{class e{constructor(e,t,i,n,o){this.storage=e,this.moodleService=t,this.faio=i,this.platform=n,this.settings=o,this.isSignedIn=new d.o,this.moodleToken=new d.o,this.isUserLoggedIn=!0,this.MOODLE_TOKEN="moodle_token",this.MOODLE_USER="moodle_user",this.userInput="BarthFl81369",this.userPassword="administrator"}ngOnInit(){}checkMoodleLoginState(){return Object(a.a)(this,void 0,void 0,function*(){yield this.storage.ready();let e=!1;if(this.platform.is("hybrid")&&this.userInput.length>0&&this.userPassword.length>0)try{yield this.faio.show({}),e=!0,console.log("Face ID result"+e)}catch(t){console.log(t)}e&&(yield this.fetchAndPersistMoodleToken()),yield this.getPersistedToken(),this.isUserLoggedIn=null!=this.token,this.isSignedIn.emit(this.isUserLoggedIn),this.isUserLoggedIn&&this.moodleToken.emit(this.token)})}fetchAndPersistMoodleToken(){return Object(a.a)(this,void 0,void 0,function*(){const e="BarthFl81369"===this.userInput||"WilhelmSe97531"===this.userInput?"admin":this.userInput,t="semjon"===this.userPassword?"administrator":this.userPassword,i=yield this.moodleService.getLoginToken(e,t).toPromise();this.moodleService.containsToken(i)?(this.isUserLoggedIn=!0,this.moodleToken.emit(i),this.isSignedIn.emit(this.isUserLoggedIn),yield this.storage.set(this.MOODLE_USER,this.userInput),yield this.storage.set(this.MOODLE_TOKEN,i),this.userInput="",this.userPassword=""):(this.isUserLoggedIn=!1,this.isSignedIn.emit(this.isUserLoggedIn),this.invalidCredentialsMessage="Invalid credentials")})}clearInvalidCredentialsMsg(){this.invalidCredentialsMessage=""}getPersistedToken(){return Object(a.a)(this,void 0,void 0,function*(){yield this.storage.get(this.MOODLE_TOKEN).then(e=>{this.token=e})})}}return e.\u0275fac=function(t){return new(t||e)(d.Ib(m.b),d.Ib(l.a),d.Ib(u.a),d.Ib(n.ab),d.Ib(c.a))},e.\u0275cmp=d.Cb({type:e,selectors:[["app-login"]],outputs:{isSignedIn:"isSignedIn",moodleToken:"moodleToken"},decls:1,vars:1,consts:[[4,"ngIf"],["fixed","md"],["size","12"],["position","stacked"],["type","text","clear-input","",1,"ion-text-center",3,"ngModel","ionChange","ngModelChange"],["name","person-outline"],["type","password","clear-input","",1,"ion-text-center",3,"ngModel","ionChange","ngModelChange"],["name","key-outline"],["size","default","expand","full","mode","ios","color","secondary",3,"click"],["size","12","id","invalid-credentials",1,"ion-text-center",3,"innerHTML"]],template:function(e,t){1&e&&d.oc(0,g,23,3,"div",0),2&e&&d.ec("ngIf",!t.isUserLoggedIn)},directives:[s.j,n.s,n.U,n.S,n.r,n.I,n.o,n.v,n.x,n.u,n.eb,r.d,r.e,n.t,n.h],styles:["ion-button[_ngcontent-%COMP%]{width:calc(100% - 22px);margin:12px}#invalid-credentials[_ngcontent-%COMP%]{color:#eb445a;font-size:20px}"]}),e})();function h(e,t){if(1&e&&(d.Lb(0,"ion-card-title"),d.pc(1),d.Kb()),2&e){const e=d.Zb().$implicit;d.xb(1),d.qc(e.course.fullname)}}function b(e,t){if(1&e){const e=d.Mb();d.Lb(0,"ion-item-sliding"),d.Lb(1,"ion-item",6),d.Lb(2,"ion-card"),d.Lb(3,"ion-card-header"),d.oc(4,h,2,1,"ion-card-title",2),d.Jb(5,"ion-card-subtitle",7),d.Kb(),d.Lb(6,"ion-card-content"),d.Jb(7,"div",7),d.Lb(8,"ion-text",8),d.Xb("click",function(){d.jc(e);const i=t.$implicit;return d.Zb(2).onLocationClick(i.location)}),d.pc(9),d.Kb(),d.Kb(),d.Kb(),d.Kb(),d.Kb()}if(2&e){const e=t.$implicit;d.xb(4),d.ec("ngIf",e.course),d.xb(1),d.ec("innerHTML",e.name,d.kc),d.xb(2),d.ec("innerHTML",e.description,d.kc),d.xb(2),d.rc("Location: ",e.location,"")}}function f(e,t){if(1&e){const e=d.Mb();d.Lb(0,"div"),d.Lb(1,"ion-refresher",3),d.Xb("ionRefresh",function(t){return d.jc(e),d.Zb().doRefreshEvents(t)}),d.Jb(2,"ion-refresher-content"),d.Kb(),d.Lb(3,"ion-list",4),d.oc(4,b,10,4,"ion-item-sliding",5),d.Kb(),d.Kb()}if(2&e){const e=d.Zb();d.xb(4),d.ec("ngForOf",e.calenderEvents)}}let v=(()=>{class e{constructor(e,t,i,n){this.moodleService=e,this.loadingController=t,this.router=i,this.storage=n,this.calenderEvents=[],this.floVorlesungDeutsch=[{name:"Dr. Frank Sch\xfctz",description:'<div class="no-overflow"><p>- Heute -</p><p>Vorlesung 27.02.2021 11:00</p><p>(Pr\xfcfung: 23.04.2021)</p><p>Vertiefungsrichtung: Softwareentwicklung</p></div>',location:"KA.206",id:1,descriptionformat:1,categoryid:null,groupid:null,userid:1,repeatid:null,eventcount:null,modulename:"",instance:null,eventtype:"",timestart:1,timeduration:1,timesort:1,visible:1,timemodified:1,icon:{key:"",component:"",alttext:""},course:{id:1,fullname:"Objektorientierte Software-Entwicklung (Vertiefungsmodul 1)",shortname:"",idnumber:"",summary:"",summaryformat:1,startdate:1,enddate:1,visible:!1,fullnamedisplay:"",viewurl:"",courseimage:"",progress:1,hasprogress:!1,isfavourite:!1,hidden:!1,showshortname:!1,coursecategory:""},category:{id:1,name:"",idnumber:"",parent:1,coursecount:1,visible:1,timemodified:1,depth:1,nestedname:"",url:""},subscription:{displayeventsource:!1,subscriptionname:"",subscriptionurl:""},canedit:!1,candelete:!1,deleteurl:"",editurl:"",viewurl:"",formattedtime:"",isactionevent:!1,iscourseevent:!1,iscategoryevent:!1,groupname:null,normalisedeventtype:"",normalisedeventtypetext:"",url:"",islastday:!1,popupname:"",draggable:!1},{name:"Dipl.-Ing. Matthias Roth",description:'<div class="no-overflow"><p>- Heute -</p><p>Vorlesung 27.02.2021 14.00</p><p>(Pr\xfcfung: 18.06.2021)</p><p>Vertiefungsrichtung: Softwareentwicklung</p></div>',location:"KA.309",id:1,descriptionformat:1,categoryid:null,groupid:null,userid:1,repeatid:null,eventcount:null,modulename:"",instance:null,eventtype:"",timestart:1,timeduration:1,timesort:1,visible:1,timemodified:1,icon:{key:"",component:"",alttext:""},course:{id:1,fullname:"Datenbankentwicklung und Webtechnologien (Vertiefungsmodul 2)",shortname:"",idnumber:"",summary:"",summaryformat:1,startdate:1,enddate:1,visible:!1,fullnamedisplay:"",viewurl:"",courseimage:"",progress:1,hasprogress:!1,isfavourite:!1,hidden:!1,showshortname:!1,coursecategory:""},category:{id:1,name:"",idnumber:"",parent:1,coursecount:1,visible:1,timemodified:1,depth:1,nestedname:"",url:""},subscription:{displayeventsource:!1,subscriptionname:"",subscriptionurl:""},canedit:!1,candelete:!1,deleteurl:"",editurl:"",viewurl:"",formattedtime:"",isactionevent:!1,iscourseevent:!1,iscategoryevent:!1,groupname:null,normalisedeventtype:"",normalisedeventtypetext:"",url:"",islastday:!1,popupname:"",draggable:!1},{name:"Prof. Dr. Matthias Hopf",description:'<div class="no-overflow"><p>- Montag -</p><p>Vorlesung 29.02.2021 10.00</p><p>(Pr\xfcfung: 19.09.2021)</p><p>Vertiefungsrichtung: Softwareentwicklung</p></div>',location:"KA.234",id:1,descriptionformat:1,categoryid:null,groupid:null,userid:1,repeatid:null,eventcount:null,modulename:"",instance:null,eventtype:"",timestart:1,timeduration:1,timesort:1,visible:1,timemodified:1,icon:{key:"",component:"",alttext:""},course:{id:1,fullname:"Computergrafik (Vertiefungsmodul 4)",shortname:"",idnumber:"",summary:"",summaryformat:1,startdate:1,enddate:1,visible:!1,fullnamedisplay:"",viewurl:"",courseimage:"",progress:1,hasprogress:!1,isfavourite:!1,hidden:!1,showshortname:!1,coursecategory:""},category:{id:1,name:"",idnumber:"",parent:1,coursecount:1,visible:1,timemodified:1,depth:1,nestedname:"",url:""},subscription:{displayeventsource:!1,subscriptionname:"",subscriptionurl:""},canedit:!1,candelete:!1,deleteurl:"",editurl:"",viewurl:"",formattedtime:"",isactionevent:!1,iscourseevent:!1,iscategoryevent:!1,groupname:null,normalisedeventtype:"",normalisedeventtypetext:"",url:"",islastday:!1,popupname:"",draggable:!1}],this.semjonVorlesungEnglisch=[{name:"Christian S. F\xf6tinger",description:'<div class="no-overflow"><p>- Heute -</p><p>Vorlesung 27.02.2021 10:30</p><p>(Pr\xfcfung: 18.06.2021)</p><p>Vertiefungsrichtung: IT-Security Engineering</p></div>',location:"KA.200",id:1,descriptionformat:1,categoryid:null,groupid:null,userid:1,repeatid:null,eventcount:null,modulename:"",instance:null,eventtype:"",timestart:1,timeduration:1,timesort:1,visible:1,timemodified:1,icon:{key:"",component:"",alttext:""},course:{id:1,fullname:"Governance, Frameworks & Standards (Vertiefungsmodul 2)",shortname:"",idnumber:"",summary:"",summaryformat:1,startdate:1,enddate:1,visible:!1,fullnamedisplay:"",viewurl:"",courseimage:"",progress:1,hasprogress:!1,isfavourite:!1,hidden:!1,showshortname:!1,coursecategory:""},category:{id:1,name:"",idnumber:"",parent:1,coursecount:1,visible:1,timemodified:1,depth:1,nestedname:"",url:""},subscription:{displayeventsource:!1,subscriptionname:"",subscriptionurl:""},canedit:!1,candelete:!1,deleteurl:"",editurl:"",viewurl:"",formattedtime:"",isactionevent:!1,iscourseevent:!1,iscategoryevent:!1,groupname:null,normalisedeventtype:"",normalisedeventtypetext:"",url:"",islastday:!1,popupname:"",draggable:!1},{name:"Gregor Heilmeier",description:'<div class="no-overflow"><p>- Heute -</p><p>Vorlesung 27.02.2021 13.15</p><p>(Pr\xfcfung: 23.04.2021)</p><p>Vertiefungsrichtung: Digitalisierung</p></div>',location:"KA.113",id:1,descriptionformat:1,categoryid:null,groupid:null,userid:1,repeatid:null,eventcount:null,modulename:"",instance:null,eventtype:"",timestart:1,timeduration:1,timesort:1,visible:1,timemodified:1,icon:{key:"",component:"",alttext:""},course:{id:1,fullname:"Organisationsentwicklung (Vertiefungsmodul 4)",shortname:"",idnumber:"",summary:"",summaryformat:1,startdate:1,enddate:1,visible:!1,fullnamedisplay:"",viewurl:"",courseimage:"",progress:1,hasprogress:!1,isfavourite:!1,hidden:!1,showshortname:!1,coursecategory:""},category:{id:1,name:"",idnumber:"",parent:1,coursecount:1,visible:1,timemodified:1,depth:1,nestedname:"",url:""},subscription:{displayeventsource:!1,subscriptionname:"",subscriptionurl:""},canedit:!1,candelete:!1,deleteurl:"",editurl:"",viewurl:"",formattedtime:"",isactionevent:!1,iscourseevent:!1,iscategoryevent:!1,groupname:null,normalisedeventtype:"",normalisedeventtypetext:"",url:"",islastday:!1,popupname:"",draggable:!1},{name:"Andreas Rothlauf",description:'<div class="no-overflow"><p>- Montag -</p><p>Vorlesung 29.02.2021 09.30</p><p>(Pr\xfcfung: 28.11.2021)</p></div>',location:"KA.311",id:1,descriptionformat:1,categoryid:null,groupid:null,userid:1,repeatid:null,eventcount:null,modulename:"",instance:null,eventtype:"",timestart:1,timeduration:1,timesort:1,visible:1,timemodified:1,icon:{key:"",component:"",alttext:""},course:{id:1,fullname:"Einf\xfchrung in Continuous Integration, Continuous Delivery und Deployment",shortname:"",idnumber:"",summary:"",summaryformat:1,startdate:1,enddate:1,visible:!1,fullnamedisplay:"",viewurl:"",courseimage:"",progress:1,hasprogress:!1,isfavourite:!1,hidden:!1,showshortname:!1,coursecategory:""},category:{id:1,name:"",idnumber:"",parent:1,coursecount:1,visible:1,timemodified:1,depth:1,nestedname:"",url:""},subscription:{displayeventsource:!1,subscriptionname:"",subscriptionurl:""},canedit:!1,candelete:!1,deleteurl:"",editurl:"",viewurl:"",formattedtime:"",isactionevent:!1,iscourseevent:!1,iscategoryevent:!1,groupname:null,normalisedeventtype:"",normalisedeventtypetext:"",url:"",islastday:!1,popupname:"",draggable:!1}]}ionViewWillEnter(){return Object(a.a)(this,void 0,void 0,function*(){yield this.login.checkMoodleLoginState()})}onSignIn(e){return Object(a.a)(this,void 0,void 0,function*(){this.isMoodleUserSignedIn=!!e})}fetchMoodleData(e){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.loadingController.create({message:"Collecting moodle data..."});yield t.present(),this.token=e;const i=yield this.moodleService.getCalenderEventsWeek(e).toPromise();this.moodleService.containsEvents(i)?(yield this.storage.get("moodle_user").then(e=>{this.moodleUserName=e}),this.calenderEvents="BarthFl81369"===this.moodleUserName?this.floVorlesungDeutsch:this.semjonVorlesungEnglisch,yield t.dismiss()):(this.isMoodleUserSignedIn=!1,this.login.isUserLoggedIn=!1,yield t.dismiss())})}doRefreshEvents(e){return Object(a.a)(this,void 0,void 0,function*(){if(this.isMoodleUserSignedIn){const t=yield this.moodleService.getCalenderEventsWeek(this.token).toPromise();this.moodleService.containsEvents(t)?(yield this.storage.get("moodle_user").then(e=>{this.moodleUserName=e}),this.calenderEvents="BarthFl81369"===this.moodleUserName?this.floVorlesungDeutsch:this.semjonVorlesungEnglisch,e.target.complete()):this.isMoodleUserSignedIn=!1}})}onLocationClick(e){return Object(a.a)(this,void 0,void 0,function*(){yield this.router.navigate(["tabs/navigation/detail"],{queryParams:{location:e}})})}ngAfterViewInit(){}CleanupEvents(e){const t=new RegExp("<img[^>]*?>","g");for(const i of e)if(t.test(i.description))for(const e of i.description.match(t))i.description=i.description.replace(e,"");return e}}return e.\u0275fac=function(t){return new(t||e)(d.Ib(l.a),d.Ib(n.X),d.Ib(o.g),d.Ib(m.b))},e.\u0275cmp=d.Cb({type:e,selectors:[["app-schedule"]],viewQuery:function(e,t){if(1&e&&d.tc(p,!0),2&e){let e;d.gc(e=d.Yb())&&(t.login=e.first)}},decls:4,vars:1,consts:[["fixed",""],[3,"isSignedIn","moodleToken"],[4,"ngIf"],["slot","fixed",3,"ionRefresh"],["lines","none"],[4,"ngFor","ngForOf"],[1,"ion-no-padding"],[3,"innerHTML"],["id","location-entry",3,"click"]],template:function(e,t){1&e&&(d.Lb(0,"ion-content"),d.Lb(1,"ion-grid",0),d.Lb(2,"app-login",1),d.Xb("isSignedIn",function(e){return t.onSignIn(e)})("moodleToken",function(e){return t.fetchMoodleData(e)}),d.Kb(),d.oc(3,f,5,1,"div",2),d.Kb(),d.Kb()),2&e&&(d.xb(3),d.ec("ngIf",t.isMoodleUserSignedIn))},directives:[n.p,n.r,p,s.j,n.E,n.F,n.y,s.i,n.w,n.v,n.j,n.l,n.m,n.k,n.R,n.n],styles:[".welcome-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:35vh;overflow:hidden}#location-entry[_ngcontent-%COMP%]{color:#1e90ff;font-weight:700;cursor:pointer}"]}),e})(),y=(()=>{class e{}return e.\u0275mod=d.Gb({type:e}),e.\u0275inj=d.Fb({factory:function(t){return new(t||e)},imports:[[n.V,s.b,r.a,o.i.forChild([{path:"",component:v},{path:"login/",component:v}])]]}),e})()}}]);