!function(){function e(){var t=i([":search error|missing place request\u241fc583358f0f963680c102622c2f41dea5db729fb5\u241f8414130712017189041:Should this place be on Studi-Guide? ",":LINE_BREAK:",":START_LINK:Request a missing place",":CLOSE_LINK:"]);return e=function(){return t},t}function t(){var e=i([":search error|spelling check\u241f3149bc3f0a5c01aac3807ac5700243e6877464b2\u241f8075391416841215266:Make sure your search is spelled correctly."]);return t=function(){return e},e}function n(){var e=i([":search error|missing place request\u241fc583358f0f963680c102622c2f41dea5db729fb5\u241f8414130712017189041:Should this place be on Studi-Guide? ",":LINE_BREAK:",":START_LINK:Request a missing place",":CLOSE_LINK:"]);return n=function(){return e},e}function r(){var e=i([":search error|spelling check\u241f3149bc3f0a5c01aac3807ac5700243e6877464b2\u241f8075391416841215266:Make sure your search is spelled correctly."]);return r=function(){return e},e}function i(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function o(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=c(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function c(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"0Tit":function(e,t){var n="function"==typeof Float32Array;function r(e,t){return 1-3*t+3*e}function i(e,t){return 3*t-6*e}function o(e){return 3*e}function a(e,t,n){return((r(t,n)*e+i(t,n))*e+o(t))*e}function c(e,t,n){return 3*r(t,n)*e*e+2*i(t,n)*e+o(t)}function s(e){return e}e.exports=function(e,t,r,i){if(!(0<=e&&e<=1&&0<=r&&r<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&r===i)return s;for(var o=n?new Float32Array(11):new Array(11),u=0;u<11;++u)o[u]=a(.1*u,e,r);return function(n){return 0===n?0:1===n?1:a(function(t){for(var n=0,i=1;10!==i&&o[i]<=t;++i)n+=.1;--i;var s=n+(t-o[i])/(o[i+1]-o[i])*.1,u=c(s,e,r);return u>=.001?function(e,t,n,r){for(var i=0;i<4;++i){var o=c(t,n,r);if(0===o)return t;t-=(a(t,n,r)-e)/o}return t}(t,s,e,r):0===u?s:function(e,t,n,r,i){var o,c,s=0;do{(o=a(c=t+(n-t)/2,r,i)-e)>0?n=c:t=c}while(Math.abs(o)>1e-7&&++s<10);return c}(t,n,n+.1,e,r)}(n),t,i)}}},"6f8I":function(e,t){function n(){return"function"==typeof cancelAnimationFrame?cancelAnimationFrame:clearTimeout}function r(){return"function"==typeof requestAnimationFrame?requestAnimationFrame:function(e){return setTimeout(e,16)}}e.exports=function(e,t,i){"object"!=typeof i&&(i={});var o,a,c,s,u,l,h,d,f,b,p="number"==typeof i.minVelocity?i.minVelocity:5,m="number"==typeof i.amplitude?i.amplitude:.25,v="function"==typeof i.cancelAnimationFrame?i.cancelAnimationFrame:n(),g="function"==typeof i.requestAnimationFrame?i.requestAnimationFrame:r();return{start:function(){o=e(),l=f=s=h=0,a=new Date,v(c),v(b),c=g(w)},stop:function(){v(c),v(b);var t=e();u=t.x,d=t.y,a=Date.now(),(s<-p||s>p)&&(u+=l=m*s),(h<-p||h>p)&&(d+=f=m*h),b=g(y)},cancel:function(){v(c),v(b)}};function w(){var t=Date.now(),n=t-a;a=t;var r=e(),i=r.x-o.x,u=r.y-o.y;o=r;var l=1e3/(1+n);s=.8*i*l+.2*s,h=.8*u*l+.2*h,c=g(w)}function y(){var e=Date.now()-a,n=!1,r=0,i=0;l&&((r=-l*Math.exp(-e/342))>.5||r<-.5?n=!0:r=l=0),f&&((i=-f*Math.exp(-e/342))>.5||i<-.5?n=!0:i=f=0),n&&(t(u+r,d+i),b=g(y))}}},AMdQ:function(e,t){e.exports=function(e){!function(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],n=0;n<t.length;++n)if(e.hasOwnProperty(t[n]))throw new Error("Subject cannot be eventified, since it already has property '"+t[n]+"'")}(e);var t=function(e){var t=Object.create(null);return{on:function(n,r,i){if("function"!=typeof r)throw new Error("callback is expected to be a function");var o=t[n];return o||(o=t[n]=[]),o.push({callback:r,ctx:i}),e},off:function(n,r){if(void 0===n)return t=Object.create(null),e;if(t[n])if("function"!=typeof r)delete t[n];else for(var i=t[n],o=0;o<i.length;++o)i[o].callback===r&&i.splice(o,1);return e},fire:function(n){var r,i=t[n];if(!i)return e;arguments.length>1&&(r=Array.prototype.splice.call(arguments,1));for(var o=0;o<i.length;++o){var a=i[o];a.callback.apply(a.ctx,r)}return e}}}(e);return e.on=t.on,e.off=t.off,e.fire=t.fire,e}},AgEI:function(e,t){function n(e){return e.stopPropagation(),!1}function r(){}e.exports=function(e){if(e)return{capture:r,release:r};var t,i,o,a=!1;return{capture:function(e){a=!0,i=window.document.onselectstart,o=window.document.ondragstart,window.document.onselectstart=n,(t=e).ondragstart=n},release:function(){a&&(a=!1,window.document.onselectstart=i,t&&(t.ondragstart=o))}}}},QIvw:function(e,t){e.exports=function(){this.x=0,this.y=0,this.scale=1}},Vkd7:function(e,t){function n(e){return e&&e.parentElement&&e.style}e.exports=function(e,t){if(!n(e))throw new Error("panzoom requires DOM element to be attached to the DOM tree");var r=e.parentElement;return e.scrollTop=0,t.disableKeyboardInteraction||r.setAttribute("tabindex",0),{getBBox:function(){return{left:0,top:0,width:e.clientWidth,height:e.clientHeight}},getOwner:function(){return r},applyTransform:function(t){e.style.transformOrigin="0 0 0",e.style.transform="matrix("+t.scale+", 0, 0, "+t.scale+", "+t.x+", "+t.y+")"}}},e.exports.canAttach=n},cQc6:function(e,t){e.exports=function(e,t){for(var n=e[0],r=e[1],i=!1,o=0,a=t.length-1;o<t.length;a=o++){var c=t[o][0],s=t[o][1],u=t[a][1];s>r!=u>r&&n<(t[a][0]-c)*(r-s)/(u-s)+c&&(i=!i)}return i}},dwjH:function(e,t,n){var r=n("0Tit"),i={ease:r(.25,.1,.25,1),easeIn:r(.42,0,1,1),easeOut:r(0,0,.58,1),easeInOut:r(.42,0,.58,1),linear:r(0,0,1,1)};function o(){}function a(){var e=new Set,t=new Set,n=0;return{next:r,cancel:r,clearAll:function(){e.clear(),t.clear(),cancelAnimationFrame(n),n=0}};function r(e){t.add(e),n||(n=requestAnimationFrame(i))}function i(){n=0;var r=t;t=e,(e=r).forEach(function(e){e()}),e.clear()}}e.exports=function(e,t,n){var r=Object.create(null),a=Object.create(null),c="function"==typeof(n=n||{}).easing?n.easing:i[n.easing];c||(n.easing&&console.warn("Unknown easing function in amator: "+n.easing),c=i.ease);var s="function"==typeof n.step?n.step:o,u="function"==typeof n.done?n.done:o,l=function(e){if(!e)return"undefined"!=typeof window&&window.requestAnimationFrame?{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}:{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}};if("function"!=typeof e.next)throw new Error("Scheduler is supposed to have next(cb) function");if("function"!=typeof e.cancel)throw new Error("Scheduler is supposed to have cancel(handle) function");return e}(n.scheduler),h=Object.keys(t);h.forEach(function(n){r[n]=e[n],a[n]=t[n]-e[n]});var d,f=Math.max(1,.06*("number"==typeof n.duration?n.duration:400)),b=0;return d=l.next(function t(){var n=c(b/f);b+=1,function(t){h.forEach(function(n){e[n]=a[n]*t+r[n]})}(n),b<=f?(d=l.next(t),s(e)):(d=0,setTimeout(function(){u(e)},0))}),{cancel:function(){l.cancel(d),d=0}}},e.exports.makeAggregateRaf=a,e.exports.sharedScheduler=a()},fQX0:function(e,t,n){"use strict";var r=n("fWck"),i=n("dwjH"),o=n("AMdQ"),a=n("6f8I"),c=n("AgEI"),s=c(),u=c(!0),l=n("QIvw"),h=n("wyfB"),d=n("Vkd7");function f(e,t){var n=(t=t||{}).controller;if(n||(h.canAttach(e)?n=h(e,t):d.canAttach(e)&&(n=d(e,t))),!n)throw new Error("Cannot create panzoom for the current type of dom element");var c=n.getOwner(),f={x:0,y:0},p=!1,w=new l;n.initTransform&&n.initTransform(w);var y,x="function"==typeof t.filterKey?t.filterKey:m,k="number"==typeof t.pinchSpeed?t.pinchSpeed:1,S=t.bounds,R="number"==typeof t.maxZoom?t.maxZoom:Number.POSITIVE_INFINITY,C="number"==typeof t.minZoom?t.minZoom:0,I="number"==typeof t.boundsPadding?t.boundsPadding:.05,M="number"==typeof t.zoomDoubleClickSpeed?t.zoomDoubleClickSpeed:1.75,O=t.beforeWheel||m,L=t.beforeMouseDown||m,K="number"==typeof t.zoomSpeed?t.zoomSpeed:1,D=b(t.transformOrigin),F=t.enableTextSelection?u:s;!function(e){var t=typeof e;if("undefined"!==t&&"boolean"!==t&&!(v(e.left)&&v(e.top)&&v(e.bottom)&&v(e.right)))throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}(S),t.autocenter&&function(){var e,t,r=0,i=0,o=Q();if(o)r=o.left,i=o.top,e=o.right-o.left,t=o.bottom-o.top;else{var a=c.getBoundingClientRect();e=a.width,t=a.height}var s=n.getBBox();if(0!==s.width&&0!==s.height){var u=Math.min(e/s.width,t/s.height);w.x=-(s.left+s.width/2)*u+e/2+r,w.y=-(s.top+s.height/2)*u+t/2+i,w.scale=u}}();var J,P,N,B,A,T,E,_,V=0,j=!1,z=!1;A="smoothScroll"in t&&!t.smoothScroll?{start:m,stop:m,cancel:m}:a(function(){return{x:w.x,y:w.y}},function(e,t){Re(),Z(e,t)},t.smoothScroll);var W=!1;ie();var X={dispose:function(){oe()},moveBy:re,moveTo:Z,smoothMoveTo:function(e,t){re(e-w.x,t-w.y,!0)},centerOn:function(e){var t=e.ownerSVGElement;if(!t)throw new Error("ui element is required to be within the scene");var n=e.getBoundingClientRect(),r=n.left+n.width/2,i=n.top+n.height/2,o=t.getBoundingClientRect();re(o.width/2-r,o.height/2-i,!0)},zoomTo:Se,zoomAbs:ne,smoothZoom:xe,smoothZoomAbs:function(e,t,n){var r={scale:w.scale},o={scale:n};A.cancel(),Re(),E=i(r,o,{step:function(n){ne(e,t,n.scale)}})},showRectangle:function(e){var t=c.getBoundingClientRect(),n=q(t.width,t.height),r=e.right-e.left,i=e.bottom-e.top;if(!Number.isFinite(r)||!Number.isFinite(i))throw new Error("Invalid rectangle");var o=Math.min(n.x/r,n.y/i);w.x=-(e.left+r/2)*o+n.x/2,w.y=-(e.top+i/2)*o+n.y/2,w.scale=o},pause:function(){oe(),W=!0},resume:function(){W&&(ie(),W=!1)},isPaused:function(){return W},getTransform:function(){return w},getMinZoom:function(){return C},setMinZoom:function(e){C=e},getMaxZoom:function(){return R},setMaxZoom:function(e){R=e},getTransformOrigin:function(){return D},setTransformOrigin:function(e){D=b(e)},getZoomSpeed:function(){return K},setZoomSpeed:function(e){if(!Number.isFinite(e))throw new Error("Zoom speed should be a number");K=e}};o(X);var H="number"==typeof t.initialX?t.initialX:w.x,Y="number"==typeof t.initialY?t.initialY:w.y,G="number"==typeof t.initialZoom?t.initialZoom:w.scale;return H==w.x&&Y==w.y&&G==w.Scale||ne(H,Y,G),X;function q(e,t){if(n.getScreenCTM){var r=n.getScreenCTM(),i=r.d,o=r.f;f.x=e*r.a-r.e,f.y=t*i-o}else f.x=e,f.y=t;return f}function Z(e,t){w.x=e,w.y=t,$(),Le("pan"),ee()}function U(e,t){Z(w.x+e,w.y+t)}function $(){var e=Q();if(e){var t,r,i=!1,o={left:(r={x:(t=n.getBBox()).left*w.scale+w.x,y:t.top*w.scale+w.y}).x,top:r.y,right:t.width*w.scale+r.x,bottom:t.height*w.scale+r.y},a=e.left-o.right;return a>0&&(w.x+=a,i=!0),(a=e.right-o.left)<0&&(w.x+=a,i=!0),(a=e.top-o.bottom)>0&&(w.y+=a,i=!0),(a=e.bottom-o.top)<0&&(w.y+=a,i=!0),i}}function Q(){if(S){if("boolean"==typeof S){var e=c.getBoundingClientRect(),t=e.width,n=e.height;return{left:t*I,top:n*I,right:t*(1-I),bottom:n*(1-I)}}return S}}function ee(){p=!0,y=window.requestAnimationFrame(ae)}function te(e,t,n){if(g(e)||g(t)||g(n))throw new Error("zoom requires valid numbers");var r=w.scale*n;if(r<C){if(w.scale===C)return;n=C/w.scale}if(r>R){if(w.scale===R)return;n=R/w.scale}var i=q(e,t);w.x=i.x-n*(i.x-w.x),w.y=i.y-n*(i.y-w.y),S&&1===I&&1===C?(w.scale*=n,$()):$()||(w.scale*=n),Le("zoom"),ee()}function ne(e,t,n){te(e,t,n/w.scale)}function re(e,t,n){if(!n)return U(e,t);T&&T.cancel();var r=0,o=0;T=i({x:0,y:0},{x:e,y:t},{step:function(e){U(e.x-r,e.y-o),r=e.x,o=e.y}})}function ie(){c.addEventListener("mousedown",be,{passive:!1}),c.addEventListener("dblclick",fe,{passive:!1}),c.addEventListener("touchstart",se,{passive:!1}),c.addEventListener("keydown",ce,{passive:!1}),r.addWheelListener(c,we,{passive:!1}),ee()}function oe(){r.removeWheelListener(c,we),c.removeEventListener("mousedown",be),c.removeEventListener("keydown",ce),c.removeEventListener("dblclick",fe),c.removeEventListener("touchstart",se),y&&(window.cancelAnimationFrame(y),y=0),A.cancel(),ve(),ge(),F.release(),Me()}function ae(){p&&(p=!1,n.applyTransform(w),Le("transform"),y=0)}function ce(e){var t=0,n=0,r=0;if(38===e.keyCode?n=1:40===e.keyCode?n=-1:37===e.keyCode?t=1:39===e.keyCode?t=-1:189===e.keyCode||109===e.keyCode?r=1:187!==e.keyCode&&107!==e.keyCode||(r=-1),!x(e,t,n,r)){if(t||n){e.preventDefault(),e.stopPropagation();var i=c.getBoundingClientRect();re(.05*(o=Math.min(i.width,i.height))*t,.05*o*n)}if(r){var o,a=Ce(100*r);Se((o=D?ke():{x:(s=c.getBoundingClientRect()).width/2,y:s.height/2}).x,o.y,a)}var s}}function se(e){if(function(e){t.onTouch&&!t.onTouch(e)||(e.stopPropagation(),e.preventDefault())}(e),1===e.touches.length)return function(e){var t=ye(e.touches[0]);J=t;var n=q(t.x,t.y);P=n.x,N=n.y,A.cancel(),ue()}(e);2===e.touches.length&&(B=de(e.touches[0],e.touches[1]),_=!0,ue())}function ue(){j||(j=!0,document.addEventListener("touchmove",le),document.addEventListener("touchend",he),document.addEventListener("touchcancel",he))}function le(e){if(1===e.touches.length){e.stopPropagation();var t=q((l=ye(e.touches[0])).x,l.y),n=t.x-P,r=t.y-N;0!==n&&0!==r&&Ie(),P=t.x,N=t.y,re(n,r)}else if(2===e.touches.length){_=!0;var i=e.touches[0],o=e.touches[1],a=de(i,o),c=1+(a/B-1)*k,s=ye(i),u=ye(o);if(P=(s.x+u.x)/2,N=(s.y+u.y)/2,D){var l=ke();P=l.x,N=l.y}Se(P,N,c),B=a,e.stopPropagation(),e.preventDefault()}}function he(e){if(e.touches.length>0){var t=q((n=ye(e.touches[0])).x,n.y);P=t.x,N=t.y}else{var n,r=new Date;r-V<300&&(D?xe((n=ke()).x,n.y,M):xe(J.x,J.y,M)),V=r,Me(),ge()}}function de(e,t){var n=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.sqrt(n*n+r*r)}function fe(e){!function(e){t.onDoubleClick&&!t.onDoubleClick(e)||(e.preventDefault(),e.stopPropagation())}(e);var n=ye(e);D&&(n=ke()),xe(n.x,n.y,M)}function be(e){if(!L(e)){if(j)return e.stopPropagation(),!1;if(1===e.button&&null!==window.event||0===e.button){A.cancel();var t=ye(e),n=q(t.x,t.y);return P=n.x,N=n.y,document.addEventListener("mousemove",pe),document.addEventListener("mouseup",me),F.capture(e.target||e.srcElement),!1}}}function pe(e){if(!j){Ie();var t=ye(e),n=q(t.x,t.y),r=n.x-P,i=n.y-N;P=n.x,N=n.y,re(r,i)}}function me(){F.release(),Me(),ve()}function ve(){document.removeEventListener("mousemove",pe),document.removeEventListener("mouseup",me),z=!1}function ge(){document.removeEventListener("touchmove",le),document.removeEventListener("touchend",he),document.removeEventListener("touchcancel",he),z=!1,_=!1,j=!1}function we(e){if(!O(e)){A.cancel();var t=e.deltaY;e.deltaMode>0&&(t*=100);var n=Ce(t);if(1!==n){var r=D?ke():ye(e);Se(r.x,r.y,n),e.preventDefault()}}}function ye(e){var t=c.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}function xe(e,t,n){var r=w.scale,o={scale:r},a={scale:n*r};A.cancel(),Re(),E=i(o,a,{step:function(n){ne(e,t,n.scale)},done:Oe})}function ke(){var e=c.getBoundingClientRect();return{x:e.width*D.x,y:e.height*D.y}}function Se(e,t,n){return A.cancel(),Re(),te(e,t,n)}function Re(){E&&(E.cancel(),E=null)}function Ce(e){return 1-Math.sign(e)*Math.min(.25,Math.abs(K*e/128))}function Ie(){z||(Le("panstart"),z=!0,A.start())}function Me(){z&&(_||A.stop(),Le("panend"))}function Oe(){Le("zoomend")}function Le(e){X.fire(e,X)}}function b(e){if(e)return"object"==typeof e?(v(e.x)&&v(e.y)||p(e),e):void p()}function p(e){throw console.error(e),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join("\n"))}function m(){}function v(e){return Number.isFinite(e)}function g(e){return Number.isNaN?Number.isNaN(e):e!=e}e.exports=f,function(){if("undefined"!=typeof document){var e=document.getElementsByTagName("script");if(e){for(var t,n=0;n<e.length;++n){var r=e[n];if(r.src&&r.src.match(/\bpanzoom(\.min)?\.js/)){t=r;break}}if(t){var i=t.getAttribute("query");if(i){var o=t.getAttribute("name")||"pz",a=Date.now();!function e(){var n=document.querySelector(i);if(!n)return Date.now()-a<2e3?void setTimeout(e,100):void console.error("Cannot find the panzoom element",o);var r=function(e){for(var t=e.attributes,n={},r=0;r<t.length;++r){var i=c(t[r]);i&&(n[i.name]=i.value)}return n}(t);console.log(r),window[o]=f(n,r)}()}}}}function c(e){if(e.name&&"p"===e.name[0]&&"z"===e.name[1]&&"-"===e.name[2])return{name:e.name.substr(3),value:JSON.parse(e.value)}}}()},fWck:function(e,t){function n(e,t,n){e.addEventListener("wheel",t,n)}e.exports=n,e.exports.addWheelListener=n,e.exports.removeWheelListener=function(e,t,n){e.removeEventListener("wheel",t,n)}},sO0u:function(i,c,s){"use strict";s.r(c),s.d(c,"NavigationPageModule",function(){return it});var l=s("TEn/"),d=s("tyNb"),f=s("ofXK"),b=s("3Pt+"),p=s("mrSG"),m=s("EnSQ"),v=s("WdNr"),g=s("fXoL"),w=function(){function e(t){u(this,e),this.icon=t}return h(e,[{key:"render",value:function(e,t,n,r,i){var o=new Image;o.onload=function(){e.drawImage(o,t,n,r,i)},o.src="assets/"+this.icon}}]),e}(),y=s("cQc6"),x=function(){function e(t){u(this,e),this.mapItem=t,this.doAnim=!1}return h(e,[{key:"render",value:function(e){this.mapItem.Sections&&this.mapItem.Sections.length>0&&(e.beginPath(),this.renderSections(e),e.strokeStyle="#FFF",e.fillStyle=this.mapItem.Color,e.stroke(),e.fill(),e.closePath())}},{key:"startAnimation",value:function(e,t){var n=this;this.animationCallback=function(){if(!0===n.doAnim){e.save();var r=new Date;if(e.beginPath(),n.renderSections(e),e.lineWidth=1,e.strokeStyle=r.getSeconds()%2==0?"#FFF":"#000",e.fillStyle=r.getSeconds()%2==0?"#000":n.mapItem.Color,e.stroke(),e.fill(),e.closePath(),e.restore(),window.requestAnimationFrame(n.animationCallback),void 0!==t&&void 0!==t.renderer&&void 0!==t.floor){var i,o=a(t.renderer);try{for(o.s();!(i=o.n()).done;){i.value.render(e,t)}}catch(c){o.e(c)}finally{o.f()}}}},this.doAnim=!0,window.requestAnimationFrame(this.animationCallback)}},{key:"stopAnimation",value:function(e){this.doAnim=!1,this.animationCallback=null}},{key:"renderSections",value:function(e){e.moveTo(this.mapItem.Sections[0].Start.X,this.mapItem.Sections[0].Start.Y);for(var t=1;t<this.mapItem.Sections.length;t++)e.lineTo(this.mapItem.Sections[t].Start.X,this.mapItem.Sections[t].Start.Y);e.lineTo(this.mapItem.Sections[0].Start.X,this.mapItem.Sections[0].Start.Y)}},{key:"MapItem",get:function(){return this.mapItem}}]),e}(),k=function(){function e(t){u(this,e),this.location=t}return h(e,[{key:"render",value:function(e){e.font="12px Arial",e.textAlign="center",e.fillStyle="#000",e.fillText(this.location.Name,this.location.PathNode.Coordinate.X,this.location.PathNode.Coordinate.Y)}},{key:"startAnimation",value:function(e){}},{key:"stopAnimation",value:function(e){}},{key:"Location",get:function(){return this.location}}]),e}(),S=function(){function e(t){u(this,e),this.route=t}return h(e,[{key:"render",value:function(e,t){var n=new w("pin-sharp.png");this.route.Start.Floor===t.floor&&n.render(e,this.route.Start.Node.Coordinate.X-15,this.route.Start.Node.Coordinate.Y-30,30,30);var r=new w("flag-sharp.png");this.route.End.Floor===t.floor&&r.render(e,this.route.End.Node.Coordinate.X-5,this.route.End.Node.Coordinate.Y-30,30,30);var i=this.route.RouteSections.filter(function(e){return e.Floor===t.floor});if(null!=i){var o,c=a(i);try{for(c.s();!(o=c.n()).done;){var s=o.value;e.strokeStyle="#A00",e.lineWidth=3,e.beginPath(),e.moveTo(s.Route[0].Coordinate.X,s.Route[0].Coordinate.Y);for(var u=1;u<s.Route.length;u++)e.lineTo(s.Route[u].Coordinate.X,s.Route[u].Coordinate.Y);e.stroke(),e.closePath()}}catch(y){c.e(y)}finally{c.f()}var l,h=a(i);try{for(h.s();!(l=h.n()).done;){var d=l.value,f=d.Route.length,b=d.Distance,p=d.Route[Math.round((f-1)/2)].Coordinate.X,m=d.Route[Math.round((f-1)/2)].Coordinate.Y,v=e.measureText(b.toString()).width+14,g=parseInt("14px Arial",10)+14;e.fillStyle="#A00",e.fillRect(p-v/2,m-g/2,v,20),e.font="14px Arial",e.fillStyle="#FFF",e.fillText(b.toString(),p,m)}}catch(y){h.e(y)}finally{h.f()}}}},{key:"startAnimation",value:function(e){}},{key:"stopAnimation",value:function(e){}},{key:"Route",get:function(){return this.route}}]),e}(),R=function(){function e(){u(this,e)}return h(e,null,[{key:"GetMapItemRendererCanvas",value:function(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];e.push(new x(a))}return e}},{key:"GetLocationRendererCanvas",value:function(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];e.push(new k(a))}return e}},{key:"GetRouteRendererCanvas",value:function(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];e.push(new S(a))}return e}}]),e}(),C=s("fQX0"),I=s.n(C),M=["fab"];function O(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-fab-button",4),g.Wb("click",function(){g.ic(n);var e=t.index;return g.Yb().emitAnotherFloorToShow(e)}),g.Ib(1,"span",5),g.Jb()}if(2&e){var r=t.$implicit;g.xb(1),g.dc("innerHTML",r,g.jc)}}var L,K,D=((K=function(){function e(t){u(this,e),this._dataService=t,this.floorWithBuilding=new g.o}return h(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e.currentBuilding||void 0===this.currentBuilding){t.next=5;break}return t.next=3,this._dataService.get_building(this.currentBuilding).toPromise();case 3:n=t.sent,this.availableFloors=n.Floors;case 5:case"end":return t.stop()}},t,this)}))}},{key:"emitAnotherFloorToShow",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.floorWithBuilding.emit({floor:this.availableFloors[e],building:this.currentBuilding}),this.currentFloor=this.availableFloors[e];case 1:case"end":return t.stop()}},t,this)}))}}]),e}()).\u0275fac=function(e){return new(e||K)(g.Hb(m.a))},K.\u0275cmp=g.Bb({type:K,selectors:[["app-floor-button"]],viewQuery:function(e,t){var n;1&e&&g.sc(M,!0),2&e&&g.fc(n=g.Xb())&&(t.fab=n.first)},inputs:{currentBuilding:"currentBuilding",currentFloor:"currentFloor"},outputs:{floorWithBuilding:"floorWithBuilding"},features:[g.vb],decls:7,vars:3,consts:[["vertical","top","horizontal","end","slot","fixed"],["fab",""],["side","bottom"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"innerHTML"]],template:function(e,t){1&e&&(g.Kb(0,"ion-fab",0,1),g.Kb(2,"ion-fab-button"),g.Kb(3,"span"),g.oc(4),g.Jb(),g.Jb(),g.Kb(5,"ion-fab-list",2),g.nc(6,O,2,1,"ion-fab-button",3),g.Jb(),g.Jb()),2&e&&(g.xb(4),g.rc("",t.currentBuilding,".",t.currentFloor,""),g.xb(2),g.dc("ngForOf",t.availableFloors))},directives:[l.q,l.r,l.s,f.i],styles:[""]}),K),F=((L=function(){function e(t){u(this,e),this.dataService=t,this.clickThreshold=20,this.mapItemRenderer=[],this.locationRenderer=[],this.routeRenderer=[],this.locationClick=new g.o,this.mapScroll=new g.o}return h(e,[{key:"ngAfterViewInit",value:function(){var e=this;this.panZoomController||(this.panZoomController=I()(document.getElementById("map"),{maxZoom:2,minZoom:.25,initialZoom:.7,bounds:!0,boundsPadding:.1,onTouch:function(t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=1===t.touches.length,!n.t0){n.next=4;break}return n.next=4,e.onElementClick(t.touches[0].clientX,t.touches[0].clientY,t.target);case 4:return n.abrupt("return",!1);case 5:case"end":return n.stop()}},n)}))}}))}},{key:"showRoute",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.stopAllAnimations(),n.next=3,this.renderNavigationPage(e,t.Building,t.Floor);case 3:case"end":return n.stop()}},n,this)}))}},{key:"showDiscoveryLocation",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.stopAllAnimations(),t.next=3,this.dataService.get_locations_search(e).toPromise();case 3:if(null!==(n=t.sent)&&0!==n.length){t.next=6;break}throw new Error("Studi-Guide can't find "+e);case 6:return r=n[0],this.currentBuilding=r.Building,t.next=10,this.dataService.get_map_floor(this.currentBuilding,r.Floor).toPromise();case 10:return i=t.sent,this.mapItemRenderer=R.GetMapItemRendererCanvas.apply(R,o(i)),t.next=14,this.dataService.get_locations(r.Building,r.Floor).toPromise();case 14:return a=t.sent,t.abrupt("return",(this.locationRenderer=R.GetLocationRendererCanvas.apply(R,o(a)),this.clearMapCanvas(),this.createNewCanvasMap(),this.renderMapItems(),this.renderLocations(),this.displayPin(r.PathNode),this.currentFloor=r.Floor,this.CenterMap(r.PathNode.Coordinate.X,r.PathNode.Coordinate.Y),r));case 16:case"end":return t.stop()}},t,this)}))}},{key:"showFloor",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this.stopAllAnimations(),null==this.currentRoute){n.next=5;break}return n.next=3,this.renderNavigationPage(this.currentRoute,this.currentBuilding,e);case 3:n.next=13;break;case 5:return n.next=7,this.dataService.get_map_items("",e,t).toPromise();case 7:return r=n.sent,this.mapItemRenderer=R.GetMapItemRendererCanvas.apply(R,o(r)),this.createNewCanvasMap(),n.next=11,this.dataService.get_locations_items("",e,t).toPromise();case 11:i=n.sent,this.locationRenderer=R.GetLocationRendererCanvas.apply(R,o(i)),this.renderMapItems(),this.renderLocations();case 13:this.currentFloor=e,this.currentBuilding=t,this.FitMap();case 14:case"end":return n.stop()}},n,this)}))}},{key:"showDiscoveryMap",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.dataService.get_map_items(e,t,"").toPromise();case 2:return r=n.sent,this.mapItemRenderer=R.GetMapItemRendererCanvas.apply(R,o(r)),n.next=6,this.dataService.get_locations_items(e,t,"").toPromise();case 6:i=n.sent,this.locationRenderer=R.GetLocationRendererCanvas.apply(R,o(i)),this.createNewCanvasMap(),this.renderMapItems(),this.renderLocations(),this.currentFloor=t,this.FitMap();case 8:case"end":return n.stop()}},n,this)}))}},{key:"clearMapCanvas",value:function(){var e=document.getElementById("map").getContext("2d");null!=e&&e.clearRect(0,0,e.canvas.width,e.canvas.height)}},{key:"onClick",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.onElementClick(e.clientX,e.clientY,e.target);case 2:case"end":return t.stop()}},t,this)}))}},{key:"onElementClick",value:function(e,t,n){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){var i,o,c,s,l,d,f,b,p,m,v,g,w,x,k,S,R,C;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=this.panZoomController.getTransform(),o=function(){function e(){u(this,e)}return h(e,null,[{key:"transformInOriginCoordinate",value:function(e,t,n){var r=n.getBoundingClientRect(),i=(e.x-r.left)/t,o=(e.y-r.top)/t;return console.log("Transform x:"+e.x+" y:"+e.y+"  to coordinate: x:"+i+" y:"+o),{x:i,y:o}}}]),e}().transformInOriginCoordinate({x:e,y:t},i.scale,n),c=[o.x,o.y],null==this.currentRoute){r.next=18;break}s=[],l=a(this.getInteractiveStairWellMapItemRenderer(this.currentFloor));try{for(l.s();!(d=l.n()).done;)f=d.value,s.push(f.MapItem)}catch(I){l.e(I)}finally{l.f()}b=0,p=s;case 6:if(!(b<p.length)){r.next=18;break}m=p[b],v=[],g=a(m.Sections);try{for(g.s();!(w=g.n()).done;)x=w.value,v.push([x.Start.X,x.Start.Y])}catch(I){g.e(I)}finally{g.f()}if(!y(c,v)){r.next=15;break}return r.next=14,this.showNextFloor(m);case 14:return r.abrupt("return",void r.sent);case 15:b++,r.next=6;break;case 18:k=a(this.locationRenderer),r.prev=19,k.s();case 21:if((S=k.n()).done){r.next=28;break}if(R=S.value,C=R.Location,!(Math.abs(C.PathNode.Coordinate.X-c[0])<this.clickThreshold&&Math.abs(C.PathNode.Coordinate.Y-c[1])<this.clickThreshold)){r.next=26;break}return r.abrupt("return",void this.locationClick.emit(C));case 26:r.next=21;break;case 28:r.next=33;break;case 30:r.prev=30,r.t0=r.catch(19),k.e(r.t0);case 33:return r.prev=33,k.f(),r.finish(33);case 36:case"end":return r.stop()}},r,this,[[19,30,33,36]])}))}},{key:"renderNavigationPage",value:function(e,t,n){var r,i;return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function c(){var s,u,l,h,d,f,b,p,m;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.dataService.get_map_floor(t,n).toPromise();case 2:if(c.t1=r=c.sent,c.t0=null!==c.t1,!c.t0){c.next=6;break}c.t0=void 0!==r;case 6:if(!c.t0){c.next=10;break}c.t2=r,c.next=11;break;case 10:c.t2=new Array;case 11:return s=c.t2,c.next=14,this.dataService.get_locations(t,n).toPromise();case 14:if(c.t4=i=c.sent,c.t3=null!==c.t4,!c.t3){c.next=18;break}c.t3=void 0!==i;case 18:if(!c.t3){c.next=22;break}c.t5=i,c.next=23;break;case 22:c.t5=new Array;case 23:u=c.t5,l=a(e.RouteSections),c.prev=25,l.s();case 27:if((h=l.n()).done){c.next=40;break}if((d=h.value).Floor!==n||d.Building===t){c.next=38;break}return c.next=32,this.dataService.get_map_floor(d.Building,d.Floor).toPromise();case 32:return f=c.sent,s=s.concat(f),c.next=36,this.dataService.get_locations(d.Building,d.Floor).toPromise();case 36:b=c.sent,u=u.concat(b);case 38:c.next=27;break;case 40:c.next=45;break;case 42:c.prev=42,c.t6=c.catch(25),l.e(c.t6);case 45:return c.prev=45,l.f(),c.finish(45);case 48:this.mapItemRenderer=R.GetMapItemRendererCanvas.apply(R,o(s)),this.locationRenderer=R.GetLocationRendererCanvas.apply(R,o(u)),this.routeRenderer=R.GetRouteRendererCanvas(e),this.createNewCanvasMap(),this.currentBuilding=t,this.renderMapItems(),this.renderLocations(),this.renderRoutes({floor:n}),p=a(this.getInteractiveStairWellMapItemRenderer(n));try{for(p.s();!(m=p.n()).done;)m.value.startAnimation(this.renderingContext,{renderer:this.routeRenderer,floor:n})}catch(v){p.e(v)}finally{p.f()}this.currentRoute=e,this.currentFloor=n;case 52:case"end":return c.stop()}},c,this,[[25,42,45,48]])}))}},{key:"createNewCanvasMap",value:function(){var e,t=document.getElementById("map"),n=0,r=0,i=a(this.mapItemRenderer);try{for(i.s();!(e=i.n()).done;){var o=e.value.MapItem;if(o.Sections){var c,s=a(o.Sections);try{for(s.s();!(c=s.n()).done;){var l=c.value;l.End.X>r&&(r=l.End.X),l.End.Y>n&&(n=l.End.Y)}}catch(p){s.e(p)}finally{s.f()}}if(o.PathNodes){var d,f=a(o.PathNodes);try{for(f.s();!(d=f.n()).done;){var b=d.value;b.Coordinate.X>r&&(r=b.Coordinate.X),b.Coordinate.Y>n&&(n=b.Coordinate.Y)}}catch(p){f.e(p)}finally{f.f()}}}}catch(p){i.e(p)}finally{i.f()}this.renderingContext=function(){function e(){u(this,e)}return h(e,null,[{key:"setup",value:function(e,t,n){var r=this.GetPixelRatio();return e.width=t*r,e.height=n*r,e.style.width=t+"px",e.style.height=n+"px",this.getContext(e)}},{key:"getContext",value:function(e){var t=this.GetPixelRatio(),n=e.getContext("2d");return n.scale(t,t),n}},{key:"GetPixelRatio",value:function(){return window.devicePixelRatio||1}}]),e}().setup(t,r,n)}},{key:"displayPin",value:function(e){var t=e.Coordinate.X-15,n=e.Coordinate.Y-30;new w("pin-sharp.png").render(this.renderingContext,t,n,30,30)}},{key:"showNextFloor",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<this.currentRoute.RouteSections.length-1)){t.next=11;break}if(this.currentRoute.RouteSections[n].Floor!==e.Floor||this.currentRoute.RouteSections[n].Building!==e.Building){t.next=8;break}return this.currentFloor=this.currentRoute.RouteSections[n+1].Floor,this.currentBuilding=this.currentRoute.RouteSections[n+1].Building,t.next=7,this.showFloor(this.currentFloor,this.currentBuilding);case 7:return t.abrupt("return",void t.sent);case 8:n++,t.next=1;break;case 11:case"end":return t.stop()}},t,this)}))}},{key:"getInteractiveStairWellMapItemRenderer",value:function(e){var t,n=this,r=[],i=a(this.routeRenderer);try{for(i.s();!(t=i.n()).done;)for(var o=t.value,c=0;c<o.Route.RouteSections.length-1;c++)o.Route.RouteSections[c].Building===o.Route.RouteSections[c+1].Building&&r.push(o.Route.RouteSections[c].Route[o.Route.RouteSections[c].Route.length-1])}catch(d){i.e(d)}finally{i.f()}for(var s=[],u=function(){var t,r=h[l],i=a(n.mapItemRenderer);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.MapItem.Floor===e&&o.MapItem.PathNodes.filter(function(e){return e.Id===r.Id}).length>0&&s.push(o)}}catch(d){i.e(d)}finally{i.f()}},l=0,h=r;l<h.length;l++)u();return s}},{key:"stopAllAnimations",value:function(){var e,t=a(this.routeRenderer);try{for(t.s();!(e=t.n()).done;)e.value.stopAnimation(this.renderingContext)}catch(c){t.e(c)}finally{t.f()}var n,r=a(this.mapItemRenderer);try{for(r.s();!(n=r.n()).done;)n.value.stopAnimation(this.renderingContext)}catch(c){r.e(c)}finally{r.f()}var i,o=a(this.locationRenderer);try{for(o.s();!(i=o.n()).done;)i.value.stopAnimation(this.renderingContext)}catch(c){o.e(c)}finally{o.f()}}},{key:"renderMapItems",value:function(){var e,t=a(this.mapItemRenderer);try{for(t.s();!(e=t.n()).done;)e.value.render(this.renderingContext)}catch(n){t.e(n)}finally{t.f()}}},{key:"renderLocations",value:function(){var e,t=a(this.locationRenderer);try{for(t.s();!(e=t.n()).done;)e.value.render(this.renderingContext)}catch(n){t.e(n)}finally{t.f()}}},{key:"renderRoutes",value:function(e){var t,n=a(this.routeRenderer);try{for(n.s();!(t=n.n()).done;)t.value.render(this.renderingContext,e)}catch(r){n.e(r)}finally{n.f()}}},{key:"onFloorChangeByFloorButton",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.showAnotherFloorOfCurrentBuilding(e.floor,e.building);case 2:case"end":return t.stop()}},t,this)}))}},{key:"showAnotherFloorOfCurrentBuilding",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return le.progressIsVisible=!0,n.next=3,this.showFloor(e,t);case 3:le.progressIsVisible=!1;case 4:case"end":return n.stop()}},n,this)}))}},{key:"CenterMap",value:function(e,t){var n=this.calulateMovePosition(e,t);this.panZoomController.smoothMoveTo(n.x,n.y)}},{key:"calulateMovePosition",value:function(e,t){var n=document.getElementById("canvas-wrapper");return{x:n.clientWidth/2-e,y:n.parentElement.parentElement.clientHeight/2-t}}},{key:"MapSize",value:function(){return document.getElementById("map").getBoundingClientRect()}},{key:"FitMap",value:function(){var e=this.MapSize();this.CenterMap(e.width/2,e.height/2)}},{key:"CurrentRoute",get:function(){return this.currentRoute}},{key:"CurrentBuilding",get:function(){return this.currentBuilding}}]),e}()).\u0275fac=function(e){return new(e||L)(g.Hb(m.a))},L.\u0275cmp=g.Bb({type:L,selectors:[["app-map-view"]],outputs:{locationClick:"locationClick",mapScroll:"mapScroll"},decls:4,vars:2,consts:[["id","canvas-wrapper",1,"draggable"],[3,"currentBuilding","currentFloor","floorWithBuilding"],["id","map",3,"click"],["map",""]],template:function(e,t){1&e&&(g.Kb(0,"div",0),g.Kb(1,"app-floor-button",1),g.Wb("floorWithBuilding",function(e){return t.onFloorChangeByFloorButton(e)}),g.Jb(),g.Kb(2,"canvas",2,3),g.Wb("click",function(e){return t.onClick(e)}),g.Jb(),g.Jb()),2&e&&(g.xb(1),g.dc("currentBuilding",t.CurrentBuilding)("currentFloor",t.currentFloor))},directives:[D],styles:["body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{height:100%;width:100%}#canvas-wrapper[_ngcontent-%COMP%]{padding:2px;overflow:hidden;scrollbar-width:none;-ms-overflow-style:none}#canvas-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.draggable[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}"]}),L),J=s("tk/3"),P=["destinationSearchbar"],N=["startSearchBar"];function B(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-button",8),g.Wb("click",function(){return g.ic(n),g.Yb().emitDiscoveryEvent()}),g.Ib(1,"ion-icon",9),g.Jb()}}function A(e,t){1&e&&g.Ib(0,"span",10)}function T(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-button",5),g.Wb("click",function(){return g.ic(n),g.Yb(2).hideRouteSearchBar()}),g.Ib(1,"ion-icon",14),g.Jb()}}function E(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-item",0),g.Kb(1,"ion-searchbar",11,12),g.Wb("click",function(){return g.ic(n),g.Yb().onSearchBarHasFocus("startSearchBar")})("keydown",function(e){return g.ic(n),g.Yb().onKey(e,"startSearchBar")},!1,g.hc),g.Jb(),g.nc(3,T,2,0,"ion-button",13),g.Jb()}if(2&e){var r=g.Yb();g.xb(1),g.dc("value",r.startSearchBarValue),g.xb(2),g.dc("ngIf",r.closeRouteBtnIsVisible)}}var _,V,j,z=((_=function(){function e(){u(this,e),this.discovery=new g.o,this.route=new g.o,this.searchBarFocus=new g.o,this.searchBtnIsVisible=!0,this.routeInputIsVisible=!1,this.closeRouteBtnIsVisible=!1}return h(e,[{key:"ngOnInit",value:function(){}},{key:"showRouteSearchBar",value:function(){this.routeInputIsVisible=!0,this.searchBtnIsVisible=!1,this.closeRouteBtnIsVisible=!0}},{key:"hideRouteSearchBar",value:function(){this.routeInputIsVisible&&(this.routeInputIsVisible=!1,this.searchBtnIsVisible=!0,this.closeRouteBtnIsVisible=!1)}},{key:"routeBtnClick",value:function(){this.routeInputIsVisible?this.emitRouteEvent():this.showRouteSearchBar()}},{key:"emitDiscoveryEvent",value:function(){var e=""===this.destinationSearchbar.value||void 0===this.destinationSearchbar.value;if(!(e=e||null===this.destinationSearchbar.value)){var t=document.activeElement;t&&t.blur&&t.blur(),this.discovery.emit(this.destinationSearchbar.value)}}},{key:"emitRouteEvent",value:function(){var e=""===this.destinationSearchbar.value||void 0===this.destinationSearchbar.value;e=e||null===this.destinationSearchbar.value;var t=""===this.startSearchBar.value||void 0===this.startSearchBar.value;if(t=t||null===this.startSearchBar.value,!e&&!t){var n=[this.startSearchBar.value,this.destinationSearchbar.value],r=document.activeElement;r&&r.blur&&r.blur(),this.route.emit(n)}}},{key:"clearDestinationInput",value:function(){this.destinationSearchbar.value=""}},{key:"clearStartInput",value:function(){this.startSearchBar.value=""}},{key:"setDiscoverySearchbarValue",value:function(e){this.destinationSearchbarValue=e}},{key:"setStartSearchbarValue",value:function(e){this.startSearchBarValue=e}},{key:"onSearchBarHasFocus",value:function(e){this.searchBarFocus.emit(e)}},{key:"onKey",value:function(e,t){"Enter"===e.key&&("destinationSearchbar"===t&&this.emitDiscoveryEvent(),"startSearchBar"===t&&this.emitRouteEvent())}}]),e}()).\u0275fac=function(e){return new(e||_)},_.\u0275cmp=g.Bb({type:_,selectors:[["app-search-input"]],viewQuery:function(e,t){var n;1&e&&(g.sc(P,!0),g.sc(N,!0)),2&e&&(g.fc(n=g.Xb())&&(t.destinationSearchbar=n.first),g.fc(n=g.Xb())&&(t.startSearchBar=n.first))},outputs:{discovery:"discovery",route:"route",searchBarFocus:"searchBarFocus"},decls:8,vars:4,consts:[["lines","none"],["search-icon","navigate-circle-outline","inputmode","text","mode","ios","placeholder","destination","color","","icon-color","dark",3,"value","click","keydown"],["destinationSearchbar",""],["size","default","mode","ios","color","medium",3,"click",4,"ngIf"],["class","vertical-line",4,"ngIf"],["size","default","mode","ios","color","primary",3,"click"],["size","large","slot","icon-only","src","assets/navigation-svgs/directions-24px.svg"],["lines","none",4,"ngIf"],["size","default","mode","ios","color","medium",3,"click"],["size","large","slot","icon-only","name","search","color",""],[1,"vertical-line"],["animated","true","color","","icon-color","dark","inputmode","text","mode","ios","placeholder","start","search-icon","locate-outline",3,"value","click","keydown"],["startSearchBar",""],["size","default","mode","ios","color","primary",3,"click",4,"ngIf"],["size","large","slot","icon-only","name","close-outline"]],template:function(e,t){1&e&&(g.Kb(0,"ion-item",0),g.Kb(1,"ion-searchbar",1,2),g.Wb("click",function(){return t.onSearchBarHasFocus("destinationSearchbar")})("keydown",function(e){return t.onKey(e,"destinationSearchbar")},!1,g.hc),g.Jb(),g.nc(3,B,2,0,"ion-button",3),g.nc(4,A,1,0,"span",4),g.Kb(5,"ion-button",5),g.Wb("click",function(){return t.routeBtnClick()}),g.Ib(6,"ion-icon",6),g.Jb(),g.Jb(),g.nc(7,E,4,2,"ion-item",7)),2&e&&(g.xb(1),g.dc("value",t.destinationSearchbarValue),g.xb(2),g.dc("ngIf",t.searchBtnIsVisible),g.xb(1),g.dc("ngIf",t.searchBtnIsVisible),g.xb(3),g.dc("ngIf",t.routeInputIsVisible))},directives:[l.y,l.K,l.eb,f.j,l.h,l.w],styles:["ion-searchbar[_ngcontent-%COMP%]{max-width:300px}"]}),_),W=s("+JbE"),X=s("YD5U"),H=function(){function e(t){u(this,e),this._campus=t,this._addressString=this.getAddressString(this._campus)}return h(e,[{key:"getAddressString",value:function(e){var t="";if(null!==e.edges.Address)for(var n=Y(e.edges.Address,function(e){return e.Street}),r=0,i=Object.keys(n);r<i.length;r++){var o=i[r],a=n[o];""!==t&&(t+="; ");var c=a[0].Number;a.length>1&&(c+="-"+a[a.length-1].Number),t+=o+" "+c+", ",t+=n[o][0].PLZ+" "+n[o][0].City}return t}},{key:"Address",get:function(){return this._addressString}},{key:"Name",get:function(){return this._campus.Name}},{key:"ShortName",get:function(){return this._campus.ShortName}},{key:"LatLng",get:function(){return{lat:this._campus.Latitude,lng:this._campus.Longitude}}}]),e}(),Y=function(e,t){return e.reduce(function(e,n){var r=t(n);return e[r]||(e[r]=[]),e[r].push(n),e},{})},G=s("e8h1"),q=((j=function(){function e(t){u(this,e),this.storage=t}return h(e,[{key:"addRecentSearch",value:function(t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.readRecentSearches();case 2:null!==(r=n.sent)&&0!==r.length||(r=[]),i=-1,o=0;case 6:if(!(o<r.length)){n.next=13;break}if(r[o].Name!==t.Name){n.next=10;break}return i=o,n.abrupt("break",13);case 10:o++,n.next=6;break;case 13:return i>=0&&r.splice(i,1),r.unshift(t),r.length>3&&r.pop(),n.next=18,this.storage.set(e.recentSearchesKey,JSON.stringify([r]));case 18:console.log(r);case 19:case"end":return n.stop()}},n,this)}))}},{key:"readRecentSearches",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,this.storage.get(e.recentSearchesKey);case 3:return t.t1=t.sent,n=t.t0.parse.call(t.t0,t.t1),t.abrupt("return",null!=n?n[0]:[]);case 6:case"end":return t.stop()}},t,this)}))}}]),e}()).recentSearchesKey="searches",j.\u0275fac=function(e){return new(e||j)(g.Sb(G.b))},j.\u0275prov=g.Db({token:j,factory:j.\u0275fac,providedIn:"root"}),j),Z=((V=function(){function e(t){var n=this;u(this,e),this.recentSearchesService=t,this.recentSearchesVar=[],this.availableCampus=[],this.Route={Start:{Name:"",LatLng:{lat:0,lng:0}},Destination:{Name:"",LatLng:{lat:0,lng:0}},Coordinates:[],Distance:0,NavigationInstructions:[],Time:0},this.recentSearchesService.readRecentSearches().then(function(e){n.recentSearchesVar=e})}return h(e,[{key:"addRecentSearch",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.recentSearchesService.addRecentSearch(e);case 2:return t.next=4,this.recentSearchesService.readRecentSearches();case 4:this.recentSearchesVar=t.sent;case 5:case"end":return t.stop()}},t,this)}))}},{key:"addRecentSearchCampus",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={Name:e.Name,Description:e.ShortName,Information:[["ShortName: ",e.ShortName],["Longitude: ",e.Longitude],["Latitude: ",e.Latitude]],DetailRouterParams:{},RouteRouterParams:{},LatLng:{lat:e.Latitude,lng:e.Longitude}},t.next=3,this.addRecentSearch(n);case 3:case"end":return t.stop()}},t,this)}))}},{key:"addRecentSearchBuilding",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r={Name:e.Name,Description:"Campus:"+e.Campus,Information:[],DetailRouterParams:{building:e.Name},RouteRouterParams:{},LatLng:t},n.next=3,this.addRecentSearch(r);case 3:case"end":return n.stop()}},n,this)}))}},{key:"addRecentSearchLocation",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[["Building: ",e.Name]],e.Tags&&r.push(["Tags: ",e.Tags.join(", ")]),i={Name:e.Name,Description:e.Description,Information:r,DetailRouterParams:{location:e.Name},RouteRouterParams:{start:e.Building+".Entrance",destination:e.Name},LatLng:t},n.next=5,this.addRecentSearch(i);case 5:case"end":return n.stop()}},n,this)}))}},{key:"SetOsmRouteAsRoute",value:function(e,t,n){var r,i=[],o=a(e.Points.Coordinates);try{for(o.s();!(r=o.n()).done;){var c=r.value;i.push([c.Lat,c.Lng])}}catch(s){o.e(s)}finally{o.f()}this.Route={Start:t,Destination:n,Coordinates:i,Distance:Math.round(e.Distance),NavigationInstructions:e.Instructions,Time:Math.round(e.Time/1e3/60)}}},{key:"ClearRoute",value:function(){this.Route={Start:{Name:"",LatLng:{lat:0,lng:0}},Destination:{Name:"",LatLng:{lat:0,lng:0}},Distance:0,Coordinates:[],NavigationInstructions:[],Time:0}}},{key:"latestSearchResult",get:function(){return void 0!==this.recentSearches[0]?this.recentSearches[0]:{Name:"",Description:"",Information:[],DetailRouterParams:{},RouteRouterParams:{},LatLng:{lat:0,lng:0}}}},{key:"recentSearches",get:function(){return this.recentSearchesVar}}]),e}()).\u0275fac=function(e){return new(e||V)(g.Sb(q))},V.\u0275prov=g.Db({token:V,factory:V.\u0275fac,providedIn:"root"}),V),U=s("gcOT"),$=["drawerContent"],Q=["searchDrawer"],ee=["locationDrawer"];function te(e,t){1&e&&g.Ib(0,"ion-progress-bar",37)}function ne(e,t){if(1&e&&(g.Kb(0,"ion-text",38),g.Kb(1,"h5"),g.Kb(2,"span",39),g.oc(3),g.Jb(),g.Jb(),g.Kb(4,"p"),g.Ob(5,40),g.Jb(),g.Kb(6,"p"),g.Rb(7,41),g.Ib(8,"br"),g.Ib(9,"a",42),g.Pb(),g.Jb(),g.Jb()),2&e){var n=g.Yb();g.xb(3),g.pc(n.errorMessage)}}function re(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-item",43),g.Wb("click",function(){g.ic(n);var e=t.$implicit;return g.Yb().recentSearchClick(e)}),g.Kb(1,"ion-label"),g.Kb(2,"h2"),g.oc(3),g.Jb(),g.Jb(),g.Jb()}if(2&e){var r=t.$implicit;g.xb(3),g.pc(r)}}function ie(e,t){if(1&e&&(g.Kb(0,"ion-item"),g.Kb(1,"ion-label"),g.Kb(2,"h2"),g.oc(3),g.Jb(),g.Kb(4,"h3"),g.oc(5),g.Jb(),g.Jb(),g.Jb()),2&e){var n=t.$implicit;g.xb(3),g.rc("",n.ShortName,": ",n.Name,""),g.xb(2),g.pc(n.Address)}}function oe(e,t){if(1&e&&(g.Kb(0,"ion-row"),g.Kb(1,"ion-col"),g.oc(2),g.Jb(),g.Kb(3,"ion-col"),g.oc(4),g.Jb(),g.Jb()),2&e){var n=t.$implicit;g.xb(2),g.pc(n[0]),g.xb(2),g.pc(n[1])}}var ae,ce,se,ue=U.a.Keyboard,le=((ce=function(){function e(t,n,r,i,o,a){u(this,e),this.dataService=t,this.modalCtrl=n,this.route=r,this.router=i,this.model=o,this.platform=a,this.availableCampus=[],this.isSubscripted=!1}return h(e,[{key:"ngAfterViewInit",value:function(){this.locationDrawer.SetState(W.a.Hidden),this.searchDrawer.SetState(X.a.GetRecommendedDrawerStateForDevice())}},{key:"ionViewDidEnter",value:function(){var e=this;!1===this.isSubscripted&&(this.isSubscripted=!0,this.route.queryParams.subscribe(function(t){return Object(p.a)(e,void 0,void 0,regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null!=t&&null!=t.location&&t.location.length>0)){e.next=5;break}return this.searchInput.setDiscoverySearchbarValue(t.location),e.next=4,this.onDiscovery(t.location);case 4:return e.abrupt("return",void e.sent);case 5:if(!(null!=t&&null!=t.start&&t.start.length>0&&null!=t.destination&&t.destination.length>0)){e.next=10;break}return e.next=8,this.showNavigation(t.start,t.destination);case 8:e.next=22;break;case 10:if(!(null!=t&&null!=t.building&&t.building.length>0)){e.next=20;break}return e.next=13,this.dataService.get_building(t.building).toPromise();case 13:if(r=e.sent,e.t0=null!==r,!e.t0){e.next=18;break}return e.next=18,this.mapView.showFloor((null===(n=r.Floors)||void 0===n?void 0:n.includes("EG"))?"EG":r.Floors[0],r.Name);case 18:e.next=22;break;case 20:return e.next=22,this.showDiscoveryMode();case 22:case"end":return e.stop()}},e,this)}))}))}},{key:"ngOnInit",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.model.availableCampus.length){e.next=6;break}return e.next=3,this.dataService.get_campus_search().toPromise();case 3:t=e.sent,n=a(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this.model.availableCampus.push(new H(i))}catch(o){n.e(o)}finally{n.f()}case 6:case"end":return e.stop()}},e,this)}))}},{key:"onDiscovery",value:function(t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.model.errorMessage="",e.progressIsVisible=!0,n.prev=1,n.next=4,this.mapView.showDiscoveryLocation(t);case 4:return r=n.sent,n.next=7,this.model.addRecentSearchLocation(r,{lat:0,lng:0});case 7:return n.next=9,this.showLocationDrawer(r);case 9:n.next=14;break;case 11:n.prev=11,n.t0=n.catch(1),this.handleInputError(n.t0,t);case 14:return n.prev=14,e.progressIsVisible=!1,n.finish(14);case 17:case"end":return n.stop()}},n,this,[[1,11,14,17]])}))}},{key:"onRoute",value:function(t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,o,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.errorMessage="",e.progressIsVisible=!0,n.prev=1,n.next=4,this.dataService.get_location(t[0]).toPromise();case 4:return r=n.sent,n.next=7,this.dataService.get_route(t[0],t[1]).toPromise();case 7:return i=n.sent,n.next=10,this.mapView.showRoute(i,r);case 10:this.mapView.CenterMap(r.PathNode.Coordinate.X,r.PathNode.Coordinate.Y),n.next=18;break;case 13:n.prev=13,n.t0=n.catch(1),o="",n.t0 instanceof J.d&&((a=n.t0.error.message).includes(t[0])&&(o=t[0]),a.includes(t[1])&&(o.length>0&&(o+=" and "),o+=t[1])),this.handleInputError(n.t0,0===o.length?t.toString():o);case 18:return n.prev=18,e.progressIsVisible=!1,n.finish(18);case 21:case"end":return n.stop()}},n,this,[[1,13,18,21]])}))}},{key:"onDrawerStateChange",value:function(e){void 0!==this.drawerContent&&(this.drawerContent.scrollY=e===W.a.Top)}},{key:"showLocationDrawer",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.locationDrawer.SetState(W.a.Hidden);case 2:if(this.model.latestSearchResult.Name=e.Name,this.model.latestSearchResult.Description=e.Description,this.model.latestSearchResult.Information=e.Tags?[["Tags: ",e.Tags.join(",")]]:[],t.t0=this.platform.is("hybrid"),!t.t0){t.next=9;break}return t.next=9,ue.hide();case 9:return t.next=11,this.searchDrawer.SetState(W.a.Hidden);case 11:return t.next=13,this.locationDrawer.SetState(X.a.GetRecommendedDrawerStateForDevice());case 13:case"end":return t.stop()}},t,this)}))}},{key:"onCloseLocationDrawer",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.locationDrawer.SetState(W.a.Hidden);case 2:return e.next=4,this.searchDrawer.SetState(X.a.GetRecommendedDrawerStateForDevice());case 4:case"end":return e.stop()}},e,this)}))}},{key:"presentAvailableFloorModal",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,i,o,c,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Array,e.next=3,this.dataService.get_buildings_search().toPromise();case 3:n=(n=e.sent).filter(function(e,t){return n.indexOf(e)===t}),r=a(n),e.prev=6,r.s();case 8:if((i=r.n()).done){e.next=16;break}return o=i.value,e.next=12,this.dataService.get_building(o.Name).toPromise();case 12:c=e.sent,t=t.concat(c.Floors);case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),r.e(e.t0);case 21:return e.prev=21,r.f(),e.finish(21);case 24:return t=t.filter(function(e,n){return t.indexOf(e)===n}),e.next=27,this.modalCtrl.create({component:v.a,cssClass:"floor-modal",componentProps:{floors:t}});case 27:return s=e.sent,e.next=30,s.present();case 30:return e.next=32,s.onDidDismiss();case 32:if(u=e.sent,e.t1=u.data,!e.t1){e.next=37;break}return e.next=37,this.mapView.showAnotherFloorOfCurrentBuilding(u.data,this.mapView.CurrentBuilding);case 37:case"end":return e.stop()}},e,this,[[6,18,21,24]])}))}},{key:"handleInputError",value:function(e,t){if(console.log(e),e instanceof J.d){var n=e;this.errorMessage=400===n.status?"Studi-Guide can't find "+t:n.message}else this.errorMessage=e.message;null!=this.mapView&&this.mapView.clearMapCanvas()}},{key:"navigationBtnClick",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null==this.model.latestSearchResult){t.next=16;break}return t.prev=1,t.next=4,this.dataService.get_location(this.model.latestSearchResult.Name).toPromise();case 4:return n=t.sent,t.next=7,this.showNavigation(n.Building+".Entrance",n.Name);case 7:t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),r="",t.t0 instanceof J.d&&t.t0.error.message.includes(this.model.latestSearchResult.Name)&&(r=this.model.latestSearchResult.Name),this.handleInputError(t.t0,0===r.length?this.model.latestSearchResult.Name:r);case 13:return t.prev=13,e.progressIsVisible=!1,t.finish(13);case 16:case"end":return t.stop()}},t,this,[[1,9,13,16]])}))}},{key:"showNavigation",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.searchInput.showRouteSearchBar(),this.searchInput.setDiscoverySearchbarValue(t),this.searchInput.setStartSearchbarValue(e),n.next=5,this.onCloseLocationDrawer(null);case 5:return n.next=7,this.onRoute([e,t]);case 7:case"end":return n.stop()}},n,this)}))}},{key:"showDiscoveryMode",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null==this.mapView.CurrentRoute&&null==this.mapView.CurrentBuilding,!e.t0){e.next=5;break}return e.next=4,this.mapView.showDiscoveryMap("","EG");case 4:this.mapView.CenterMap(310,550);case 5:case"end":return e.stop()}},e,this)}))}},{key:"recentSearchClick",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.router.navigate(["tabs/navigation/detail"],{queryParams:{location:e}});case 2:case"end":return t.stop()}},t,this)}))}},{key:"presentMapPage",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.router.navigate(["tabs/navigation/"]);case 2:case"end":return e.stop()}},e,this)}))}},{key:"ProgressIsVisible",get:function(){return e.progressIsVisible}}]),e}()).progressIsVisible=!1,ce.\u0275fac=function(e){return new(e||ce)(g.Hb(m.a),g.Hb(l.Z),g.Hb(d.a),g.Hb(d.g),g.Hb(Z),g.Hb(l.bb))},ce.\u0275cmp=g.Bb({type:ce,selectors:[["app-navigation"]],viewQuery:function(e,t){var n;1&e&&(g.sc(F,!0),g.sc(z,!0),g.sc($,!0),g.sc(Q,!0),g.sc(ee,!0)),2&e&&(g.fc(n=g.Xb())&&(t.mapView=n.first),g.fc(n=g.Xb())&&(t.searchInput=n.first),g.fc(n=g.Xb())&&(t.drawerContent=n.first),g.fc(n=g.Xb())&&(t.searchDrawer=n.first),g.fc(n=g.Xb())&&(t.locationDrawer=n.first))},decls:72,vars:7,consts:function(){return[["translucent",""],["slot","start"],["id","close-open-map","defaultHref","/"],["data-tap-disabled","true","scroll-y","false"],["type","indeterminate","color","secondary",4,"ngIf"],["id","map-content"],["id","error-message",4,"ngIf"],[3,"locationClick"],[3,"stateChange"],["searchDrawer",""],[1,"nav-bottom-drawer"],[1,"drawer-grip"],[1,"ion-padding-top"],[1,"nav-hbar"],[3,"discovery","route"],["drawerContent",""],["shape","round",1,"square-md","ion-no-padding",3,"click"],["slot","icon-only","name","business-outline","size","large"],["shape","round","color","medium",1,"square-md","ion-no-padding",3,"click"],["slot","icon-only","name","layers-outline","size","large"],["shape","round","color","dark",1,"square-md","ion-no-padding"],["slot","icon-only","name","library-outline","size","large"],[1,"ion-no-padding"],["button","",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"ion-padding-vertical"],["state","DrawerState.Hidden"],["locationDrawer",""],[1,"ion-padding-bottom"],["id","locationdrawerContent"],[1,"ion-justify-content-between","ion-align-self-center"],["size","auto"],["id","locationdrawerName"],[1,"ion-justify-content-end","ion-padding-horizontal"],["shape","round","color","medium",1,"square-sm","ion-no-padding","ion-float-right",3,"click"],["slot","icon-only","name","close-outline","size","small"],["id","routeBtn","color","primary","expand","block",3,"click"],["type","indeterminate","color","secondary"],["id","error-message"],[1,"error"],"\xDCberpr\xFCfe deine Eingabe auf Rechtschreibfehler.","Sollte dieser Ort im Studi-Guide sein?\n        " + "\ufffd#8\ufffd\ufffd/#8\ufffd" + "\n        " + "\ufffd#9\ufffd" + "F\xFCge den Ort hinzu" + "\ufffd/#9\ufffd" + "\n      ",["href","https://github.com/Studi-Guide/Studi-Guide/issues/new/choose"],["button","",3,"click"]]},template:function(e,t){1&e&&(g.Kb(0,"ion-header",0),g.Kb(1,"ion-toolbar"),g.Kb(2,"ion-buttons",1),g.Ib(3,"ion-back-button",2),g.Jb(),g.Jb(),g.Jb(),g.Kb(4,"ion-content",3),g.nc(5,te,1,0,"ion-progress-bar",4),g.Kb(6,"div",5),g.nc(7,ne,10,1,"ion-text",6),g.Kb(8,"app-map-view",7),g.Wb("locationClick",function(e){return t.showLocationDrawer(e)}),g.Jb(),g.Jb(),g.Jb(),g.Kb(9,"app-ionic-bottom-drawer",8,9),g.Wb("stateChange",function(e){return t.onDrawerStateChange(e)}),g.Kb(11,"div",10),g.Kb(12,"div",11),g.Ib(13,"div",12),g.Ib(14,"div",13),g.Kb(15,"app-search-input",14),g.Wb("discovery",function(e){return t.onDiscovery(e)})("route",function(e){return t.onRoute(e)}),g.Jb(),g.Jb(),g.Kb(16,"ion-content",null,15),g.Kb(18,"ion-grid"),g.Kb(19,"ion-list-header"),g.oc(20,"Current Campus"),g.Jb(),g.Kb(21,"ion-row"),g.Kb(22,"ion-col"),g.Kb(23,"ion-button",16),g.Wb("click",function(){return t.presentMapPage()}),g.Ib(24,"ion-icon",17),g.Jb(),g.Jb(),g.Kb(25,"ion-col"),g.Kb(26,"ion-button",18),g.Wb("click",function(){return t.presentAvailableFloorModal()}),g.Ib(27,"ion-icon",19),g.Jb(),g.Jb(),g.Kb(28,"ion-col"),g.Kb(29,"ion-button",20),g.Ib(30,"ion-icon",21),g.Jb(),g.Jb(),g.Ib(31,"ion-col"),g.Jb(),g.Jb(),g.Kb(32,"ion-list",22),g.Kb(33,"ion-list-header"),g.oc(34," Recent Searches "),g.Jb(),g.nc(35,re,4,1,"ion-item",23),g.Jb(),g.Kb(36,"ion-list",22),g.Kb(37,"ion-list-header"),g.oc(38," Choose a Campus "),g.Jb(),g.nc(39,ie,6,3,"ion-item",24),g.Jb(),g.Ib(40,"div",25),g.Ib(41,"div",25),g.Ib(42,"div",25),g.Ib(43,"div",25),g.Ib(44,"div",25),g.Ib(45,"div",25),g.Jb(),g.Jb(),g.Jb(),g.Kb(46,"app-ionic-bottom-drawer",26,27),g.Kb(48,"div",10),g.Kb(49,"div",11),g.Ib(50,"div",12),g.Ib(51,"div",13),g.Ib(52,"div",28),g.Jb(),g.Kb(53,"ion-content"),g.Kb(54,"ion-grid",29),g.Kb(55,"ion-row",30),g.Kb(56,"ion-col",31),g.Kb(57,"ion-text",32),g.oc(58),g.Jb(),g.Jb(),g.Kb(59,"ion-col",33),g.Kb(60,"ion-button",34),g.Wb("click",function(e){return t.onCloseLocationDrawer(e)}),g.Ib(61,"ion-icon",35),g.Jb(),g.Jb(),g.Jb(),g.Kb(62,"ion-row"),g.Kb(63,"ion-col"),g.Kb(64,"ion-button",36),g.Wb("click",function(){return t.navigationBtnClick()}),g.oc(65," Route "),g.Jb(),g.Jb(),g.Jb(),g.Kb(66,"ion-row"),g.Kb(67,"ion-col"),g.oc(68,"Description:"),g.Jb(),g.Kb(69,"ion-col"),g.oc(70),g.Jb(),g.Jb(),g.nc(71,oe,5,2,"ion-row",24),g.Jb(),g.Jb(),g.Jb(),g.Jb()),2&e&&(g.xb(5),g.dc("ngIf",t.ProgressIsVisible),g.xb(2),g.dc("ngIf",t.errorMessage),g.xb(28),g.dc("ngForOf",t.model.recentSearches),g.xb(4),g.dc("ngForOf",t.availableCampus),g.xb(19),g.pc(t.model.latestSearchResult.Name),g.xb(12),g.pc(t.model.latestSearchResult.Description),g.xb(1),g.dc("ngForOf",t.model.latestSearchResult.Information))},styles:["#map-content[_ngcontent-%COMP%]{height:100%;width:100%;position:fixed}.error[_ngcontent-%COMP%]{color:red}#error-message[_ngcontent-%COMP%]{margin-left:20px}#available-floors-btn[_ngcontent-%COMP%]{position:fixed;bottom:0;display:block;z-index:10}.center[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;display:block}ion-progress-bar[_ngcontent-%COMP%]{position:absolute;z-index:9999}.vertical-line[_ngcontent-%COMP%]{border-left:2px solid #9d9fa6;height:38px}.nav-hbar[_ngcontent-%COMP%]{border-top:2px solid var(--ion-color-medium,#9d9fa6);border-bottom:2px solid var(--ion-color-medium,#9d9fa6);border-radius:2px;height:0;width:auto;margin:0 45%}.nav-bottom-drawer[_ngcontent-%COMP%]{background-color:#fff;border-top-left-radius:20px;border-top-right-radius:20px;box-shadow:0 4px 8px 0 rgba(0,0,0,.4),0 6px 20px 0 rgba(0,0,0,.29);height:inherit;z-index:1}.square-md[_ngcontent-%COMP%]{height:64px;width:64px}.square-sm[_ngcontent-%COMP%]{height:32px;width:32px}.square-xs[_ngcontent-%COMP%]{height:16px;width:16px}#locationdrawerContent[_ngcontent-%COMP%]{margin-left:30px;margin-right:30px;position:center}#locationdrawerName[_ngcontent-%COMP%]{font-weight:700}"]}),ce),he=((ae=function e(){u(this,e)}).\u0275mod=g.Fb({type:ae}),ae.\u0275inj=g.Eb({factory:function(e){return new(e||ae)},imports:[[f.b,l.W]]}),ae),de=s("4R65"),fe=s("Bfh1"),be=s("AytR"),pe=((se=function(){function e(t,n,r){u(this,e),this.locale=t,this.httpClient=n,this.env=r}return h(e,[{key:"GetRoute",value:function(t,n){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.httpClient.get(this.env.serverUrl+e.serverPathPrefix+e.routePath+"?start="+t.lat+","+t.lng+"&end="+n.lat+","+n.lng+"&locale="+this.locale).toPromise();case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,this)}))}},{key:"GetBounds",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.httpClient.get(this.env.serverUrl+e.serverPathPrefix+e.boundsPath).toPromise();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}}]),e}()).serverPathPrefix="/osm",se.routePath="/route",se.boundsPath="/bounds",se.\u0275fac=function(e){return new(e||se)(g.Sb(g.v),g.Sb(J.b),g.Sb(be.a))},se.\u0275prov=g.Db({token:se,factory:se.\u0275fac,providedIn:"root"}),se),me=["ionSlides"];function ve(e,t){if(1&e&&(g.Kb(0,"ion-slide"),g.Kb(1,"ion-text"),g.Kb(2,"h2"),g.oc(3),g.Jb(),g.Kb(4,"p"),g.oc(5),g.Jb(),g.Jb(),g.Jb()),2&e){var n=t.$implicit;g.xb(3),g.pc(n.Text),g.xb(2),g.qc("",n.Distance,"m")}}var ge,we,ye=((we=function(){function e(t){u(this,e),this.element=t,this.nextSlide=new g.o,this.previousSlide=new g.o,this.slideOpts={initialSlide:0,speed:400}}return h(e,[{key:"ngOnInit",value:function(){this.hide()}},{key:"onPrevSlide",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this.previousSlide,e.next=3,this.ionSlides.getActiveIndex();case 3:e.t1=e.sent,e.t0.emit.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e,this)}))}},{key:"onNextSlide",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this.nextSlide,e.next=3,this.ionSlides.getActiveIndex();case 3:e.t1=e.sent,e.t0.emit.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e,this)}))}},{key:"hide",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.element.nativeElement.hidden=!0;case 1:case"end":return e.stop()}},e,this)}))}},{key:"show",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.element.nativeElement.hidden=!1;case 1:case"end":return e.stop()}},e,this)}))}}]),e}()).\u0275fac=function(e){return new(e||we)(g.Hb(g.m))},we.\u0275cmp=g.Bb({type:we,selectors:[["app-navigation-instruction-slides"]],viewQuery:function(e,t){var n;1&e&&g.sc(me,!0),2&e&&g.fc(n=g.Xb())&&(t.ionSlides=n.first)},inputs:{instructions:"instructions"},outputs:{nextSlide:"nextSlide",previousSlide:"previousSlide"},decls:3,vars:2,consts:[["pager","true",3,"options","ionSlideNextEnd","ionSlidePrevEnd"],["ionSlides",""],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(g.Kb(0,"ion-slides",0,1),g.Wb("ionSlideNextEnd",function(){return t.onNextSlide()})("ionSlidePrevEnd",function(){return t.onPrevSlide()}),g.nc(2,ve,6,2,"ion-slide",2),g.Jb()),2&e&&(g.dc("options",t.slideOpts),g.xb(2),g.dc("ngForOf",t.instructions))},directives:[l.O,f.i,l.N,l.S],styles:["[_nghost-%COMP%]{z-index:auto}ion-slide[_ngcontent-%COMP%]{height:100%;width:100%}@media (min-width:992px){ion-slide[_ngcontent-%COMP%]{padding-bottom:2em}}@media (max-width:991.98px){ion-slide[_ngcontent-%COMP%]{padding-bottom:.5em}}"]}),we),xe=((ge=function(){function e(){u(this,e)}return h(e,[{key:"load",value:function(t,n,r){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t.ready().then(function(){return Object(p.a)(o,void 0,void 0,regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.get(e.LAST_MAP_EVENT_KEY).then(function(e){n.setView([49.452368,11.093299],r),null!=e&&n.flyTo(e.center,e.zoom)});case 2:case"end":return i.stop()}},i)}))});case 1:case"end":return i.stop()}},i)}))}}],[{key:"persist",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.set(this.LAST_MAP_EVENT_KEY,t);case 2:case"end":return n.stop()}},n,this)}))}}]),e}()).LAST_MAP_EVENT_KEY="lastOpenStreetMapEventTarget",ge.\u0275fac=function(e){return new(e||ge)},ge.\u0275prov=g.Db({token:ge,factory:ge.\u0275fac,providedIn:"root"}),ge),ke=["inputFrom"],Se=["inputTo"];function Re(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-item",10),g.Wb("click",function(){return g.ic(n),g.Yb().listMyLocationClick()}),g.Kb(1,"ion-text"),g.oc(2,"My Location"),g.Jb(),g.Jb()}}function Ce(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-item",10),g.Wb("click",function(){g.ic(n);var e=t.$implicit;return g.Yb().listRecentSearchClick(e)}),g.Kb(1,"ion-text"),g.oc(2),g.Jb(),g.Jb()}if(2&e){var r=t.$implicit;g.xb(2),g.pc(r.Name)}}var Ie,Me=function(e){return e[e.No=0]="No",e[e.From=1]="From",e[e.To=2]="To",e}({}),Oe=((Ie=function(){function e(t,n){u(this,e),this.model=t,this.geolocation=n,this.inputToCurrentlyActive=!1,this.myLocationInInput=Me.From}return h(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.UpdateFromNavigationModel(),this.inputToCurrentlyActive=!1,e.next=4,this.inputFrom.setFocus();case 4:case"end":return e.stop()}},e,this)}))}},{key:"SetFocus",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inputToCurrentlyActive){e.next=5;break}return e.next=3,this.inputTo.setFocus();case 3:e.next=7;break;case 5:return e.next=7,this.inputFrom.setFocus();case 7:case"end":return e.stop()}},e,this)}))}},{key:"toggleActiveInput",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.inputToCurrentlyActive=!this.inputToCurrentlyActive,e.next=3,this.SetFocus();case 3:case"end":return e.stop()}},e,this)}))}},{key:"updateInputValues",value:function(){this.inputFrom.value=this.routeLocationFrom.Name,this.inputTo.value=this.routeLocationTo.Name}},{key:"UpdateFromNavigationModel",value:function(){this.routeLocationFrom=this.model.Route.Start,this.routeLocationTo=this.model.Route.Destination,this.updateInputValues()}},{key:"showMyLocation",value:function(){return this.myLocationInInput===Me.No}},{key:"onInputFromFocus",value:function(){this.inputToCurrentlyActive=!1}},{key:"onInputToFocus",value:function(){this.inputToCurrentlyActive=!0}},{key:"swapInputs",value:function(){var e=this.routeLocationFrom;this.routeLocationFrom=this.routeLocationTo,this.routeLocationTo=e,this.myLocationInInput!==Me.No&&(this.myLocationInInput=this.myLocationInInput===Me.From?Me.To:Me.From),this.updateInputValues()}},{key:"listRecentSearchClick",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.inputToCurrentlyActive?(this.routeLocationTo=e,this.myLocationInInput===Me.To&&(this.myLocationInInput=Me.No)):(this.routeLocationFrom=e,this.myLocationInInput===Me.From&&(this.myLocationInInput=Me.No)),this.updateInputValues(),t.next=4,this.toggleActiveInput();case 4:case"end":return t.stop()}},t,this)}))}},{key:"listMyLocationClick",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.geolocation.getCurrentPosition();case 2:return t=e.sent,n={Name:"My Location",LatLng:{lat:t.coords.latitude,lng:t.coords.longitude}},this.inputToCurrentlyActive?(this.routeLocationTo=n,this.myLocationInInput=Me.To):(this.routeLocationFrom=n,this.myLocationInInput=Me.From),this.updateInputValues(),e.next=8,this.toggleActiveInput();case 8:case"end":return e.stop()}},e,this)}))}},{key:"From",get:function(){return this.routeLocationFrom}},{key:"To",get:function(){return this.routeLocationTo}}]),e}()).\u0275fac=function(e){return new(e||Ie)(g.Hb(Z),g.Hb(fe.a))},Ie.\u0275cmp=g.Bb({type:Ie,selectors:[["app-route-input"]],viewQuery:function(e,t){var n;1&e&&(g.sc(ke,!0),g.sc(Se,!0)),2&e&&(g.fc(n=g.Xb())&&(t.inputFrom=n.first),g.fc(n=g.Xb())&&(t.inputTo=n.first))},decls:21,vars:2,consts:[[1,"container"],["size","11"],[3,"ionFocus"],["inputFrom",""],["inputTo",""],["size","1",1,"swappicon","ion-activatable","ripple-parent",3,"click"],["size","large","name","swap-vertical-outline"],[1,"ion-no-padding"],["button","",3,"click",4,"ngIf"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"]],template:function(e,t){1&e&&(g.Kb(0,"div",0),g.Kb(1,"ion-grid"),g.Kb(2,"ion-row"),g.Kb(3,"ion-col",1),g.Kb(4,"ion-item"),g.Kb(5,"ion-label"),g.oc(6,"From"),g.Jb(),g.Kb(7,"ion-input",2,3),g.Wb("ionFocus",function(){return t.onInputFromFocus()}),g.Jb(),g.Jb(),g.Kb(9,"ion-item"),g.Kb(10,"ion-label"),g.oc(11,"To"),g.Jb(),g.Kb(12,"ion-input",2,4),g.Wb("ionFocus",function(){return t.onInputToFocus()}),g.Jb(),g.Jb(),g.Jb(),g.Kb(14,"ion-col",5),g.Wb("click",function(){return t.swapInputs()}),g.Ib(15,"ion-icon",6),g.Ib(16,"ion-ripple-effect"),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Kb(17,"ion-content"),g.Kb(18,"ion-list",7),g.nc(19,Re,3,0,"ion-item",8),g.nc(20,Ce,3,1,"ion-item",9),g.Jb(),g.Jb()),2&e&&(g.xb(19),g.dc("ngIf",t.showMyLocation()),g.xb(1),g.dc("ngForOf",t.model.recentSearches))},directives:[l.u,l.J,l.o,l.y,l.A,l.x,l.eb,l.w,l.H,l.p,l.B,f.j,f.i,l.S],styles:[".container[_ngcontent-%COMP%]{position:relative}.container[_ngcontent-%COMP%], .input-container[_ngcontent-%COMP%]{width:100%;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.input-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.swappicon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.swappicon[_ngcontent-%COMP%]:hover{cursor:pointer}.ripple-parent[_ngcontent-%COMP%]{position:relative;overflow:hidden}"]}),Ie),Le=["drawerContent"],Ke=["searchDrawer"],De=["locationDrawer"],Fe=["routeDrawer"],Je=["inNavigationDrawer"],Pe=["changeRouteDrawer"],Ne=["routeInput"];function Be(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-item",38),g.Wb("click",function(){g.ic(n);var e=t.$implicit;return g.Yb(2).search.emit(e.Name)}),g.Kb(1,"ion-text"),g.oc(2),g.Jb(),g.Jb()}if(2&e){var r=t.$implicit;g.xb(2),g.pc(r.Name)}}function Ae(e,t){if(1&e&&(g.Kb(0,"ion-list",10),g.Kb(1,"ion-list-header"),g.Kb(2,"h2"),g.oc(3,"Recent Searches"),g.Jb(),g.Jb(),g.nc(4,Be,3,1,"ion-item",11),g.Jb()),2&e){var n=g.Yb();g.xb(4),g.dc("ngForOf",n.model.recentSearches)}}function Te(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-item",38),g.Wb("click",function(){g.ic(n);var e=t.$implicit;return g.Yb().campusClick.emit(e)}),g.Kb(1,"ion-label"),g.Kb(2,"h2"),g.oc(3),g.Jb(),g.Kb(4,"h3"),g.oc(5),g.Jb(),g.Jb(),g.Jb()}if(2&e){var r=t.$implicit;g.xb(3),g.rc("",r.ShortName,": ",r.Name,""),g.xb(2),g.pc(r.Address)}}function Ee(e,t){if(1&e&&(g.Kb(0,"ion-row"),g.Kb(1,"ion-col"),g.oc(2),g.Jb(),g.Kb(3,"ion-col"),g.oc(4),g.Jb(),g.Jb()),2&e){var n=t.$implicit;g.xb(2),g.pc(n[0]),g.xb(2),g.pc(n[1])}}function _e(e,t){1&e&&g.Ib(0,"ion-progress-bar",39)}function Ve(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-button",41),g.Wb("click",function(){return g.ic(n),g.Yb(2).onLaunchNavigationClick()}),g.oc(1," Go "),g.Jb()}}function je(e,t){if(1&e&&(g.Kb(0,"ion-row"),g.Kb(1,"ion-col"),g.Kb(2,"ion-label"),g.Kb(3,"h2"),g.oc(4),g.Jb(),g.Jb(),g.Kb(5,"ion-text"),g.oc(6),g.Jb(),g.Jb(),g.Kb(7,"ion-col"),g.nc(8,Ve,2,0,"ion-button",40),g.Jb(),g.Jb()),2&e){var n=g.Yb();g.xb(4),g.qc("",n.model.Route.Time," min"),g.xb(2),g.qc("",n.model.Route.Distance," m"),g.xb(2),g.dc("ngIf",!n.UseDrawerForNavigation())}}function ze(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-item",38),g.Wb("click",function(){g.ic(n);var e=t.$implicit;return g.Yb(2).navInstructionClick.emit(e)}),g.Kb(1,"ion-label"),g.oc(2),g.Jb(),g.Kb(3,"ion-text"),g.oc(4),g.Jb(),g.Jb()}if(2&e){var r=t.$implicit;g.xb(2),g.pc(r.Text),g.xb(2),g.qc("",r.Distance,"m")}}function We(e,t){if(1&e&&(g.Kb(0,"ion-list"),g.nc(1,ze,5,2,"ion-item",11),g.Jb()),2&e){var n=g.Yb();g.xb(1),g.dc("ngForOf",n.model.Route.NavigationInstructions)}}var Xe,He=function(e){return e[e.SearchView=0]="SearchView",e[e.LocationView=1]="LocationView",e[e.RouteView=2]="RouteView",e[e.InNavigationView=3]="InNavigationView",e[e.ChangeRouteView=4]="ChangeRouteView",e}({}),Ye=((Xe=function(){function e(t,n){u(this,e),this.model=t,this.platform=n,this.state=He.SearchView,this.stateChange=new g.o,this.campusClick=new g.o,this.detailsClick=new g.o,this.navInstructionClick=new g.o,this.search=new g.o,this.newRoute=new g.o}return h(e,[{key:"ngAfterViewInit",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.searchDrawer.SetState(X.a.GetRecommendedDrawerStateForDevice()),this.locationDrawer.SetState(W.a.Hidden),this.routeDrawer.SetState(W.a.Hidden),this.inNavigationDrawer.SetState(W.a.Hidden),this.changeRouteDrawer.SetState(W.a.Hidden,!1)]);case 2:case"end":return e.stop()}},e,this)}))}},{key:"ngOnChanges",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.state,!t.t0){t.next=4;break}return t.next=4,this.SetState(e.state.currentValue);case 4:case"end":return t.stop()}},t,this)}))}},{key:"SetState",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=this.state,n.next=n.t0===He.SearchView?3:n.t0===He.LocationView?6:n.t0===He.RouteView?9:n.t0===He.InNavigationView?12:n.t0===He.ChangeRouteView?15:17;break;case 3:return n.next=5,this.searchDrawer.SetState(W.a.Hidden);case 5:return n.abrupt("break",17);case 6:return n.next=8,this.locationDrawer.SetState(W.a.Hidden);case 8:return n.abrupt("break",17);case 9:return n.next=11,this.routeDrawer.SetState(W.a.Hidden);case 11:return n.abrupt("break",17);case 12:return n.next=14,this.inNavigationDrawer.SetState(W.a.Hidden);case 14:return n.abrupt("break",17);case 15:return n.next=17,this.changeRouteDrawer.SetState(W.a.Hidden,!1);case 17:n.t1=(this.state=e,this.state),n.next=n.t1===He.SearchView?20:n.t1===He.LocationView?23:n.t1===He.RouteView?26:n.t1===He.InNavigationView?29:n.t1===He.ChangeRouteView?32:34;break;case 20:return n.next=22,this.searchDrawer.SetState(X.a.GetRecommendedDrawerStateForDevice());case 22:return n.abrupt("break",34);case 23:return n.next=25,this.locationDrawer.SetState(X.a.GetRecommendedDrawerStateForDevice());case 25:return n.abrupt("break",34);case 26:return n.next=28,this.routeDrawer.SetState(X.a.GetRecommendedDrawerStateForDevice());case 28:return n.abrupt("break",34);case 29:return n.next=31,this.inNavigationDrawer.SetState(X.a.GetRecommendedDrawerStateForDevice());case 31:return n.abrupt("break",34);case 32:return n.next=34,this.changeRouteDrawer.SetState(X.a.GetRecommendedDrawerStateForDevice());case 34:t&&this.stateChange.emit(this.state);case 35:case"end":return n.stop()}},n,this)}))}},{key:"onRouteClick",value:function(){this.SetState(He.RouteView)}},{key:"onLaunchNavigationClick",value:function(){this.SetState(He.InNavigationView)}},{key:"onEndNavigationClick",value:function(){this.SetState(He.LocationView)}},{key:"onSearchFocus",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.platform.is("hybrid"),!e.t0){e.next=4;break}return e.next=4,this.searchDrawer.SetState(W.a.Top);case 4:case"end":return e.stop()}},e,this)}))}},{key:"emitRoute",value:function(e){}},{key:"onCloseLocationDrawer",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SetState(He.SearchView);case 2:case"end":return e.stop()}},e,this)}))}},{key:"onCloseRouteDrawer",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SetState(He.LocationView);case 2:case"end":return e.stop()}},e,this)}))}},{key:"onChangeRouteStartEndClick",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.routeInput.UpdateFromNavigationModel(),e.next=3,this.SetState(He.ChangeRouteView);case 3:return e.next=5,this.routeInput.SetFocus();case 5:case"end":return e.stop()}},e,this)}))}},{key:"onSearchDrawerStateChange",value:function(e){void 0!==this.drawerContent&&(this.drawerContent.scrollY=e===W.a.Top)}},{key:"onChangeRouteDrawerStateChange",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(e),t.t0=e===W.a.Hidden,!t.t0){t.next=5;break}return t.next=5,this.SetState(He.RouteView);case 5:case"end":return t.stop()}},t,this)}))}},{key:"onCancelChangeRoute",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SetState(He.RouteView,!1);case 2:case"end":return e.stop()}},e,this)}))}},{key:"UseDrawerForNavigation",value:function(){return!(X.a.GetRecommendedDrawerStateForDevice()===W.a.Bottom)}}]),e}()).\u0275fac=function(e){return new(e||Xe)(g.Hb(Z),g.Hb(l.bb))},Xe.\u0275cmp=g.Bb({type:Xe,selectors:[["app-nav-drawer-manager"]],viewQuery:function(e,t){var n;1&e&&(g.sc(Le,!0),g.sc(Ke,!0),g.sc(De,!0),g.sc(Fe,!0),g.sc(Je,!0),g.sc(Pe,!0),g.sc(Ne,!0)),2&e&&(g.fc(n=g.Xb())&&(t.drawerContent=n.first),g.fc(n=g.Xb())&&(t.searchDrawer=n.first),g.fc(n=g.Xb())&&(t.locationDrawer=n.first),g.fc(n=g.Xb())&&(t.routeDrawer=n.first),g.fc(n=g.Xb())&&(t.inNavigationDrawer=n.first),g.fc(n=g.Xb())&&(t.changeRouteDrawer=n.first),g.fc(n=g.Xb())&&(t.routeInput=n.first))},inputs:{state:"state"},outputs:{stateChange:"stateChange",campusClick:"campusClick",detailsClick:"detailsClick",navInstructionClick:"navInstructionClick",search:"search",newRoute:"newRoute"},features:[g.vb],decls:118,vars:14,consts:[["id","searchDrawer",3,"stateChange"],["searchDrawer",""],[1,"nav-bottom-drawer"],[1,"drawer-grip"],[1,"ion-padding-top"],[1,"nav-hbar"],[3,"discovery","route","searchBarFocus"],["searchInput",""],["drawerContent",""],["class","ion-no-padding",4,"ngIf"],[1,"ion-no-padding"],["button","",3,"click",4,"ngFor","ngForOf"],[1,"ion-padding-vertical"],["id","locationDrawer","state","DrawerState.Hidden"],["locationDrawer",""],[1,"ion-padding-bottom"],["id","locationdrawerContent"],[1,"ion-justify-content-between","ion-align-self-center"],[1,"ion-justify-content-end","ion-padding-horizontal"],["shape","round","color","medium",1,"square-sm","ion-no-padding","ion-float-right",3,"click"],["slot","icon-only","name","close-outline","size","small"],["color","primary","expand","block",3,"click"],["id","routeBtn","color","primary","expand","block",3,"click"],[4,"ngFor","ngForOf"],["id","routeDrawer","state","DrawerState.Hidden"],["routeDrawer",""],["type","indeterminate",4,"ngIf"],[1,"span-button",3,"click"],[4,"ngIf"],["id","inNavigationDrawer","state","DrawerState.Hidden"],["inNavigationDrawer",""],["color","danger","expand","block",3,"click"],["id","changeRouteDrawer","state","DrawerState.Hidden",3,"shouldDockBottom","shouldDockMiddle","stateChange"],["changeRouteDrawer",""],[1,"ion-align-items-baseline"],[1,"ion-text-center"],["size","6",1,"ion-text-center"],["routeInput",""],["button","",3,"click"],["type","indeterminate"],["color","success","expand","block",3,"click",4,"ngIf"],["color","success","expand","block",3,"click"]],template:function(e,t){if(1&e){var n=g.Lb();g.Kb(0,"app-ionic-bottom-drawer",0,1),g.Wb("stateChange",function(e){return t.onSearchDrawerStateChange(e)}),g.Kb(2,"div",2),g.Kb(3,"div",3),g.Ib(4,"div",4),g.Ib(5,"div",5),g.Jb(),g.Kb(6,"app-search-input",6,7),g.Wb("discovery",function(e){return t.search.emit(e)})("route",function(e){return t.emitRoute(e)})("searchBarFocus",function(e){return t.onSearchFocus(e)}),g.Jb(),g.Kb(8,"ion-content",null,8),g.nc(10,Ae,5,1,"ion-list",9),g.Kb(11,"ion-list",10),g.Kb(12,"ion-list-header"),g.Kb(13,"h2"),g.oc(14,"Choose a Campus"),g.Jb(),g.Jb(),g.nc(15,Te,6,3,"ion-item",11),g.Jb(),g.Ib(16,"div",12),g.Ib(17,"div",12),g.Ib(18,"div",12),g.Ib(19,"div",12),g.Ib(20,"div",12),g.Ib(21,"div",12),g.Jb(),g.Jb(),g.Jb(),g.Kb(22,"app-ionic-bottom-drawer",13,14),g.Kb(24,"div",2),g.Kb(25,"div",3),g.Ib(26,"div",4),g.Ib(27,"div",5),g.Ib(28,"div",15),g.Jb(),g.Kb(29,"ion-content"),g.Kb(30,"ion-grid",16),g.Kb(31,"ion-row",17),g.Kb(32,"ion-col"),g.Kb(33,"ion-label"),g.Kb(34,"h1"),g.oc(35),g.Jb(),g.Jb(),g.Kb(36,"ion-text"),g.oc(37),g.Jb(),g.Jb(),g.Kb(38,"ion-col",18),g.Kb(39,"ion-button",19),g.Wb("click",function(){return t.onCloseLocationDrawer()}),g.Ib(40,"ion-icon",20),g.Jb(),g.Jb(),g.Jb(),g.Kb(41,"ion-row"),g.Kb(42,"ion-col"),g.Kb(43,"ion-button",21),g.Wb("click",function(){return t.detailsClick.emit()}),g.oc(44," Details "),g.Jb(),g.Jb(),g.Kb(45,"ion-col"),g.Kb(46,"ion-button",22),g.Wb("click",function(){return t.onRouteClick()}),g.oc(47," Route "),g.Jb(),g.Jb(),g.Jb(),g.nc(48,Ee,5,2,"ion-row",23),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Kb(49,"app-ionic-bottom-drawer",24,25),g.Kb(51,"div",2),g.Kb(52,"div",3),g.Ib(53,"div",4),g.Ib(54,"div",5),g.Ib(55,"div",15),g.nc(56,_e,1,0,"ion-progress-bar",26),g.Kb(57,"ion-grid"),g.Kb(58,"ion-row",17),g.Kb(59,"ion-col"),g.Kb(60,"ion-label"),g.Kb(61,"h1"),g.oc(62),g.Jb(),g.Jb(),g.Kb(63,"ion-text"),g.oc(64,"From "),g.Kb(65,"span",27),g.Wb("click",function(){return t.onChangeRouteStartEndClick()}),g.oc(66),g.Jb(),g.Jb(),g.Jb(),g.Kb(67,"ion-col",18),g.Kb(68,"ion-button",19),g.Wb("click",function(){return t.onCloseRouteDrawer()}),g.Ib(69,"ion-icon",20),g.Jb(),g.Jb(),g.Jb(),g.nc(70,je,9,3,"ion-row",28),g.Jb(),g.Jb(),g.Kb(71,"ion-content"),g.nc(72,We,2,1,"ion-list",28),g.Ib(73,"div",12),g.Ib(74,"div",12),g.Ib(75,"div",12),g.Ib(76,"div",12),g.Ib(77,"div",12),g.Ib(78,"div",12),g.Ib(79,"div",12),g.Ib(80,"div",12),g.Jb(),g.Jb(),g.Jb(),g.Kb(81,"app-ionic-bottom-drawer",29,30),g.Kb(83,"div",2),g.Kb(84,"div",3),g.Ib(85,"div",4),g.Ib(86,"div",5),g.Ib(87,"div",15),g.Kb(88,"ion-grid"),g.Kb(89,"ion-row"),g.Kb(90,"ion-col"),g.Kb(91,"ion-label"),g.Kb(92,"h2"),g.oc(93),g.Jb(),g.Jb(),g.Kb(94,"ion-text"),g.oc(95),g.Jb(),g.Jb(),g.Kb(96,"ion-col"),g.Kb(97,"ion-button",31),g.Wb("click",function(){return t.onEndNavigationClick()}),g.oc(98," End Route "),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Kb(99,"app-ionic-bottom-drawer",32,33),g.Wb("stateChange",function(e){return t.onChangeRouteDrawerStateChange(e)}),g.Kb(101,"div",2),g.Kb(102,"div",3),g.Ib(103,"div",4),g.Ib(104,"div",5),g.Kb(105,"ion-grid"),g.Kb(106,"ion-row",34),g.Kb(107,"ion-col",35),g.Kb(108,"span",27),g.Wb("click",function(){return t.onCancelChangeRoute()}),g.oc(109,"Cancel"),g.Jb(),g.Jb(),g.Kb(110,"ion-col",36),g.Kb(111,"h3"),g.oc(112,"Change Route"),g.Jb(),g.Jb(),g.Kb(113,"ion-col",35),g.Kb(114,"span",27),g.Wb("click",function(){g.ic(n);var e=g.gc(117);return t.newRoute.emit([e.From,e.To])}),g.oc(115,"Route"),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Ib(116,"app-route-input",null,37),g.Jb(),g.Jb()}2&e&&(g.xb(10),g.dc("ngIf",t.model.recentSearches.length>0),g.xb(5),g.dc("ngForOf",t.model.availableCampus),g.xb(20),g.pc(t.model.latestSearchResult.Name),g.xb(2),g.pc(t.model.latestSearchResult.Description),g.xb(11),g.dc("ngForOf",t.model.latestSearchResult.Information),g.xb(8),g.dc("ngIf",0===t.model.Route.Distance),g.xb(6),g.qc("To ",t.model.Route.Destination.Name,""),g.xb(4),g.pc(t.model.Route.Start.Name),g.xb(4),g.dc("ngIf",0!==t.model.Route.Distance),g.xb(2),g.dc("ngIf",0!==t.model.Route.Distance),g.xb(21),g.qc("",t.model.Route.Time," min"),g.xb(2),g.qc("",t.model.Route.Distance," m"),g.xb(4),g.dc("shouldDockBottom",!1)("shouldDockMiddle",!1))},directives:[X.a,z,l.p,f.j,l.B,l.C,f.i,l.u,l.J,l.o,l.A,l.S,l.h,l.w,Oe,l.y,l.E],styles:[".vertical-line[_ngcontent-%COMP%]{border-left:2px solid #9d9fa6;height:38px}.span-button[_ngcontent-%COMP%]{color:var(--ion-color-primary,#3880ff)}.span-button[_ngcontent-%COMP%]:hover{cursor:pointer}.nav-hbar[_ngcontent-%COMP%]{border-top:2px solid var(--ion-color-medium,#9d9fa6);border-bottom:2px solid var(--ion-color-medium,#9d9fa6);border-radius:2px;height:0;width:auto;margin:0 45%}.nav-bottom-drawer[_ngcontent-%COMP%]{background-color:var(--ion-color-white,#fff);border-top-left-radius:20px;border-top-right-radius:20px;box-shadow:0 4px 8px 0 rgba(0,0,0,.4),0 6px 20px 0 rgba(0,0,0,.29);height:inherit}.square-md[_ngcontent-%COMP%]{height:64px;width:64px}.square-sm[_ngcontent-%COMP%]{height:32px;width:32px}.square-xs[_ngcontent-%COMP%]{height:16px;width:16px}#locationdrawerContent[_ngcontent-%COMP%]{margin-left:30px;margin-right:30px;position:center}#locationdrawerName[_ngcontent-%COMP%]{font-weight:700}#inNavigationDrawer[_ngcontent-%COMP%]{z-index:1}#locationDrawer[_ngcontent-%COMP%]{z-index:2}#routeDrawer[_ngcontent-%COMP%]{z-index:3}#searchDrawer[_ngcontent-%COMP%]{z-index:4}"]}),Xe),Ge=["searchInput"],qe=["navSlides"],Ze=["drawerManager"];function Ue(e,t){1&e&&g.Ib(0,"ion-progress-bar",9)}function $e(e,t){if(1&e&&(g.Kb(0,"ion-text",10),g.Kb(1,"h5"),g.Kb(2,"span",11),g.oc(3),g.Jb(),g.Jb(),g.Kb(4,"p"),g.Ob(5,12),g.Jb(),g.Kb(6,"p"),g.Rb(7,13),g.Ib(8,"br"),g.Ib(9,"a",14),g.Pb(),g.Jb(),g.Jb()),2&e){var n=g.Yb();g.xb(3),g.pc(n.errorMessage)}}var Qe=U.a.Keyboard,et=de.icon({iconRetinaUrl:"leaflet/marker-icon-2x.png",iconUrl:"leaflet/marker-icon.png",shadowUrl:"leaflet/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});de.Marker.prototype.options.icon=et;var tt,nt,rt=((nt=function(){function e(t,n,r,i,o,a,c,s){u(this,e),this.dataService=t,this.router=n,this.model=r,this.storage=i,this.geolocation=o,this.openStreetMapService=a,this.lastOpenStreetMapCenterPersistence=c,this.platform=s,this.searchMarker=[],this.routes=[],this.progressIsVisible=!1,this.currentPositionMarker=null,this.isInitialized=!1,this.DEFAULT_ZOOM=17,this.MAX_ZOOM=18,this.MIN_ZOOM=14,this.isHybridPlatform=this.platform.is("hybrid")}return h(e,[{key:"ngOnInit",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.model.availableCampus&&0!==this.model.availableCampus.length){e.next=6;break}return e.next=3,this.dataService.get_campus_search().toPromise();case 3:t=e.sent,n=a(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this.model.availableCampus.push(new H(i))}catch(o){n.e(o)}finally{n.f()}case 6:case"end":return e.stop()}},e,this)}))}},{key:"ionViewDidEnter",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.isInitialized,e.t0){e.next=5;break}return e.next=4,this.initializeMap(this.router);case 4:this.isInitialized=!0;case 5:return e.prev=5,e.next=8,this.geolocation.getCurrentPosition();case 8:t=e.sent,null===this.currentPositionMarker?this.currentPositionMarker=de.marker([t.coords.latitude,t.coords.longitude]).addTo(this.map).bindPopup("Position"):this.currentPositionMarker.setLatLng([t.coords.latitude,t.coords.longitude]),e.next=15;break;case 12:e.prev=12,e.t1=e.catch(5),console.log("Error getting location",e.t1);case 15:case"end":return e.stop()}},e,this,[[5,12]])}))}},{key:"initializeMap",value:function(t){var n;return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){var i,o,c,s,u,l,h,d,f,b=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l=function(e){t.navigate(["tabs/navigation/detail"],{queryParams:{building:e.target.options.className}}).then(function(){return console.log(e.latlng,e.target.options.className)})},r.next=3,this.openStreetMapService.GetBounds();case 3:return i=r.sent,o=de.latLng(i.SouthWest.Lat,i.SouthWest.Lng),c=de.latLng(i.NorthEast.Lat,i.NorthEast.Lng),s=de.latLngBounds(o,c),console.log(i,s),this.map=de.map("leafletMap",{maxBounds:s,maxZoom:this.MAX_ZOOM,minZoom:this.MIN_ZOOM,zoomControl:!this.platform.is("hybrid")}),this.map.on("moveend",function(e){xe.persist(b.storage,{center:e.target.getCenter(),zoom:e.target.getZoom()})}),r.next=12,this.lastOpenStreetMapCenterPersistence.load(this.storage,this.map,this.DEFAULT_ZOOM);case 12:if(de.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"edupala.com \xa9 Angular LeafLet"}).addTo(this.map),r.t0=this.platform.is("hybrid"),!r.t0){r.next=18;break}return r.next=17,this.delay(500);case 17:this.map.invalidateSize();case 18:return r.next=20,this.dataService.get_buildings_search().toPromise();case 20:if(null!==(u=r.sent)){h=a(u);try{for(h.s();!(d=h.n()).done;)null!==(f=d.value).Body&&f.Body.length>0&&de.polygon(e.convertToLeafLetCoordinates(f.Body),{className:f.Name,color:null!==(n=f.Color)&&void 0!==n?n:"#0083C6"}).addTo(this.map).on("click",l)}catch(p){h.e(p)}finally{h.f()}}case 22:case"end":return r.stop()}},r,this)}))}},{key:"ngOnDestroy",value:function(){this.map.remove()}},{key:"onSearch",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,o,c,s,u,l,h,d,f,b,p,m,v;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.model.errorMessage="",this.progressIsVisible=!0,t.prev=1,this.clearSearchMarkers(),t.prev=3,t.next=6,this.dataService.get_location(e).toPromise();case 6:if(!(n=t.sent)){t.next=19;break}return t.next=10,this.dataService.get_building(n.Building).toPromise();case 10:return r=t.sent,i=this.getCenterCoordinateFromBody(r.Body),t.next=14,this.model.addRecentSearchLocation(n,{lat:i.Latitude,lng:i.Longitude});case 14:return this.searchMarker.push(this.showMarker(i.Latitude,i.Longitude,"Room "+n.Name,!0)),this.map.flyTo(this.model.latestSearchResult.LatLng,this.DEFAULT_ZOOM),t.next=18,this.showElementDrawer();case 18:return t.abrupt("return",void t.sent);case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(3),console.log(t.t0);case 24:return t.prev=24,t.next=27,this.dataService.get_building(e,!1).toPromise();case 27:if(!(o=t.sent)){t.next=37;break}return c=this.getCenterCoordinateFromBody(o.Body),t.next=32,this.model.addRecentSearchBuilding(o,{lat:c.Latitude,lng:c.Longitude});case 32:return this.map.flyTo(this.model.latestSearchResult.LatLng,this.DEFAULT_ZOOM),this.searchMarker.push(this.showMarker(c.Latitude,c.Longitude,"Building "+o.Name,!0)),t.next=36,this.showElementDrawer();case 36:return t.abrupt("return",void t.sent);case 37:t.next=42;break;case 39:t.prev=39,t.t1=t.catch(24),console.log(t.t1);case 42:return t.prev=42,t.next=45,this.dataService.get_campus(e,!1).toPromise();case 45:if(!(s=t.sent)){t.next=54;break}return t.next=49,this.model.addRecentSearchCampus(s);case 49:return this.searchMarker.push(this.showMarker(s.Latitude,s.Longitude,"Campus "+s.Name,!0)),this.map.flyTo([s.Latitude,s.Longitude],this.DEFAULT_ZOOM),t.next=53,this.showElementDrawer();case 53:return t.abrupt("return",void t.sent);case 54:t.next=59;break;case 56:t.prev=56,t.t2=t.catch(42),console.log(t.t2);case 59:return t.next=61,this.dataService.get_buildings_search(e).toPromise();case 61:if(!(null!==(u=t.sent)&&u.length>0)){t.next=67;break}l=a(u);try{for(l.s();!(h=l.n()).done;)d=h.value,f=this.getCenterCoordinateFromBody(d.Body),this.searchMarker.push(this.showMarker(f.Latitude,f.Longitude,d.Name,!1))}catch(g){l.e(g)}finally{l.f()}t.next=71;break;case 67:return t.next=69,this.dataService.get_campus_search(e).toPromise();case 69:if(null!==(b=t.sent)&&b.length>0){p=a(b);try{for(p.s();!(m=p.n()).done;)v=m.value,this.searchMarker.push(this.showMarker(v.Latitude,v.Longitude,v.Name,!1))}catch(g){p.e(g)}finally{p.f()}}case 71:t.next=76;break;case 73:t.prev=73,t.t3=t.catch(1),this.handleInputError(t.t3,e);case 76:return t.prev=76,this.progressIsVisible=!1,t.finish(76);case 79:case"end":return t.stop()}},t,this,[[1,73,76,79],[3,21],[24,39],[42,56]])}))}},{key:"onRoute",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e),this.clearRoutes(),t.next=4,this.drawerManager.SetState(He.RouteView,!1);case 4:return t.next=6,this.openStreetMapService.GetRoute(e[0].LatLng,e[1].LatLng);case 6:return n=t.sent,this.model.SetOsmRouteAsRoute(n[0],e[0],e[1]),r=de.polyline(this.model.Route.Coordinates,{color:"red"}).addTo(this.map),this.map.flyTo(r.getCenter(),this.DEFAULT_ZOOM),t.next=12,this.map.fitBounds(r.getBounds());case 12:this.routes.push(r);case 13:case"end":return t.stop()}},t,this)}))}},{key:"onCloseLocationDrawer",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.searchInput.clearDestinationInput(),e.next=3,this.drawerManager.SetState(He.SearchView);case 3:this.clearSearchMarkers();case 4:case"end":return e.stop()}},e,this)}))}},{key:"onCloseRouteDrawer",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.clearRoutes(),e.next=3,this.drawerManager.SetState(He.LocationView);case 3:this.map.flyTo(this.model.latestSearchResult.LatLng,this.DEFAULT_ZOOM);case 4:case"end":return e.stop()}},e,this)}))}},{key:"showElementDrawer",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.isHybridPlatform,!e.t0){e.next=4;break}return e.next=4,Qe.hide();case 4:return e.next=6,this.drawerManager.SetState(He.LocationView);case 6:case"end":return e.stop()}},e,this)}))}},{key:"onCampusClick",value:function(e){this.map.flyTo(e.LatLng,this.DEFAULT_ZOOM)}},{key:"onDrawerManagerStateChange",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=(console.log(e),e),t.next=t.t0===He.SearchView?3:t.t0===He.LocationView?5:t.t0===He.RouteView?7:t.t0===He.InNavigationView?10:12;break;case 3:return this.clearSearchMarkers(),t.abrupt("break",12);case 5:return this.clearRoutes(),this.map.flyTo(this.model.latestSearchResult.LatLng,this.DEFAULT_ZOOM),t.abrupt("break",12);case 7:return t.next=9,this.onRouteBtnClick();case 9:return t.abrupt("break",12);case 10:return t.next=12,this.onLaunchNavigation();case 12:case"end":return t.stop()}},t,this)}))}},{key:"onDetailsClick",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.router.navigate(["tabs/navigation/detail"],{queryParams:0===this.routes.length?this.model.latestSearchResult.DetailRouterParams:this.model.latestSearchResult.RouteRouterParams});case 2:case"end":return e.stop()}},e,this)}))}},{key:"onRouteBtnClick",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.geolocation.getCurrentPosition();case 2:return n=t.sent,r={lat:n.coords.latitude,lng:n.coords.longitude},t.next=6,this.openStreetMapService.GetRoute(r,this.model.latestSearchResult.LatLng);case 6:return i=t.sent,this.model.SetOsmRouteAsRoute(i[0],{Name:e.MyLocation,LatLng:r},this.model.latestSearchResult),o=de.polyline(this.model.Route.Coordinates,{color:"red"}).addTo(this.map),this.map.flyTo(o.getCenter(),this.DEFAULT_ZOOM),t.next=12,this.map.fitBounds(o.getBounds());case 12:this.routes.push(o);case 13:case"end":return t.stop()}},t,this)}))}},{key:"onLaunchNavigation",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.navSlides.instructions=this.model.Route.NavigationInstructions,e.next=3,this.navSlides.show();case 3:this.map.flyTo(this.model.Route.Coordinates[this.model.Route.NavigationInstructions[0].Interval[0]],this.MAX_ZOOM);case 4:case"end":return e.stop()}},e,this)}))}},{key:"onSlideChange",value:function(e){this.onNavigationInstructionClick(this.model.Route.NavigationInstructions[e])}},{key:"onNavigationInstructionClick",value:function(e){this.map.flyTo(this.model.Route.Coordinates[e.Interval[0]],this.MAX_ZOOM)}},{key:"handleInputError",value:function(e,t){if(e instanceof J.d){var n=e;this.errorMessage=400===n.status?"Studi-Guide can't find "+t:n.message}else this.errorMessage=e.message}},{key:"showMarker",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3?arguments[3]:void 0,i=de.marker([e,t]).addTo(this.map);return n?r?i.bindPopup(n).openPopup():i.bindPopup(n):i}},{key:"getCenterCoordinateFromBody",value:function(e){var t,n=[],r=a(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push([i.Latitude,i.Longitude])}}catch(s){r.e(s)}finally{r.f()}var o=new de.Polygon(n).addTo(this.map),c={Longitude:o.getCenter().lng,Latitude:o.getCenter().lat};return o.remove(),c}},{key:"clearSearchMarkers",value:function(){var e,t=a(this.searchMarker);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.map.removeLayer(n)}}catch(r){t.e(r)}finally{t.f()}}},{key:"clearRoutes",value:function(){var e,t=a(this.routes);try{for(t.s();!(e=t.n()).done;)e.value.remove()}catch(n){t.e(n)}finally{t.f()}this.routes=[],this.model.ClearRoute(),this.navSlides.hide()}},{key:"delay",value:function(e){return new Promise(function(t){return setTimeout(t,e)})}}],[{key:"convertToLeafLetCoordinates",value:function(e){var t,n=[],r=a(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push({lat:i.Latitude,lng:i.Longitude})}}catch(o){r.e(o)}finally{r.f()}return n}}]),e}()).MyLocation="My Location",nt.\u0275fac=function(e){return new(e||nt)(g.Hb(m.a),g.Hb(d.g),g.Hb(Z),g.Hb(G.b),g.Hb(fe.a),g.Hb(pe),g.Hb(xe),g.Hb(l.bb))},nt.\u0275cmp=g.Bb({type:nt,selectors:[["app-map-page"]],viewQuery:function(e,t){var n;1&e&&(g.sc(Ge,!0),g.sc(qe,!0),g.sc(Ze,!0)),2&e&&(g.fc(n=g.Xb())&&(t.searchInput=n.first),g.fc(n=g.Xb())&&(t.navSlides=n.first),g.fc(n=g.Xb())&&(t.drawerManager=n.first))},decls:9,vars:2,consts:function(){return[[3,"nextSlide","previousSlide"],["navSlides",""],[3,"campusClick","navInstructionClick","search","detailsClick","stateChange","newRoute"],["drawerManager",""],["data-tap-disabled","true","scroll-y","false"],["type","indeterminate","color","secondary",4,"ngIf"],["id","map-content"],["id","error-message",4,"ngIf"],["id","leafletMap"],["type","indeterminate","color","secondary"],["id","error-message"],[1,"error"],"\xDCberpr\xFCfe deine Eingabe auf Rechtschreibfehler.","Sollte dieser Ort im Studi-Guide sein?\n        " + "\ufffd#8\ufffd\ufffd/#8\ufffd" + "\n        " + "\ufffd#9\ufffd" + "F\xFCge den Ort hinzu" + "\ufffd/#9\ufffd" + "\n      ",["href","https://github.com/Studi-Guide/Studi-Guide/issues/new/choose"]]},template:function(e,t){1&e&&(g.Kb(0,"app-navigation-instruction-slides",0,1),g.Wb("nextSlide",function(e){return t.onSlideChange(e)})("previousSlide",function(e){return t.onSlideChange(e)}),g.Jb(),g.Kb(2,"app-nav-drawer-manager",2,3),g.Wb("campusClick",function(e){return t.onCampusClick(e)})("navInstructionClick",function(e){return t.onNavigationInstructionClick(e)})("search",function(e){return t.onSearch(e)})("detailsClick",function(){return t.onDetailsClick()})("stateChange",function(e){return t.onDrawerManagerStateChange(e)})("newRoute",function(e){return t.onRoute(e)}),g.Jb(),g.Kb(4,"ion-content",4),g.nc(5,Ue,1,0,"ion-progress-bar",5),g.Kb(6,"div",6),g.nc(7,$e,10,1,"ion-text",7),g.Ib(8,"div",8),g.Jb(),g.Jb()),2&e&&(g.xb(5),g.dc("ngIf",t.progressIsVisible),g.xb(2),g.dc("ngIf",t.errorMessage))},directives:[ye,Ye,l.p,f.j,l.E,l.S],styles:["#map-content[_ngcontent-%COMP%]{height:100%;width:100%;position:fixed}.error[_ngcontent-%COMP%]{color:red}#error-message[_ngcontent-%COMP%]{margin-left:20px}#leafletMap[_ngcontent-%COMP%]{height:100%;width:100%;z-index:0}#leafletMap[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}#available-floors-btn[_ngcontent-%COMP%]{position:fixed;bottom:0;display:block;z-index:10}.draggable[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.center[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;display:block}ion-progress-bar[_ngcontent-%COMP%]{position:absolute;z-index:9999}"]}),nt),it=((tt=function e(){u(this,e)}).\u0275mod=g.Fb({type:tt}),tt.\u0275inj=g.Eb({factory:function(e){return new(e||tt)},imports:[[l.W,f.b,b.a,d.i.forChild([{path:"detail",component:le},{path:"",component:rt}]),he]]}),tt);g.lc(le,[l.v,l.V,l.i,l.f,l.g,l.p,f.j,l.E,l.S,F,X.a,z,l.u,l.C,l.J,l.o,l.h,l.w,l.B,f.i,l.y,l.A],[])},wyfB:function(e,t){function n(e){return e&&e.ownerSVGElement&&e.getCTM}e.exports=function(e,t){if(!n(e))throw new Error("svg element is required for svg.panzoom to work");var r=e.ownerSVGElement;if(!r)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");return t.disableKeyboardInteraction||r.setAttribute("tabindex",0),{getBBox:function(){var t=e.getBBox();return{left:t.x,top:t.y,width:t.width,height:t.height}},getScreenCTM:function(){return r.getCTM()||r.getScreenCTM()},getOwner:function(){return r},applyTransform:function(t){e.setAttribute("transform","matrix("+t.scale+" 0 0 "+t.scale+" "+t.x+" "+t.y+")")},initTransform:function(t){var n=e.getCTM();null===n&&(n=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),t.x=n.e,t.y=n.f,t.scale=n.a,r.removeAttributeNS(null,"viewBox")}}},e.exports.canAttach=n}}])}();