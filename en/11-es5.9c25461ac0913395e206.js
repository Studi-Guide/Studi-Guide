!function(){function e(){var t=i([":search error|missing place request\u241fc583358f0f963680c102622c2f41dea5db729fb5\u241f8414130712017189041:Should this place be on Studi-Guide? ",":LINE_BREAK:",":START_LINK:Request a missing place",":CLOSE_LINK:"]);return e=function(){return t},t}function t(){var e=i([":search error|spelling check\u241f3149bc3f0a5c01aac3807ac5700243e6877464b2\u241f8075391416841215266:Make sure your search is spelled correctly."]);return t=function(){return e},e}function n(){var e=i([":search error|missing place request\u241fc583358f0f963680c102622c2f41dea5db729fb5\u241f8414130712017189041:Should this place be on Studi-Guide? ",":LINE_BREAK:",":START_LINK:Request a missing place",":CLOSE_LINK:"]);return n=function(){return e},e}function r(){var e=i([":search error|spelling check\u241f3149bc3f0a5c01aac3807ac5700243e6877464b2\u241f8075391416841215266:Make sure your search is spelled correctly."]);return r=function(){return e},e}function i(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function o(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b(this,n)}}function b(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"0Tit":function(e,t){var n="function"==typeof Float32Array;function r(e,t){return 1-3*t+3*e}function i(e,t){return 3*t-6*e}function o(e){return 3*e}function a(e,t,n){return((r(t,n)*e+i(t,n))*e+o(t))*e}function s(e,t,n){return 3*r(t,n)*e*e+2*i(t,n)*e+o(t)}function c(e){return e}e.exports=function(e,t,r,i){if(!(0<=e&&e<=1&&0<=r&&r<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&r===i)return c;for(var o=n?new Float32Array(11):new Array(11),u=0;u<11;++u)o[u]=a(.1*u,e,r);return function(n){return 0===n?0:1===n?1:a(function(t){for(var n=0,i=1;10!==i&&o[i]<=t;++i)n+=.1;--i;var c=n+(t-o[i])/(o[i+1]-o[i])*.1,u=s(c,e,r);return u>=.001?function(e,t,n,r){for(var i=0;i<4;++i){var o=s(t,n,r);if(0===o)return t;t-=(a(t,n,r)-e)/o}return t}(t,c,e,r):0===u?c:function(e,t,n,r,i){var o,s,c=0;do{(o=a(s=t+(n-t)/2,r,i)-e)>0?n=s:t=s}while(Math.abs(o)>1e-7&&++c<10);return s}(t,n,n+.1,e,r)}(n),t,i)}}},"6f8I":function(e,t){function n(){return"function"==typeof cancelAnimationFrame?cancelAnimationFrame:clearTimeout}function r(){return"function"==typeof requestAnimationFrame?requestAnimationFrame:function(e){return setTimeout(e,16)}}e.exports=function(e,t,i){"object"!=typeof i&&(i={});var o,a,s,c,u,l,h,d,f,v,p="number"==typeof i.minVelocity?i.minVelocity:5,b="number"==typeof i.amplitude?i.amplitude:.25,m="function"==typeof i.cancelAnimationFrame?i.cancelAnimationFrame:n(),g="function"==typeof i.requestAnimationFrame?i.requestAnimationFrame:r();return{start:function(){o=e(),l=f=c=h=0,a=new Date,m(s),m(v),s=g(y)},stop:function(){m(s),m(v);var t=e();u=t.x,d=t.y,a=Date.now(),(c<-p||c>p)&&(u+=l=b*c),(h<-p||h>p)&&(d+=f=b*h),v=g(w)},cancel:function(){m(s),m(v)}};function y(){var t=Date.now(),n=t-a;a=t;var r=e(),i=r.x-o.x,u=r.y-o.y;o=r;var l=1e3/(1+n);c=.8*i*l+.2*c,h=.8*u*l+.2*h,s=g(y)}function w(){var e=Date.now()-a,n=!1,r=0,i=0;l&&((r=-l*Math.exp(-e/342))>.5||r<-.5?n=!0:r=l=0),f&&((i=-f*Math.exp(-e/342))>.5||i<-.5?n=!0:i=f=0),n&&(t(u+r,d+i),v=g(w))}}},AMdQ:function(e,t){e.exports=function(e){!function(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],n=0;n<t.length;++n)if(e.hasOwnProperty(t[n]))throw new Error("Subject cannot be eventified, since it already has property '"+t[n]+"'")}(e);var t=function(e){var t=Object.create(null);return{on:function(n,r,i){if("function"!=typeof r)throw new Error("callback is expected to be a function");var o=t[n];return o||(o=t[n]=[]),o.push({callback:r,ctx:i}),e},off:function(n,r){if(void 0===n)return t=Object.create(null),e;if(t[n])if("function"!=typeof r)delete t[n];else for(var i=t[n],o=0;o<i.length;++o)i[o].callback===r&&i.splice(o,1);return e},fire:function(n){var r,i=t[n];if(!i)return e;arguments.length>1&&(r=Array.prototype.splice.call(arguments,1));for(var o=0;o<i.length;++o){var a=i[o];a.callback.apply(a.ctx,r)}return e}}}(e);return e.on=t.on,e.off=t.off,e.fire=t.fire,e}},AgEI:function(e,t){function n(e){return e.stopPropagation(),!1}function r(){}e.exports=function(e){if(e)return{capture:r,release:r};var t,i,o,a=!1;return{capture:function(e){a=!0,i=window.document.onselectstart,o=window.document.ondragstart,window.document.onselectstart=n,(t=e).ondragstart=n},release:function(){a&&(a=!1,window.document.onselectstart=i,t&&(t.ondragstart=o))}}}},EnSQ:function(e,t,n){"use strict";n.d(t,"a",function(){return D});var r,i,o,a=n("AytR"),s=n("EY2u"),c=n("XNiG"),h=n("quSY"),v=function(e){f(n,e);var t=p(n);function n(e,r){var i;return l(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return d(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?u(g(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?u(g(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==r&&r>0||null===r&&this.delay>0?u(g(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(function(e){f(n,e);var t=p(n);function n(e,r){var i;return l(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i.pending=!1,i}return d(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(i){n=!0,r=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),r}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}]),n}(function(e){f(n,e);var t=p(n);function n(e,r){return l(this,n),t.call(this)}return d(n,[{key:"schedule",value:function(e){return this}}]),n}(h.a))),b=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;l(this,e),this.SchedulerAction=t,this.now=n}return d(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,e).schedule(n,t)}}]),e}();return e.now=function(){return Date.now()},e}(),y=new(function(e){f(n,e);var t=p(n);function n(){return l(this,n),t.apply(this,arguments)}return n}(function(e){f(n,e);var t=p(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.now;return l(this,n),(r=t.call(this,e,function(){return n.delegate&&n.delegate!==m(r)?n.delegate.now():i()})).actions=[],r.active=!1,r.scheduled=void 0,r}return d(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;return n.delegate&&n.delegate!==this?n.delegate.schedule(e,t,r):u(g(n.prototype),"schedule",this).call(this,e,t,r)}},{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(b)))(v),w=n("7o/Q"),x=n("LRne"),k=n("HDdC"),S=((r=function(){function e(t,n,r){l(this,e),this.kind=t,this.value=n,this.error=r,this.hasValue="N"===t}return d(e,[{key:"observe",value:function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}},{key:"do",value:function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}}},{key:"accept",value:function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)}},{key:"toObservable",value:function(){switch(this.kind){case"N":return Object(x.a)(this.value);case"E":return e=this.error,new k.a(function(t){return t.error(e)});case"C":return Object(s.b)()}var e;throw new Error("unexpected notification kind value")}}],[{key:"createNext",value:function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}},{key:"createError",value:function(t){return new e("E",void 0,t)}},{key:"createComplete",value:function(){return e.completeNotification}}]),e}()).completeNotification=new r("C"),r.undefinedValueNotification=new r("N",void 0),r),R=function(e){f(n,e);var t=p(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return l(this,n),(i=t.call(this,e)).scheduler=r,i.delay=o,i}return d(n,[{key:"scheduleMessage",value:function(e){this.destination.add(this.scheduler.schedule(n.dispatch,this.delay,new C(e,this.destination)))}},{key:"_next",value:function(e){this.scheduleMessage(S.createNext(e))}},{key:"_error",value:function(e){this.scheduleMessage(S.createError(e)),this.unsubscribe()}},{key:"_complete",value:function(){this.scheduleMessage(S.createComplete()),this.unsubscribe()}}],[{key:"dispatch",value:function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()}}]),n}(w.a),C=function e(t,n){l(this,e),this.notification=t,this.destination=n},L=n("9ppp"),I=n("Ylt2"),O=function(e){f(n,e);var t=p(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY,o=arguments.length>2?arguments[2]:void 0;return l(this,n),(e=t.call(this)).scheduler=o,e._events=[],e._infiniteTimeWindow=!1,e._bufferSize=r<1?1:r,e._windowTime=i<1?1:i,i===Number.POSITIVE_INFINITY?(e._infiniteTimeWindow=!0,e.next=e.nextInfiniteTimeWindow):e.next=e.nextTimeWindow,e}return d(n,[{key:"nextInfiniteTimeWindow",value:function(e){if(!this.isStopped){var t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}u(g(n.prototype),"next",this).call(this,e)}},{key:"nextTimeWindow",value:function(e){this.isStopped||(this._events.push(new M(this._getNow(),e)),this._trimBufferThenGetEvents()),u(g(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new L.a;if(this.isStopped||this.hasError?t=h.a.EMPTY:(this.observers.push(e),t=new I.a(this,e)),i&&e.add(e=new R(e,i)),n)for(var a=0;a<o&&!e.closed;a++)e.next(r[a]);else for(var s=0;s<o&&!e.closed;s++)e.next(r[s].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t}},{key:"_getNow",value:function(){return(this.scheduler||y).now()}},{key:"_trimBufferThenGetEvents",value:function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(e-r[o].time<n);)o++;return i>t&&(o=Math.max(o,i-t)),o>0&&r.splice(0,o),r}}]),n}(c.a),M=function e(t,n){l(this,e),this.time=t,this.value=n},P=n("JIr8"),N=n("fXoL"),K=((i=function(){function e(){l(this,e),this.cache={}}return d(e,[{key:"Get",value:function(e,t){var n,r=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.cache[t]||(console.log("CacheService: Request received "+t),this.cache[t]=e.get(t).pipe((n={bufferSize:1,windowTime:void 0,refCount:!1,scheduler:void 0},function(e){return e.lift(function(e){var t,n,r=e.bufferSize,i=void 0===r?Number.POSITIVE_INFINITY:r,o=e.windowTime,a=void 0===o?Number.POSITIVE_INFINITY:o,s=e.refCount,c=e.scheduler,u=0,l=!1,h=!1;return function(e){var r;u++,!t||l?(l=!1,t=new O(i,a,c),r=t.subscribe(this),n=e.subscribe({next:function(e){t.next(e)},error:function(e){l=!0,t.error(e)},complete:function(){h=!0,n=void 0,t.complete()}})):r=t.subscribe(this),this.add(function(){u--,r.unsubscribe(),n&&!h&&s&&0===u&&(n.unsubscribe(),n=void 0,t=void 0)})}}(n))}),Object(P.a)(function(e){return i&&console.log(e),delete r.cache[t],s.a}))),this.cache[t]}}]),e}()).\u0275fac=function(e){return new(e||i)},i.\u0275prov=N.Eb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),_=n("tk/3"),D=((o=function(){function e(t,n,r){l(this,e),this.httpClient=t,this.env=n,this.cache=r,console.log("Using ",n.serverUrl),this.baseUrl=n.serverUrl}return d(e,[{key:"get_map_floor",value:function(e,t){return this.cache.Get(this.httpClient,this.baseUrl+"/buildings/"+e+"/floors/"+t+"/maps")}},{key:"get_map_items",value:function(e,t,n){return this.cache.Get(this.httpClient,this.baseUrl+"/maps?floor="+(null!=t?t:"")+"&campus="+(null!=e?e:"")+"&building="+(null!=n?n:""))}},{key:"get_locations_items",value:function(e,t,n){return this.cache.Get(this.httpClient,this.baseUrl+"/locations?floor="+(null!=t?t:"")+"&campus="+(null!=e?e:"")+"&building="+(null!=n?n:""))}},{key:"get_route",value:function(e,t){return this.cache.Get(this.httpClient,this.baseUrl+"/navigation/dir?start="+e+"&end="+t)}},{key:"get_locations_all",value:function(){return this.cache.Get(this.httpClient,this.baseUrl+"/locations")}},{key:"get_locations_search",value:function(e){return this.cache.Get(this.httpClient,this.baseUrl+"/locations?search="+encodeURI(e))}},{key:"get_location",value:function(e){return this.cache.Get(this.httpClient,this.baseUrl+"/locations/"+encodeURI(e))}},{key:"get_locations",value:function(e,t){return this.cache.Get(this.httpClient,this.baseUrl+"/buildings/"+e+"/floors/"+t+"/locations")}},{key:"get_building",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.cache.Get(this.httpClient,this.baseUrl+"/buildings/"+encodeURI(e),t)}},{key:"get_building_floor",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.cache.Get(this.httpClient,this.baseUrl+"/buildings/"+encodeURI(e)+"/floors",t)}},{key:"get_buildings_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.cache.Get(this.httpClient,this.baseUrl+"/buildings"+(e?"?name="+e:""))}},{key:"get_map_item",value:function(e){return this.cache.Get(this.httpClient,this.baseUrl+"/maps?pathnodeid="+e)}},{key:"get_campus",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.cache.Get(this.httpClient,this.baseUrl+"/campus/"+encodeURI(e),t)}},{key:"get_campus_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.cache.Get(this.httpClient,this.baseUrl+"/campus"+(e?"?search="+e:""))}},{key:"get_rssFeed",value:function(e){return this.httpClient.get(this.baseUrl+"/rssfeed/"+e,{responseType:"text"})}}]),e}()).\u0275fac=function(e){return new(e||o)(N.Tb(_.b),N.Tb(a.a),N.Tb(K))},o.\u0275prov=N.Eb({token:o,factory:o.\u0275fac,providedIn:"root"}),o)},QIvw:function(e,t){e.exports=function(){this.x=0,this.y=0,this.scale=1}},Vkd7:function(e,t){function n(e){return e&&e.parentElement&&e.style}e.exports=function(e,t){if(!n(e))throw new Error("panzoom requires DOM element to be attached to the DOM tree");var r=e.parentElement;return e.scrollTop=0,t.disableKeyboardInteraction||r.setAttribute("tabindex",0),{getBBox:function(){return{left:0,top:0,width:e.clientWidth,height:e.clientHeight}},getOwner:function(){return r},applyTransform:function(t){e.style.transformOrigin="0 0 0",e.style.transform="matrix("+t.scale+", 0, 0, "+t.scale+", "+t.x+", "+t.y+")"}}},e.exports.canAttach=n},cQc6:function(e,t){e.exports=function(e,t){for(var n=e[0],r=e[1],i=!1,o=0,a=t.length-1;o<t.length;a=o++){var s=t[o][0],c=t[o][1],u=t[a][1];c>r!=u>r&&n<(t[a][0]-s)*(r-c)/(u-c)+s&&(i=!i)}return i}},dwjH:function(e,t,n){var r=n("0Tit"),i={ease:r(.25,.1,.25,1),easeIn:r(.42,0,1,1),easeOut:r(0,0,.58,1),easeInOut:r(.42,0,.58,1),linear:r(0,0,1,1)};function o(){}function a(){var e=new Set,t=new Set,n=0;return{next:r,cancel:r,clearAll:function(){e.clear(),t.clear(),cancelAnimationFrame(n),n=0}};function r(e){t.add(e),n||(n=requestAnimationFrame(i))}function i(){n=0;var r=t;t=e,(e=r).forEach(function(e){e()}),e.clear()}}e.exports=function(e,t,n){var r=Object.create(null),a=Object.create(null),s="function"==typeof(n=n||{}).easing?n.easing:i[n.easing];s||(n.easing&&console.warn("Unknown easing function in amator: "+n.easing),s=i.ease);var c="function"==typeof n.step?n.step:o,u="function"==typeof n.done?n.done:o,l=function(e){if(!e)return"undefined"!=typeof window&&window.requestAnimationFrame?{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}:{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}};if("function"!=typeof e.next)throw new Error("Scheduler is supposed to have next(cb) function");if("function"!=typeof e.cancel)throw new Error("Scheduler is supposed to have cancel(handle) function");return e}(n.scheduler),h=Object.keys(t);h.forEach(function(n){r[n]=e[n],a[n]=t[n]-e[n]});var d,f=Math.max(1,.06*("number"==typeof n.duration?n.duration:400)),v=0;return d=l.next(function t(){var n=s(v/f);v+=1,function(t){h.forEach(function(n){e[n]=a[n]*t+r[n]})}(n),v<=f?(d=l.next(t),c(e)):(d=0,setTimeout(function(){u(e)},0))}),{cancel:function(){l.cancel(d),d=0}}},e.exports.makeAggregateRaf=a,e.exports.sharedScheduler=a()},fQX0:function(e,t,n){"use strict";var r=n("fWck"),i=n("dwjH"),o=n("AMdQ"),a=n("6f8I"),s=n("AgEI"),c=s(),u=s(!0),l=n("QIvw"),h=n("wyfB"),d=n("Vkd7");function f(e,t){var n=(t=t||{}).controller;if(n||(h.canAttach(e)?n=h(e,t):d.canAttach(e)&&(n=d(e,t))),!n)throw new Error("Cannot create panzoom for the current type of dom element");var s=n.getOwner(),f={x:0,y:0},p=!1,y=new l;n.initTransform&&n.initTransform(y);var w,x="function"==typeof t.filterKey?t.filterKey:b,k="number"==typeof t.pinchSpeed?t.pinchSpeed:1,S=t.bounds,R="number"==typeof t.maxZoom?t.maxZoom:Number.POSITIVE_INFINITY,C="number"==typeof t.minZoom?t.minZoom:0,L="number"==typeof t.boundsPadding?t.boundsPadding:.05,I="number"==typeof t.zoomDoubleClickSpeed?t.zoomDoubleClickSpeed:1.75,O=t.beforeWheel||b,M=t.beforeMouseDown||b,P="number"==typeof t.zoomSpeed?t.zoomSpeed:1,N=v(t.transformOrigin),K=t.enableTextSelection?u:c;!function(e){var t=typeof e;if("undefined"!==t&&"boolean"!==t&&!(m(e.left)&&m(e.top)&&m(e.bottom)&&m(e.right)))throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}(S),t.autocenter&&function(){var e,t,r=0,i=0,o=Q();if(o)r=o.left,i=o.top,e=o.right-o.left,t=o.bottom-o.top;else{var a=s.getBoundingClientRect();e=a.width,t=a.height}var c=n.getBBox();if(0!==c.width&&0!==c.height){var u=Math.min(e/c.width,t/c.height);y.x=-(c.left+c.width/2)*u+e/2+r,y.y=-(c.top+c.height/2)*u+t/2+i,y.scale=u}}();var _,D,F,T,E,B,A,j,V=0,z=!1,X=!1;E="smoothScroll"in t&&!t.smoothScroll?{start:b,stop:b,cancel:b}:a(function(){return{x:y.x,y:y.y}},function(e,t){Re(),H(e,t)},t.smoothScroll);var G=!1;ie();var J={dispose:function(){oe()},moveBy:re,moveTo:H,smoothMoveTo:function(e,t){re(e-y.x,t-y.y,!0)},centerOn:function(e){var t=e.ownerSVGElement;if(!t)throw new Error("ui element is required to be within the scene");var n=e.getBoundingClientRect(),r=n.left+n.width/2,i=n.top+n.height/2,o=t.getBoundingClientRect();re(o.width/2-r,o.height/2-i,!0)},zoomTo:Se,zoomAbs:ne,smoothZoom:xe,smoothZoomAbs:function(e,t,n){var r={scale:y.scale},o={scale:n};E.cancel(),Re(),A=i(r,o,{step:function(n){ne(e,t,n.scale)}})},showRectangle:function(e){var t=s.getBoundingClientRect(),n=U(t.width,t.height),r=e.right-e.left,i=e.bottom-e.top;if(!Number.isFinite(r)||!Number.isFinite(i))throw new Error("Invalid rectangle");var o=Math.min(n.x/r,n.y/i);y.x=-(e.left+r/2)*o+n.x/2,y.y=-(e.top+i/2)*o+n.y/2,y.scale=o},pause:function(){oe(),G=!0},resume:function(){G&&(ie(),G=!1)},isPaused:function(){return G},getTransform:function(){return y},getMinZoom:function(){return C},setMinZoom:function(e){C=e},getMaxZoom:function(){return R},setMaxZoom:function(e){R=e},getTransformOrigin:function(){return N},setTransformOrigin:function(e){N=v(e)},getZoomSpeed:function(){return P},setZoomSpeed:function(e){if(!Number.isFinite(e))throw new Error("Zoom speed should be a number");P=e}};o(J);var Y="number"==typeof t.initialX?t.initialX:y.x,q="number"==typeof t.initialY?t.initialY:y.y,Z="number"==typeof t.initialZoom?t.initialZoom:y.scale;return Y==y.x&&q==y.y&&Z==y.Scale||ne(Y,q,Z),J;function U(e,t){if(n.getScreenCTM){var r=n.getScreenCTM(),i=r.d,o=r.f;f.x=e*r.a-r.e,f.y=t*i-o}else f.x=e,f.y=t;return f}function H(e,t){y.x=e,y.y=t,$(),Me("pan"),ee()}function W(e,t){H(y.x+e,y.y+t)}function $(){var e=Q();if(e){var t,r,i=!1,o={left:(r={x:(t=n.getBBox()).left*y.scale+y.x,y:t.top*y.scale+y.y}).x,top:r.y,right:t.width*y.scale+r.x,bottom:t.height*y.scale+r.y},a=e.left-o.right;return a>0&&(y.x+=a,i=!0),(a=e.right-o.left)<0&&(y.x+=a,i=!0),(a=e.top-o.bottom)>0&&(y.y+=a,i=!0),(a=e.bottom-o.top)<0&&(y.y+=a,i=!0),i}}function Q(){if(S){if("boolean"==typeof S){var e=s.getBoundingClientRect(),t=e.width,n=e.height;return{left:t*L,top:n*L,right:t*(1-L),bottom:n*(1-L)}}return S}}function ee(){p=!0,w=window.requestAnimationFrame(ae)}function te(e,t,n){if(g(e)||g(t)||g(n))throw new Error("zoom requires valid numbers");var r=y.scale*n;if(r<C){if(y.scale===C)return;n=C/y.scale}if(r>R){if(y.scale===R)return;n=R/y.scale}var i=U(e,t);y.x=i.x-n*(i.x-y.x),y.y=i.y-n*(i.y-y.y),S&&1===L&&1===C?(y.scale*=n,$()):$()||(y.scale*=n),Me("zoom"),ee()}function ne(e,t,n){te(e,t,n/y.scale)}function re(e,t,n){if(!n)return W(e,t);B&&B.cancel();var r=0,o=0;B=i({x:0,y:0},{x:e,y:t},{step:function(e){W(e.x-r,e.y-o),r=e.x,o=e.y}})}function ie(){s.addEventListener("mousedown",ve,{passive:!1}),s.addEventListener("dblclick",fe,{passive:!1}),s.addEventListener("touchstart",ce,{passive:!1}),s.addEventListener("keydown",se,{passive:!1}),r.addWheelListener(s,ye,{passive:!1}),ee()}function oe(){r.removeWheelListener(s,ye),s.removeEventListener("mousedown",ve),s.removeEventListener("keydown",se),s.removeEventListener("dblclick",fe),s.removeEventListener("touchstart",ce),w&&(window.cancelAnimationFrame(w),w=0),E.cancel(),me(),ge(),K.release(),Ie()}function ae(){p&&(p=!1,n.applyTransform(y),Me("transform"),w=0)}function se(e){var t=0,n=0,r=0;if(38===e.keyCode?n=1:40===e.keyCode?n=-1:37===e.keyCode?t=1:39===e.keyCode?t=-1:189===e.keyCode||109===e.keyCode?r=1:187!==e.keyCode&&107!==e.keyCode||(r=-1),!x(e,t,n,r)){if(t||n){e.preventDefault(),e.stopPropagation();var i=s.getBoundingClientRect();re(.05*(o=Math.min(i.width,i.height))*t,.05*o*n)}if(r){var o,a=Ce(100*r);Se((o=N?ke():{x:(c=s.getBoundingClientRect()).width/2,y:c.height/2}).x,o.y,a)}var c}}function ce(e){if(function(e){t.onTouch&&!t.onTouch(e)||(e.stopPropagation(),e.preventDefault())}(e),1===e.touches.length)return function(e){var t=we(e.touches[0]);_=t;var n=U(t.x,t.y);D=n.x,F=n.y,E.cancel(),ue()}(e);2===e.touches.length&&(T=de(e.touches[0],e.touches[1]),j=!0,ue())}function ue(){z||(z=!0,document.addEventListener("touchmove",le),document.addEventListener("touchend",he),document.addEventListener("touchcancel",he))}function le(e){if(1===e.touches.length){e.stopPropagation();var t=U((l=we(e.touches[0])).x,l.y),n=t.x-D,r=t.y-F;0!==n&&0!==r&&Le(),D=t.x,F=t.y,re(n,r)}else if(2===e.touches.length){j=!0;var i=e.touches[0],o=e.touches[1],a=de(i,o),s=1+(a/T-1)*k,c=we(i),u=we(o);if(D=(c.x+u.x)/2,F=(c.y+u.y)/2,N){var l=ke();D=l.x,F=l.y}Se(D,F,s),T=a,e.stopPropagation(),e.preventDefault()}}function he(e){if(e.touches.length>0){var t=U((n=we(e.touches[0])).x,n.y);D=t.x,F=t.y}else{var n,r=new Date;r-V<300&&(N?xe((n=ke()).x,n.y,I):xe(_.x,_.y,I)),V=r,Ie(),ge()}}function de(e,t){var n=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.sqrt(n*n+r*r)}function fe(e){!function(e){t.onDoubleClick&&!t.onDoubleClick(e)||(e.preventDefault(),e.stopPropagation())}(e);var n=we(e);N&&(n=ke()),xe(n.x,n.y,I)}function ve(e){if(!M(e)){if(z)return e.stopPropagation(),!1;if(1===e.button&&null!==window.event||0===e.button){E.cancel();var t=we(e),n=U(t.x,t.y);return D=n.x,F=n.y,document.addEventListener("mousemove",pe),document.addEventListener("mouseup",be),K.capture(e.target||e.srcElement),!1}}}function pe(e){if(!z){Le();var t=we(e),n=U(t.x,t.y),r=n.x-D,i=n.y-F;D=n.x,F=n.y,re(r,i)}}function be(){K.release(),Ie(),me()}function me(){document.removeEventListener("mousemove",pe),document.removeEventListener("mouseup",be),X=!1}function ge(){document.removeEventListener("touchmove",le),document.removeEventListener("touchend",he),document.removeEventListener("touchcancel",he),X=!1,j=!1,z=!1}function ye(e){if(!O(e)){E.cancel();var t=e.deltaY;e.deltaMode>0&&(t*=100);var n=Ce(t);if(1!==n){var r=N?ke():we(e);Se(r.x,r.y,n),e.preventDefault()}}}function we(e){var t=s.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}function xe(e,t,n){var r=y.scale,o={scale:r},a={scale:n*r};E.cancel(),Re(),A=i(o,a,{step:function(n){ne(e,t,n.scale)},done:Oe})}function ke(){var e=s.getBoundingClientRect();return{x:e.width*N.x,y:e.height*N.y}}function Se(e,t,n){return E.cancel(),Re(),te(e,t,n)}function Re(){A&&(A.cancel(),A=null)}function Ce(e){return 1-Math.sign(e)*Math.min(.25,Math.abs(P*e/128))}function Le(){X||(Me("panstart"),X=!0,E.start())}function Ie(){X&&(j||E.stop(),Me("panend"))}function Oe(){Me("zoomend")}function Me(e){J.fire(e,J)}}function v(e){if(e)return"object"==typeof e?(m(e.x)&&m(e.y)||p(e),e):void p()}function p(e){throw console.error(e),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join("\n"))}function b(){}function m(e){return Number.isFinite(e)}function g(e){return Number.isNaN?Number.isNaN(e):e!=e}e.exports=f,function(){if("undefined"!=typeof document){var e=document.getElementsByTagName("script");if(e){for(var t,n=0;n<e.length;++n){var r=e[n];if(r.src&&r.src.match(/\bpanzoom(\.min)?\.js/)){t=r;break}}if(t){var i=t.getAttribute("query");if(i){var o=t.getAttribute("name")||"pz",a=Date.now();!function e(){var n=document.querySelector(i);if(!n)return Date.now()-a<2e3?void setTimeout(e,100):void console.error("Cannot find the panzoom element",o);var r=function(e){for(var t=e.attributes,n={},r=0;r<t.length;++r){var i=s(t[r]);i&&(n[i.name]=i.value)}return n}(t);console.log(r),window[o]=f(n,r)}()}}}}function s(e){if(e.name&&"p"===e.name[0]&&"z"===e.name[1]&&"-"===e.name[2])return{name:e.name.substr(3),value:JSON.parse(e.value)}}}()},fWck:function(e,t){function n(e,t,n){e.addEventListener("wheel",t,n)}e.exports=n,e.exports.addWheelListener=n,e.exports.removeWheelListener=function(e,t,n){e.removeEventListener("wheel",t,n)}},sO0u:function(i,s,c){"use strict";c.r(s),c.d(s,"NavigationPageModule",function(){return ht});var u=c("TEn/"),h=c("tyNb"),f=c("ofXK"),v=c("3Pt+"),p=c("mrSG"),b=c("EnSQ"),m=c("fXoL"),g=function(){function e(t){l(this,e),this.icon=t}return d(e,[{key:"render",value:function(e,t,n,r,i){var o=new Image;o.onload=function(){e.drawImage(o,t,n,r,i)},o.src=this.icon}}]),e}(),y=c("cQc6"),w=function(){function e(t){l(this,e),this.mapItem=t,this.doAnim=!1}return d(e,[{key:"render",value:function(e){this.mapItem.Sections&&this.mapItem.Sections.length>0&&(e.beginPath(),this.renderSections(e),e.strokeStyle="#FFF",e.fillStyle=this.mapItem.Color,e.stroke(),e.fill(),e.closePath())}},{key:"startAnimation",value:function(e,t){var n=this;this.animationCallback=function(){if(!0===n.doAnim){e.save();var r=new Date;if(e.beginPath(),n.renderSections(e),e.lineWidth=1,e.strokeStyle=r.getSeconds()%2==0?"#FFF":"#000",e.fillStyle=r.getSeconds()%2==0?"#000":n.mapItem.Color,e.stroke(),e.fill(),e.closePath(),e.restore(),window.requestAnimationFrame(n.animationCallback),void 0!==t&&void 0!==t.renderer&&void 0!==t.floor){var i,o=a(t.renderer);try{for(o.s();!(i=o.n()).done;){i.value.render(e,t)}}catch(s){o.e(s)}finally{o.f()}}}},this.doAnim=!0,window.requestAnimationFrame(this.animationCallback)}},{key:"stopAnimation",value:function(e){this.doAnim=!1,this.animationCallback=null}},{key:"renderSections",value:function(e){e.moveTo(this.mapItem.Sections[0].Start.X,this.mapItem.Sections[0].Start.Y);for(var t=1;t<this.mapItem.Sections.length;t++)e.lineTo(this.mapItem.Sections[t].Start.X,this.mapItem.Sections[t].Start.Y);e.lineTo(this.mapItem.Sections[0].Start.X,this.mapItem.Sections[0].Start.Y)}},{key:"MapItem",get:function(){return this.mapItem}}]),e}(),x=function(){function e(t){l(this,e),this.location=t}return d(e,[{key:"render",value:function(e){this.location.Icon.length>0?new g("svg/"+this.location.Icon+".svg").render(e,this.location.PathNode.Coordinate.X,this.location.PathNode.Coordinate.Y,20,20):(e.font="12px Arial",e.textAlign="center",e.fillStyle="#000",e.fillText(this.location.Name,this.location.PathNode.Coordinate.X,this.location.PathNode.Coordinate.Y))}},{key:"startAnimation",value:function(e){}},{key:"stopAnimation",value:function(e){}},{key:"Location",get:function(){return this.location}}]),e}(),k=function(){function e(t){l(this,e),this.route=t}return d(e,[{key:"render",value:function(e,t){var n=new g("assets/pin-sharp.png");this.route.Start.Floor===t.floor&&n.render(e,this.route.Start.Node.Coordinate.X-15,this.route.Start.Node.Coordinate.Y-30,30,30);var r=new g("assets/flag-sharp.png");this.route.End.Floor===t.floor&&r.render(e,this.route.End.Node.Coordinate.X-5,this.route.End.Node.Coordinate.Y-30,30,30);var i=this.route.RouteSections.filter(function(e){return e.Floor===t.floor});if(null!=i){var o,s=a(i);try{for(s.s();!(o=s.n()).done;){var c=o.value;e.strokeStyle="#A00",e.lineWidth=3,e.beginPath(),e.moveTo(c.Route[0].Coordinate.X,c.Route[0].Coordinate.Y);for(var u=1;u<c.Route.length;u++)e.lineTo(c.Route[u].Coordinate.X,c.Route[u].Coordinate.Y);e.stroke(),e.closePath()}}catch(w){s.e(w)}finally{s.f()}var l,h=a(i);try{for(h.s();!(l=h.n()).done;){var d=l.value,f=d.Route.length,v=d.Distance,p=d.Route[Math.round((f-1)/2)].Coordinate.X,b=d.Route[Math.round((f-1)/2)].Coordinate.Y,m=e.measureText(v.toString()).width+14,y=parseInt("14px Arial",10)+14;e.fillStyle="#A00",e.fillRect(p-m/2,b-y/2,m,20),e.font="14px Arial",e.fillStyle="#FFF",e.fillText(v.toString(),p,b)}}catch(w){h.e(w)}finally{h.f()}}}},{key:"startAnimation",value:function(e){}},{key:"stopAnimation",value:function(e){}},{key:"Route",get:function(){return this.route}}]),e}(),S=function(){function e(){l(this,e)}return d(e,null,[{key:"GetMapItemRendererCanvas",value:function(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];e.push(new w(a))}return e}},{key:"GetLocationRendererCanvas",value:function(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];e.push(new x(a))}return e}},{key:"GetRouteRendererCanvas",value:function(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];e.push(new k(a))}return e}}]),e}(),R=c("fQX0"),C=c.n(R),L=["fab"];function I(e,t){if(1&e){var n=m.Mb();m.Lb(0,"a",5),m.Xb("click",function(){m.jc(n);var e=t.index;return m.Zb().emitAnotherFloorToShow(e)}),m.Jb(1,"span",6),m.Kb()}if(2&e){var r=t.$implicit,i=m.Zb();m.zb(r===i.currentFloor?"olu-level-control-button-lvl-current":"olu-level-control-button"),m.xb(1),m.ec("innerHTML",r,m.kc)}}var O,M,P,N,K=((M=function(){function e(t){l(this,e),this.dataService=t,this.floorWithBuilding=new m.o}return d(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e.currentBuilding||void 0===this.currentBuilding){t.next=8;break}return t.next=3,this.dataService.get_building(this.currentBuilding).toPromise();case 3:return n=t.sent,t.next=6,this.dataService.get_building_floor(n.Name).toPromise();case 6:r=t.sent,this.availableFloors=r.reverse();case 8:case"end":return t.stop()}},t,this)}))}},{key:"emitAnotherFloorToShow",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.floorWithBuilding.emit({floor:this.availableFloors[e],building:this.currentBuilding}),this.currentFloor=this.availableFloors[e];case 1:case"end":return t.stop()}},t,this)}))}}]),e}()).\u0275fac=function(e){return new(e||M)(m.Ib(b.a))},M.\u0275cmp=m.Cb({type:M,selectors:[["floors-bar"]],viewQuery:function(e,t){var n;1&e&&m.tc(L,!0),2&e&&m.gc(n=m.Yb())&&(t.fab=n.first)},inputs:{currentBuilding:"currentBuilding",currentFloor:"currentFloor"},outputs:{floorWithBuilding:"floorWithBuilding"},features:[m.vb],decls:6,vars:2,consts:[[1,"level-control-container","leaflet-control","leaflet-bar","olu-level-control-container-full","leaflet-control-layers-list"],[1,"olu-level-control-levels"],[1,"olu-control-levels-building-header"],["data-tooltip","Current Building","data-tooltip-pos","left top"],[3,"class","click",4,"ngFor","ngForOf"],[3,"click"],[3,"innerHTML"]],template:function(e,t){1&e&&(m.Lb(0,"div",0),m.Lb(1,"div",1),m.Lb(2,"a",2),m.Lb(3,"span",3),m.pc(4),m.Kb(),m.Kb(),m.oc(5,I,2,3,"a",4),m.Kb(),m.Kb()),2&e&&(m.xb(4),m.qc(t.currentBuilding),m.xb(1),m.ec("ngForOf",t.availableFloors))},directives:[f.i],styles:[".olu-level-control-levels[_ngcontent-%COMP%]{border-bottom:0;color:var(--ion-color-light,#f4f5f8)!important;line-height:150}.olu-level-control-levels[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:46px;padding-bottom:30px;padding-top:8px}.olu-control-levels-building-header[_ngcontent-%COMP%]{color:var(--ion-color-dark-contrast,#f4f5f8)!important;background-color:var(--ion-color-dark,#222428)!important;opacity:.7}.olu-level-control-button[_ngcontent-%COMP%]{background-color:var(--ion-color-primary,#3880ff)!important;color:var(--ion-color-light,#f4f5f8)!important;opacity:.7;cursor:pointer}.olu-level-control-button-lvl-current[_ngcontent-%COMP%]{background-color:var(--ion-color-secondary,#3dc2ff)!important;color:var(--ion-color-dark,#222428)!important;opacity:.7;cursor:pointer}"]}),M),_=((O=function(){function e(t){l(this,e),this.dataService=t,this.clickThreshold=20,this.mapItemRenderer=[],this.locationRenderer=[],this.routeRenderer=[],this.locationClick=new m.o,this.mapScroll=new m.o,this.floorChanged=new m.o}return d(e,[{key:"ngAfterViewInit",value:function(){var e=this;this.panZoomController||(this.panZoomController=C()(document.getElementById("map"),{maxZoom:2,minZoom:.25,initialZoom:.7,bounds:!0,boundsPadding:.1,onTouch:function(t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=1===t.touches.length,!n.t0){n.next=4;break}return n.next=4,e.onElementClick(t.touches[0].clientX,t.touches[0].clientY,t.target);case 4:return n.abrupt("return",!1);case 5:case"end":return n.stop()}},n)}))}}))}},{key:"showRoute",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.stopAllAnimations(),n.next=3,this.renderNavigationPage(e,t.Building,t.Floor);case 3:case"end":return n.stop()}},n,this)}))}},{key:"showDiscoveryLocation",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.stopAllAnimations(),t.next=3,this.dataService.get_locations_search(e).toPromise();case 3:if(null!==(n=t.sent)&&0!==n.length){t.next=6;break}throw new Error("Studi-Guide can't find "+e);case 6:return r=n[0],this.currentBuilding=r.Building,t.next=10,this.dataService.get_map_floor(this.currentBuilding,r.Floor).toPromise();case 10:return i=t.sent,this.mapItemRenderer=S.GetMapItemRendererCanvas.apply(S,o(i)),t.next=14,this.dataService.get_locations(r.Building,r.Floor).toPromise();case 14:return a=t.sent,t.abrupt("return",(this.locationRenderer=S.GetLocationRendererCanvas.apply(S,o(a)),this.clearMapCanvas(),this.createNewCanvasMap(),this.renderMapItems(),this.renderLocations(),this.displayPin(r.PathNode),this.currentFloor=r.Floor,this.CenterMap(r.PathNode.Coordinate.X,r.PathNode.Coordinate.Y),r));case 16:case"end":return t.stop()}},t,this)}))}},{key:"showFloor",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this.stopAllAnimations(),null==this.currentRoute){n.next=5;break}return n.next=3,this.renderNavigationPage(this.currentRoute,this.currentBuilding,e);case 3:n.next=13;break;case 5:return n.next=7,this.dataService.get_map_items("",e,t).toPromise();case 7:return r=n.sent,this.mapItemRenderer=S.GetMapItemRendererCanvas.apply(S,o(r)),this.createNewCanvasMap(),n.next=11,this.dataService.get_locations_items("",e,t).toPromise();case 11:i=n.sent,this.locationRenderer=S.GetLocationRendererCanvas.apply(S,o(i)),this.renderMapItems(),this.renderLocations();case 13:this.currentFloor=e,this.currentBuilding=t,this.FitMap();case 14:case"end":return n.stop()}},n,this)}))}},{key:"showDiscoveryMap",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.dataService.get_map_items(e,t,"").toPromise();case 2:return r=n.sent,this.mapItemRenderer=S.GetMapItemRendererCanvas.apply(S,o(r)),n.next=6,this.dataService.get_locations_items(e,t,"").toPromise();case 6:i=n.sent,this.locationRenderer=S.GetLocationRendererCanvas.apply(S,o(i)),this.createNewCanvasMap(),this.renderMapItems(),this.renderLocations(),this.currentFloor=t,this.FitMap();case 8:case"end":return n.stop()}},n,this)}))}},{key:"clearMapCanvas",value:function(){var e=document.getElementById("map").getContext("2d");null!=e&&e.clearRect(0,0,e.canvas.width,e.canvas.height)}},{key:"onClick",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.onElementClick(e.clientX,e.clientY,e.target);case 2:case"end":return t.stop()}},t,this)}))}},{key:"onElementClick",value:function(e,t,n){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){var i,o,s,c,u,h,f,v,p,b,m,g,w,x,k,S,R,C,L,I;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=this.panZoomController.getTransform(),o=function(){function e(){l(this,e)}return d(e,null,[{key:"transformInOriginCoordinate",value:function(e,t,n){var r=n.getBoundingClientRect(),i=(e.x-r.left)/t,o=(e.y-r.top)/t;return console.log("Transform x:"+e.x+" y:"+e.y+"  to coordinate: x:"+i+" y:"+o),{x:i,y:o}}}]),e}().transformInOriginCoordinate({x:e,y:t},i.scale,n),s=[o.x,o.y],null==this.currentRoute){r.next=18;break}c=[],u=a(this.getInteractiveStairWellMapItemRenderer(this.currentFloor));try{for(u.s();!(h=u.n()).done;)f=h.value,c.push(f.MapItem)}catch(O){u.e(O)}finally{u.f()}v=0,p=c;case 6:if(!(v<p.length)){r.next=18;break}b=p[v],m=[],g=a(b.Sections);try{for(g.s();!(w=g.n()).done;)x=w.value,m.push([x.Start.X,x.Start.Y])}catch(O){g.e(O)}finally{g.f()}if(!y(s,m)){r.next=15;break}return r.next=14,this.showNextFloor(b);case 14:return r.abrupt("return",void r.sent);case 15:v++,r.next=6;break;case 18:k=[],S=a(this.locationRenderer);try{for(S.s();!(R=S.n()).done;)C=R.value,L=C.Location,Math.abs(L.PathNode.Coordinate.X-s[0])<this.clickThreshold&&Math.abs(L.PathNode.Coordinate.Y-s[1])<this.clickThreshold&&k.push(L)}catch(O){S.e(O)}finally{S.f()}k.length>0&&(I=1===k.length?k:k.sort(function(e,t){return Math.abs(e.PathNode.Coordinate.X-s[0])+Math.abs(e.PathNode.Coordinate.Y-s[1])>Math.abs(t.PathNode.Coordinate.X-s[0])+Math.abs(t.PathNode.Coordinate.Y-s[1])?1:-1}),this.locationClick.emit(I[0]));case 22:case"end":return r.stop()}},r,this)}))}},{key:"renderNavigationPage",value:function(e,t,n){var r,i;return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function s(){var c,u,l,h,d,f,v,p,b;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.dataService.get_map_floor(t,n).toPromise();case 2:if(s.t1=r=s.sent,s.t0=null!==s.t1,!s.t0){s.next=6;break}s.t0=void 0!==r;case 6:if(!s.t0){s.next=10;break}s.t2=r,s.next=11;break;case 10:s.t2=new Array;case 11:return c=s.t2,s.next=14,this.dataService.get_locations(t,n).toPromise();case 14:if(s.t4=i=s.sent,s.t3=null!==s.t4,!s.t3){s.next=18;break}s.t3=void 0!==i;case 18:if(!s.t3){s.next=22;break}s.t5=i,s.next=23;break;case 22:s.t5=new Array;case 23:u=s.t5,l=a(e.RouteSections),s.prev=25,l.s();case 27:if((h=l.n()).done){s.next=40;break}if((d=h.value).Floor!==n||d.Building===t){s.next=38;break}return s.next=32,this.dataService.get_map_floor(d.Building,d.Floor).toPromise();case 32:return f=s.sent,c=c.concat(f),s.next=36,this.dataService.get_locations(d.Building,d.Floor).toPromise();case 36:v=s.sent,u=u.concat(v);case 38:s.next=27;break;case 40:s.next=45;break;case 42:s.prev=42,s.t6=s.catch(25),l.e(s.t6);case 45:return s.prev=45,l.f(),s.finish(45);case 48:this.mapItemRenderer=S.GetMapItemRendererCanvas.apply(S,o(c)),this.locationRenderer=S.GetLocationRendererCanvas.apply(S,o(u)),this.routeRenderer=S.GetRouteRendererCanvas(e),this.createNewCanvasMap(),this.currentBuilding=t,this.renderMapItems(),this.renderLocations(),this.renderRoutes({floor:n}),p=a(this.getInteractiveStairWellMapItemRenderer(n));try{for(p.s();!(b=p.n()).done;)b.value.startAnimation(this.renderingContext,{renderer:this.routeRenderer,floor:n})}catch(m){p.e(m)}finally{p.f()}this.currentRoute=e,this.currentFloor=n;case 52:case"end":return s.stop()}},s,this,[[25,42,45,48]])}))}},{key:"createNewCanvasMap",value:function(){var e,t=document.getElementById("map"),n=0,r=0,i=a(this.mapItemRenderer);try{for(i.s();!(e=i.n()).done;){var o=e.value.MapItem;if(o.Sections){var s,c=a(o.Sections);try{for(c.s();!(s=c.n()).done;){var u=s.value;u.End.X>r&&(r=u.End.X),u.End.Y>n&&(n=u.End.Y)}}catch(p){c.e(p)}finally{c.f()}}if(o.PathNodes){var h,f=a(o.PathNodes);try{for(f.s();!(h=f.n()).done;){var v=h.value;v.Coordinate.X>r&&(r=v.Coordinate.X),v.Coordinate.Y>n&&(n=v.Coordinate.Y)}}catch(p){f.e(p)}finally{f.f()}}}}catch(p){i.e(p)}finally{i.f()}this.renderingContext=function(){function e(){l(this,e)}return d(e,null,[{key:"setup",value:function(e,t,n){var r=this.GetPixelRatio();return e.width=t*r,e.height=n*r,e.style.width=t+"px",e.style.height=n+"px",this.getContext(e)}},{key:"getContext",value:function(e){var t=this.GetPixelRatio(),n=e.getContext("2d");return n.scale(t,t),n}},{key:"GetPixelRatio",value:function(){return window.devicePixelRatio||1}}]),e}().setup(t,r,n)}},{key:"displayPin",value:function(e){var t=e.Coordinate.X-30,n=e.Coordinate.Y-40;new g("assets/pin-red.png").render(this.renderingContext,t,n,60,60)}},{key:"showNextFloor",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<this.currentRoute.RouteSections.length-1)){t.next=11;break}if(this.currentRoute.RouteSections[n].Floor!==e.Floor||this.currentRoute.RouteSections[n].Building!==e.Building){t.next=8;break}return this.currentFloor=this.currentRoute.RouteSections[n+1].Floor,this.currentBuilding=this.currentRoute.RouteSections[n+1].Building,t.next=7,this.showFloor(this.currentFloor,this.currentBuilding);case 7:return t.abrupt("return",void t.sent);case 8:n++,t.next=1;break;case 11:case"end":return t.stop()}},t,this)}))}},{key:"getInteractiveStairWellMapItemRenderer",value:function(e){var t,n=this,r=[],i=a(this.routeRenderer);try{for(i.s();!(t=i.n()).done;)for(var o=t.value,s=0;s<o.Route.RouteSections.length-1;s++)o.Route.RouteSections[s].Building===o.Route.RouteSections[s+1].Building&&r.push(o.Route.RouteSections[s].Route[o.Route.RouteSections[s].Route.length-1])}catch(d){i.e(d)}finally{i.f()}for(var c=[],u=function(){var t,r=h[l],i=a(n.mapItemRenderer);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.MapItem.Floor===e&&o.MapItem.PathNodes.filter(function(e){return e.Id===r.Id}).length>0&&c.push(o)}}catch(d){i.e(d)}finally{i.f()}},l=0,h=r;l<h.length;l++)u();return c}},{key:"stopAllAnimations",value:function(){var e,t=a(this.routeRenderer);try{for(t.s();!(e=t.n()).done;)e.value.stopAnimation(this.renderingContext)}catch(s){t.e(s)}finally{t.f()}var n,r=a(this.mapItemRenderer);try{for(r.s();!(n=r.n()).done;)n.value.stopAnimation(this.renderingContext)}catch(s){r.e(s)}finally{r.f()}var i,o=a(this.locationRenderer);try{for(o.s();!(i=o.n()).done;)i.value.stopAnimation(this.renderingContext)}catch(s){o.e(s)}finally{o.f()}}},{key:"renderMapItems",value:function(){var e,t=a(this.mapItemRenderer);try{for(t.s();!(e=t.n()).done;)e.value.render(this.renderingContext)}catch(n){t.e(n)}finally{t.f()}}},{key:"renderLocations",value:function(){var e,t=a(this.locationRenderer);try{for(t.s();!(e=t.n()).done;)e.value.render(this.renderingContext)}catch(n){t.e(n)}finally{t.f()}}},{key:"renderRoutes",value:function(e){var t,n=a(this.routeRenderer);try{for(n.s();!(t=n.n()).done;)t.value.render(this.renderingContext,e)}catch(r){n.e(r)}finally{n.f()}}},{key:"onFloorChangeByFloorButton",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.showAnotherFloorOfCurrentBuilding(e.floor,e.building);case 2:case"end":return t.stop()}},t,this)}))}},{key:"showAnotherFloorOfCurrentBuilding",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return he.progressIsVisible=!0,n.next=3,this.showFloor(e,t);case 3:he.progressIsVisible=!1,this.floorChanged.emit();case 5:case"end":return n.stop()}},n,this)}))}},{key:"CenterMap",value:function(t,n){var r=e.calculateMovePosition(t,n);this.panZoomController.smoothMoveTo(r.x,r.y)}},{key:"MapSize",value:function(){return document.getElementById("map").getBoundingClientRect()}},{key:"FitMap",value:function(){var e=this.MapSize();this.CenterMap(e.width/2,e.height/2)}},{key:"CurrentRoute",get:function(){return this.currentRoute}},{key:"CurrentBuilding",get:function(){return this.currentBuilding}}],[{key:"calculateMovePosition",value:function(e,t){var n=document.getElementById("canvas-wrapper");return{x:n.clientWidth/2-e,y:n.parentElement.parentElement.clientHeight/2-t}}}]),e}()).\u0275fac=function(e){return new(e||O)(m.Ib(b.a))},O.\u0275cmp=m.Cb({type:O,selectors:[["app-map-view"]],outputs:{locationClick:"locationClick",mapScroll:"mapScroll",floorChanged:"floorChanged"},decls:4,vars:2,consts:[["id","canvas-wrapper",1,"draggable"],["id","map",3,"click"],["map",""],[3,"currentBuilding","currentFloor","floorWithBuilding"]],template:function(e,t){1&e&&(m.Lb(0,"div",0),m.Lb(1,"canvas",1,2),m.Xb("click",function(e){return t.onClick(e)}),m.Kb(),m.Kb(),m.Lb(3,"floors-bar",3),m.Xb("floorWithBuilding",function(e){return t.onFloorChangeByFloorButton(e)}),m.Kb()),2&e&&(m.xb(3),m.ec("currentBuilding",t.CurrentBuilding)("currentFloor",t.currentFloor))},directives:[K],styles:["body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{height:100%;width:100%}#canvas-wrapper[_ngcontent-%COMP%]{padding:2px;overflow:hidden;scrollbar-width:none;-ms-overflow-style:none}#canvas-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.draggable[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}floors-bar[_ngcontent-%COMP%]{position:absolute;top:12px;right:0}"]}),O),D=c("tk/3"),F=c("e8h1"),T=((N=function(){function e(t){l(this,e),this.storage=t}return d(e,[{key:"addRecentSearch",value:function(t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.readRecentSearches();case 2:null!==(r=n.sent)&&0!==r.length||(r=[]),i=-1,o=0;case 6:if(!(o<r.length)){n.next=13;break}if(r[o].Name!==t.Name){n.next=10;break}return i=o,n.abrupt("break",13);case 10:o++,n.next=6;break;case 13:return i>=0&&r.splice(i,1),r.unshift(t),r.length>3&&r.pop(),n.next=18,this.storage.set(e.recentSearchesKey,JSON.stringify([r]));case 18:console.log(r);case 19:case"end":return n.stop()}},n,this)}))}},{key:"readRecentSearches",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,this.storage.get(e.recentSearchesKey);case 3:if(t.t1=t.sent,n=t.t0.parse.call(t.t0,t.t1)){t.next=7;break}return t.abrupt("return",[]);case 7:r=[],i=a(n[0]);try{for(i.s();!(o=i.n()).done;)(null==(s=o.value)?void 0:s.Name)&&r.push(s)}catch(c){i.e(c)}finally{i.f()}return t.abrupt("return",r);case 11:case"end":return t.stop()}},t,this)}))}}]),e}()).recentSearchesKey="searches",N.\u0275fac=function(e){return new(e||N)(m.Tb(F.b))},N.\u0275prov=m.Eb({token:N,factory:N.\u0275fac,providedIn:"root"}),N),E=((P=function(){function e(t){var n=this;l(this,e),this.recentSearchesService=t,this.recentSearchesVar=[],this.availableCampus=[],this.Route={Start:{Name:"",LatLng:{lat:0,lng:0}},Destination:{Name:"",LatLng:{lat:0,lng:0}},Coordinates:[],Distance:0,NavigationInstructions:[],Time:0},this.recentSearchesService.readRecentSearches().then(function(e){n.recentSearchesVar=e})}return d(e,[{key:"addRecentSearch",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.recentSearchesService.addRecentSearch(e);case 2:return t.next=4,this.recentSearchesService.readRecentSearches();case 4:this.recentSearchesVar=t.sent;case 5:case"end":return t.stop()}},t,this)}))}},{key:"addRecentSearchCampus",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={Name:e.Name,Description:e.ShortName,Information:[["ShortName: ",e.ShortName],["Longitude: ",e.Longitude],["Latitude: ",e.Latitude]],DetailRouterParams:{},RouteRouterParams:{},LatLng:{lat:e.Latitude,lng:e.Longitude},Images:[]},t.next=3,this.addRecentSearch(n);case 3:case"end":return t.stop()}},t,this)}))}},{key:"addRecentSearchBuilding",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r={Name:e.Name,Description:e.edges.Address.Street+" "+e.edges.Address.Number+", "+e.edges.Address.PLZ,Information:[["Campus: ",e.edges.Campus.Name]],DetailRouterParams:{building:e.Name},RouteRouterParams:{},LatLng:t,Images:[]},n.next=3,this.addRecentSearch(r);case 3:case"end":return n.stop()}},n,this)}))}},{key:"addRecentSearchLocation",value:function(e,t,n){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){var i,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=[["Building: ",e.Name]],n&&i.push(["Address: ",n.edges.Address.Street+" "+n.edges.Address.Number]),e.Tags&&i.push(["Tags: ",e.Tags.join(", ")]),o={Name:e.Name,Description:e.Description,Information:i,DetailRouterParams:{location:e.Name},RouteRouterParams:{start:e.Building+".Entrance",destination:e.Name},LatLng:t,Images:e.Images},r.next=5,this.addRecentSearch(o);case 5:case"end":return r.stop()}},r,this)}))}},{key:"SetOsmRouteAsRoute",value:function(e,t,n){var r,i=[],o=a(e.Points.Coordinates);try{for(o.s();!(r=o.n()).done;){var s=r.value;i.push([s.Lat,s.Lng])}}catch(c){o.e(c)}finally{o.f()}this.Route={Start:t,Destination:n,Coordinates:i,Distance:Math.round(e.Distance),NavigationInstructions:e.Instructions,Time:Math.round(e.Time/1e3/60)}}},{key:"ClearRoute",value:function(){this.Route={Start:{Name:"",LatLng:{lat:0,lng:0}},Destination:{Name:"",LatLng:{lat:0,lng:0}},Distance:0,Coordinates:[],NavigationInstructions:[],Time:0}}},{key:"latestSearchResult",get:function(){return void 0!==this.recentSearches[0]?this.recentSearches[0]:{Name:"",Description:"",Information:[],DetailRouterParams:{},RouteRouterParams:{},LatLng:{lat:0,lng:0},Images:[]}}},{key:"recentSearches",get:function(){return this.recentSearchesVar}}]),e}()).\u0275fac=function(e){return new(e||P)(m.Tb(T))},P.\u0275prov=m.Eb({token:P,factory:P.\u0275fac,providedIn:"root"}),P),B=["destinationSearchbar"],A=["startSearchBar"];function j(e,t){if(1&e){var n=m.Mb();m.Lb(0,"ion-button",10),m.Xb("click",function(){return m.jc(n),m.Zb().emitDiscoveryEvent()}),m.Jb(1,"ion-icon",11),m.Kb()}}function V(e,t){1&e&&m.Jb(0,"span",12)}function z(e,t){if(1&e){var n=m.Mb();m.Lb(0,"ion-button",5),m.Xb("click",function(){return m.jc(n),m.Zb(2).hideRouteSearchBar()}),m.Jb(1,"ion-icon",16),m.Kb()}}function X(e,t){if(1&e){var n=m.Mb();m.Lb(0,"ion-item",0),m.Lb(1,"ion-searchbar",13,14),m.Xb("click",function(){return m.jc(n),m.Zb().onSearchBarHasFocus("startSearchBar")})("keydown",function(e){return m.jc(n),m.Zb().onKey(e,"startSearchBar")},!1,m.ic),m.Kb(),m.oc(3,z,2,0,"ion-button",15),m.Kb()}if(2&e){var r=m.Zb();m.xb(1),m.ec("value",r.startSearchBarValue),m.xb(2),m.ec("ngIf",r.closeRouteBtnIsVisible)}}function G(e,t){if(1&e){var n=m.Mb();m.Lb(0,"ion-item",17),m.Xb("click",function(){m.jc(n);var e=t.$implicit;return m.Zb().discovery.emit(e.Name)}),m.Lb(1,"ion-label"),m.Lb(2,"h2"),m.pc(3),m.Kb(),m.Lb(4,"p",18),m.pc(5),m.Kb(),m.Kb(),m.Kb()}if(2&e){var r=t.$implicit;m.xb(3),m.qc(r.Name),m.xb(2),m.qc(r.Description)}}var J,Y=((J=function(){function e(t,n){l(this,e),this.dataService=t,this.model=n,this.discovery=new m.o,this.route=new m.o,this.searchBarFocus=new m.o,this.searchBtnIsVisible=!0,this.routeInputIsVisible=!1,this.closeRouteBtnIsVisible=!1}return d(e,[{key:"ngOnInit",value:function(){}},{key:"onDestinationInputEvent",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dataService.get_locations_all().toPromise();case 2:n=t.sent,(r=e.target.value.toLowerCase()).length<2?this.locations=[]:(this.locations=[],this.filterIListObjects(this.model.recentSearches,r,2),this.filterIListObjects(n,r,5));case 5:case"end":return t.stop()}},t,this)}))}},{key:"filterIListObjects",value:function(e,t,n){var r,i=a(e);try{for(i.s();!(r=i.n()).done;){var o,s=r.value,c=s.Name.toLowerCase().indexOf(t)>-1||s.Description.toLowerCase().indexOf(t)>-1,u=a(this.locations);try{for(u.s();!(o=u.n()).done;)if(o.value.Name===s.Name){c=!1;break}}catch(l){u.e(l)}finally{u.f()}if(c&&this.locations.push(s),this.locations.length>n)return}}catch(l){i.e(l)}finally{i.f()}}},{key:"showRouteSearchBar",value:function(){this.routeInputIsVisible=!0,this.searchBtnIsVisible=!1,this.closeRouteBtnIsVisible=!0}},{key:"hideRouteSearchBar",value:function(){this.routeInputIsVisible&&(this.routeInputIsVisible=!1,this.searchBtnIsVisible=!0,this.closeRouteBtnIsVisible=!1)}},{key:"routeBtnClick",value:function(){this.routeInputIsVisible?this.emitRouteEvent():this.showRouteSearchBar()}},{key:"emitDiscoveryEvent",value:function(){var e=""===this.destinationSearchbar.value||void 0===this.destinationSearchbar.value;if(!(e=e||null===this.destinationSearchbar.value)){var t=document.activeElement;t&&t.blur&&t.blur(),this.discovery.emit(this.destinationSearchbar.value)}}},{key:"emitRouteEvent",value:function(){var e=""===this.destinationSearchbar.value||void 0===this.destinationSearchbar.value;e=e||null===this.destinationSearchbar.value;var t=""===this.startSearchBar.value||void 0===this.startSearchBar.value;if(t=t||null===this.startSearchBar.value,!e&&!t){var n=[this.startSearchBar.value,this.destinationSearchbar.value],r=document.activeElement;r&&r.blur&&r.blur(),this.route.emit(n)}}},{key:"clearDestinationInput",value:function(){this.destinationSearchbarValue="",this.locations=[]}},{key:"clearStartInput",value:function(){this.startSearchBarValue=""}},{key:"setDiscoverySearchbarValue",value:function(e){this.destinationSearchbarValue=e}},{key:"setStartSearchbarValue",value:function(e){this.startSearchBarValue=e}},{key:"onSearchBarHasFocus",value:function(e){this.searchBarFocus.emit(e)}},{key:"onKey",value:function(e,t){"Enter"===e.key&&("destinationSearchbar"===t&&this.emitDiscoveryEvent(),"startSearchBar"===t&&this.emitRouteEvent())}}]),e}()).\u0275fac=function(e){return new(e||J)(m.Ib(b.a),m.Ib(E))},J.\u0275cmp=m.Cb({type:J,selectors:[["app-search-input"]],viewQuery:function(e,t){var n;1&e&&(m.tc(B,!0),m.tc(A,!0)),2&e&&(m.gc(n=m.Yb())&&(t.destinationSearchbar=n.first),m.gc(n=m.Yb())&&(t.startSearchBar=n.first))},outputs:{discovery:"discovery",route:"route",searchBarFocus:"searchBarFocus"},decls:11,vars:5,consts:[["lines","none"],["search-icon","navigate-circle-outline","inputmode","text","mode","ios","placeholder","destination","color","","icon-color","dark",3,"value","ionInput","click","keydown"],["destinationSearchbar",""],["size","default","mode","ios","color","medium",3,"click",4,"ngIf"],["class","vertical-line",4,"ngIf"],["size","default","mode","ios","color","primary",3,"click"],["size","large","slot","icon-only","src","assets/navigation-svgs/directions-24px.svg"],["lines","none",4,"ngIf"],["locationList",""],["button","",3,"click",4,"ngFor","ngForOf"],["size","default","mode","ios","color","medium",3,"click"],["size","large","slot","icon-only","name","search","color",""],[1,"vertical-line"],["animated","true","color","","icon-color","dark","inputmode","text","mode","ios","placeholder","start","search-icon","locate-outline",3,"value","click","keydown"],["startSearchBar",""],["size","default","mode","ios","color","primary",3,"click",4,"ngIf"],["size","large","slot","icon-only","name","close-outline"],["button","",3,"click"],[1,"ion-text-wrap"]],template:function(e,t){1&e&&(m.Lb(0,"ion-item",0),m.Lb(1,"ion-searchbar",1,2),m.Xb("ionInput",function(e){return t.onDestinationInputEvent(e)})("click",function(){return t.onSearchBarHasFocus("destinationSearchbar")})("keydown",function(e){return t.onKey(e,"destinationSearchbar")},!1,m.ic),m.Kb(),m.oc(3,j,2,0,"ion-button",3),m.oc(4,V,1,0,"span",4),m.Lb(5,"ion-button",5),m.Xb("click",function(){return t.routeBtnClick()}),m.Jb(6,"ion-icon",6),m.Kb(),m.Kb(),m.oc(7,X,4,2,"ion-item",7),m.Lb(8,"ion-list",null,8),m.oc(10,G,6,2,"ion-item",9),m.Kb()),2&e&&(m.xb(1),m.ec("value",t.destinationSearchbarValue),m.xb(2),m.ec("ngIf",t.searchBtnIsVisible),m.xb(1),m.ec("ngIf",t.searchBtnIsVisible),m.xb(3),m.ec("ngIf",t.routeInputIsVisible),m.xb(3),m.ec("ngForOf",t.locations))},directives:[u.v,u.J,u.eb,f.j,u.h,u.t,u.y,f.i,u.x],styles:["ion-searchbar[_ngcontent-%COMP%]{max-width:300px}"]}),J),q=c("+JbE"),Z=c("YD5U"),U=function(){function e(t){l(this,e),this.campus=t,this.addressString=this.getAddressString(this.campus)}return d(e,[{key:"getAddressString",value:function(e){var t="";if(null!==e.edges.Buildings)for(var n=e.edges.Buildings.map(function(e){return e.edges.Address}),r=H(n,function(e){return e.Street}),i=0,o=Object.keys(r);i<o.length;i++){var a=o[i],s=r[a];""!==t&&(t+="; ");var c=s[0].Number;s.length>1&&s[s.length-1].Number!==c&&(c+="-"+s[s.length-1].Number),t+=a+" "+c+", ",t+=r[a][0].PLZ+" "+r[a][0].City}return t}},{key:"Address",get:function(){return this.addressString}},{key:"Name",get:function(){return this.campus.Name}},{key:"ShortName",get:function(){return this.campus.ShortName}},{key:"LatLng",get:function(){return{lat:this.campus.Latitude,lng:this.campus.Longitude}}}]),e}(),H=function(e,t){return e.reduce(function(e,n){var r=t(n);return e[r]||(e[r]=[]),e[r].push(n),e},{})},W=c("gcOT"),$=["drawerContent"],Q=["searchDrawer"],ee=["locationDrawer"];function te(e,t){1&e&&m.Jb(0,"ion-progress-bar",32)}function ne(e,t){if(1&e&&(m.Lb(0,"ion-text",33),m.Lb(1,"h5"),m.Lb(2,"span",34),m.pc(3),m.Kb(),m.Kb(),m.Lb(4,"p"),m.Pb(5,35),m.Kb(),m.Lb(6,"p"),m.Sb(7,36),m.Jb(8,"br"),m.Jb(9,"a",37),m.Qb(),m.Kb(),m.Kb()),2&e){var n=m.Zb();m.xb(3),m.qc(n.errorMessage)}}function re(e,t){if(1&e){var n=m.Mb();m.Lb(0,"ion-item",40),m.Xb("click",function(){m.jc(n);var e=t.$implicit;return m.Zb(2).recentSearchClick(e.Name)}),m.Lb(1,"ion-text"),m.pc(2),m.Kb(),m.Kb()}if(2&e){var r=t.$implicit;m.xb(2),m.qc(r.Name)}}function ie(e,t){if(1&e&&(m.Lb(0,"ion-list",38),m.Lb(1,"ion-list-header"),m.Lb(2,"h2"),m.pc(3,"Recent Searches"),m.Kb(),m.Kb(),m.oc(4,re,3,1,"ion-item",39),m.Kb()),2&e){var n=m.Zb();m.xb(4),m.ec("ngForOf",n.model.recentSearches)}}function oe(e,t){if(1&e&&(m.Lb(0,"ion-row"),m.Lb(1,"ion-col"),m.pc(2),m.Kb(),m.Lb(3,"ion-col"),m.pc(4),m.Kb(),m.Kb()),2&e){var n=t.$implicit;m.xb(2),m.qc(n[0]),m.xb(2),m.qc(n[1])}}function ae(e,t){if(1&e&&m.Jb(0,"img",41),2&e){var n=t.$implicit;m.fc("src",n.Path,m.lc),m.fc("alt",n.Name)}}var se,ce,ue,le=W.a.Keyboard,he=((ce=function(){function e(t,n,r,i,o,a){l(this,e),this.dataService=t,this.modalCtrl=n,this.route=r,this.router=i,this.model=o,this.platform=a,this.availableCampus=[],this.isSubscribed=!1}return d(e,[{key:"ngAfterViewInit",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.locationDrawer.SetState(q.a.Hidden),this.searchDrawer.SetState(Z.a.GetRecommendedDrawerStateForDevice())]);case 2:case"end":return e.stop()}},e,this)}))}},{key:"ionViewDidEnter",value:function(){var e=this;!1===this.isSubscribed&&(this.isSubscribed=!0,this.route.queryParams.subscribe(function(t){return Object(p.a)(e,void 0,void 0,regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null!=t&&null!=t.location&&t.location.length>0)){e.next=5;break}return this.searchInput.setDiscoverySearchbarValue(t.location),e.next=4,this.onDiscovery(t.location);case 4:return e.abrupt("return",void e.sent);case 5:if(!(null!=t&&null!=t.start&&t.start.length>0&&null!=t.destination&&t.destination.length>0)){e.next=10;break}return e.next=8,this.showNavigation(t.start,t.destination);case 8:e.next=24;break;case 10:if(!(null!=t&&null!=t.building&&t.building.length>0)){e.next=22;break}return e.next=13,this.dataService.get_building(t.building).toPromise();case 13:if(null===(n=e.sent)){e.next=20;break}return e.next=17,this.dataService.get_building_floor(n.Name).toPromise();case 17:return r=e.sent,e.next=20,this.mapView.showFloor((null==r?void 0:r.includes("EG"))?"EG":r[0],n.Name);case 20:e.next=24;break;case 22:return e.next=24,this.showDiscoveryMode();case 24:case"end":return e.stop()}},e,this)}))}))}},{key:"ngOnInit",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.model.availableCampus.length){e.next=6;break}return e.next=3,this.dataService.get_campus_search().toPromise();case 3:t=e.sent,n=a(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this.model.availableCampus.push(new U(i))}catch(o){n.e(o)}finally{n.f()}case 6:case"end":return e.stop()}},e,this)}))}},{key:"onDiscovery",value:function(t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.model.errorMessage="",e.progressIsVisible=!0,n.prev=1,n.next=4,this.mapView.showDiscoveryLocation(t);case 4:return r=n.sent,n.next=7,this.dataService.get_building(r.Building).toPromise();case 7:return i=n.sent,n.next=10,this.model.addRecentSearchLocation(r,{lat:0,lng:0},i);case 10:return n.next=12,this.showLocationDrawer(r);case 12:n.next=17;break;case 14:n.prev=14,n.t0=n.catch(1),this.handleInputError(n.t0,t);case 17:return n.prev=17,e.progressIsVisible=!1,n.finish(17);case 20:case"end":return n.stop()}},n,this,[[1,14,17,20]])}))}},{key:"onRoute",value:function(t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,o,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.errorMessage="",e.progressIsVisible=!0,n.prev=1,n.next=4,this.dataService.get_location(t[0]).toPromise();case 4:return r=n.sent,n.next=7,this.dataService.get_route(t[0],t[1]).toPromise();case 7:return i=n.sent,n.next=10,this.mapView.showRoute(i,r);case 10:this.mapView.CenterMap(r.PathNode.Coordinate.X,r.PathNode.Coordinate.Y),n.next=18;break;case 13:n.prev=13,n.t0=n.catch(1),o="",n.t0 instanceof D.d&&((a=n.t0.error.message).includes(t[0])&&(o=t[0]),a.includes(t[1])&&(o.length>0&&(o+=" and "),o+=t[1])),this.handleInputError(n.t0,0===o.length?t.toString():o);case 18:return n.prev=18,e.progressIsVisible=!1,n.finish(18);case 21:case"end":return n.stop()}},n,this,[[1,13,18,21]])}))}},{key:"onDrawerStateChange",value:function(e){void 0!==this.drawerContent&&(this.drawerContent.scrollY=e===q.a.Top)}},{key:"showLocationDrawer",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.locationDrawer.SetState(q.a.Hidden);case 2:if(this.model.latestSearchResult.Name=e.Name,this.model.latestSearchResult.Description=e.Description,this.model.latestSearchResult.Information=e.Tags?[["Tags: ",e.Tags.join(",")]]:[],this.model.latestSearchResult.Images=e.Images,t.t0=this.platform.is("hybrid"),!t.t0){t.next=10;break}return t.next=10,le.hide();case 10:return t.next=12,this.searchDrawer.SetState(q.a.Hidden);case 12:return t.next=14,this.locationDrawer.SetState(Z.a.GetRecommendedDrawerStateForDevice());case 14:case"end":return t.stop()}},t,this)}))}},{key:"onCloseLocationDrawer",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.locationDrawer.SetState(q.a.Hidden);case 2:return e.next=4,this.searchDrawer.SetState(Z.a.GetRecommendedDrawerStateForDevice());case 4:case"end":return e.stop()}},e,this)}))}},{key:"handleInputError",value:function(e,t){if(console.log(e),e instanceof D.d){var n=e;this.errorMessage=400===n.status?"Studi-Guide can't find "+t:n.message}else this.errorMessage=e.message;null!=this.mapView&&this.mapView.clearMapCanvas()}},{key:"navigationBtnClick",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null==this.model.latestSearchResult){t.next=16;break}return t.prev=1,t.next=4,this.dataService.get_location(this.model.latestSearchResult.Name).toPromise();case 4:return n=t.sent,t.next=7,this.showNavigation(n.Building+".Entrance",n.Name);case 7:t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),r="",t.t0 instanceof D.d&&t.t0.error.message.includes(this.model.latestSearchResult.Name)&&(r=this.model.latestSearchResult.Name),this.handleInputError(t.t0,0===r.length?this.model.latestSearchResult.Name:r);case 13:return t.prev=13,e.progressIsVisible=!1,t.finish(13);case 16:case"end":return t.stop()}},t,this,[[1,9,13,16]])}))}},{key:"showNavigation",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.searchInput.showRouteSearchBar(),this.searchInput.setDiscoverySearchbarValue(t),this.searchInput.setStartSearchbarValue(e),n.next=5,this.onCloseLocationDrawer(null);case 5:return n.next=7,this.onRoute([e,t]);case 7:case"end":return n.stop()}},n,this)}))}},{key:"showDiscoveryMode",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null==this.mapView.CurrentRoute&&null==this.mapView.CurrentBuilding,!e.t0){e.next=5;break}return e.next=4,this.mapView.showDiscoveryMap("","EG");case 4:this.mapView.CenterMap(310,550);case 5:case"end":return e.stop()}},e,this)}))}},{key:"recentSearchClick",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.router.navigate(["tabs/navigation/detail"],{queryParams:{location:e}});case 2:case"end":return t.stop()}},t,this)}))}},{key:"presentMapPage",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.router.navigate(["tabs/navigation/"]);case 2:case"end":return e.stop()}},e,this)}))}},{key:"onFloorChanged",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.searchInput.clearStartInput(),this.searchInput.clearDestinationInput(),e.next=4,this.onCloseLocationDrawer(null);case 4:case"end":return e.stop()}},e,this)}))}},{key:"ProgressIsVisible",get:function(){return e.progressIsVisible}}]),e}()).progressIsVisible=!1,ce.\u0275fac=function(e){return new(e||ce)(m.Ib(b.a),m.Ib(u.Y),m.Ib(h.a),m.Ib(h.g),m.Ib(E),m.Ib(u.ab))},ce.\u0275cmp=m.Cb({type:ce,selectors:[["app-navigation"]],viewQuery:function(e,t){var n;1&e&&(m.tc(_,!0),m.tc(Y,!0),m.tc($,!0),m.tc(Q,!0),m.tc(ee,!0)),2&e&&(m.gc(n=m.Yb())&&(t.mapView=n.first),m.gc(n=m.Yb())&&(t.searchInput=n.first),m.gc(n=m.Yb())&&(t.drawerContent=n.first),m.gc(n=m.Yb())&&(t.searchDrawer=n.first),m.gc(n=m.Yb())&&(t.locationDrawer=n.first))},decls:57,vars:8,consts:function(){return[["translucent",""],["slot","start"],["id","close-open-map","defaultHref","/"],["data-tap-disabled","true","scroll-y","false"],["type","indeterminate","color","secondary",4,"ngIf"],["id","map-content"],["id","error-message",4,"ngIf"],[3,"locationClick","floorChanged"],[3,"stateChange"],["searchDrawer",""],[1,"nav-bottom-drawer"],[1,"drawer-grip"],[1,"ion-padding-top"],[1,"nav-hbar"],[3,"discovery","route"],[1,"ion-item-style"],["drawerContent",""],["class","ion-no-padding",4,"ngIf"],[1,"ion-padding-vertical"],["state","DrawerState.Hidden"],["locationDrawer",""],[1,"nav-bottom-drawer","ion-background"],[1,"ion-padding-bottom"],["id","locationdrawerContent"],[1,"ion-justify-content-between","ion-align-self-center"],[1,"ion-justify-content-end","ion-padding-horizontal"],["shape","round","color","medium",1,"square-sm","ion-no-padding","ion-float-right",3,"click"],["slot","icon-only","name","close-outline","size","small"],["id","routeBtn","color","primary","expand","block",3,"click"],[4,"ngFor","ngForOf"],[1,"ion-padding-horizontal"],["class","ion-no-margin ion-padding-end ion-img",3,"src","alt",4,"ngFor","ngForOf"],["type","indeterminate","color","secondary"],["id","error-message"],[1,"error"],"Make sure your search is spelled correctly.","Should this place be on Studi-Guide? " + "\ufffd#8\ufffd\ufffd/#8\ufffd" + "" + "\ufffd#9\ufffd" + "Request a missing place" + "\ufffd/#9\ufffd" + "",["href","https://github.com/Studi-Guide/Studi-Guide/issues/new/choose"],[1,"ion-no-padding"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],[1,"ion-no-margin","ion-padding-end","ion-img",3,"src","alt"]]},template:function(e,t){1&e&&(m.Lb(0,"ion-header",0),m.Lb(1,"ion-toolbar"),m.Lb(2,"ion-buttons",1),m.Jb(3,"ion-back-button",2),m.Kb(),m.Kb(),m.Kb(),m.Lb(4,"ion-content",3),m.oc(5,te,1,0,"ion-progress-bar",4),m.Lb(6,"div",5),m.oc(7,ne,10,1,"ion-text",6),m.Lb(8,"app-map-view",7),m.Xb("locationClick",function(e){return t.showLocationDrawer(e)})("floorChanged",function(e){return t.onFloorChanged(e)}),m.Kb(),m.Kb(),m.Kb(),m.Lb(9,"app-ionic-bottom-drawer",8,9),m.Xb("stateChange",function(e){return t.onDrawerStateChange(e)}),m.Lb(11,"div",10),m.Lb(12,"div",11),m.Jb(13,"div",12),m.Jb(14,"div",13),m.Lb(15,"app-search-input",14),m.Xb("discovery",function(e){return t.onDiscovery(e)})("route",function(e){return t.onRoute(e)}),m.Kb(),m.Kb(),m.Lb(16,"ion-content",15,16),m.oc(18,ie,5,1,"ion-list",17),m.Jb(19,"div",18),m.Jb(20,"div",18),m.Jb(21,"div",18),m.Jb(22,"div",18),m.Jb(23,"div",18),m.Jb(24,"div",18),m.Kb(),m.Kb(),m.Kb(),m.Lb(25,"app-ionic-bottom-drawer",19,20),m.Lb(27,"div",21),m.Lb(28,"div",11),m.Jb(29,"div",12),m.Jb(30,"div",13),m.Jb(31,"div",22),m.Kb(),m.Lb(32,"ion-content",15),m.Lb(33,"ion-grid",23),m.Lb(34,"ion-row",24),m.Lb(35,"ion-col"),m.Lb(36,"ion-label"),m.Lb(37,"h1"),m.pc(38),m.Kb(),m.Kb(),m.Lb(39,"ion-text"),m.pc(40),m.Kb(),m.Kb(),m.Lb(41,"ion-col",25),m.Lb(42,"ion-button",26),m.Xb("click",function(e){return t.onCloseLocationDrawer(e)}),m.Jb(43,"ion-icon",27),m.Kb(),m.Kb(),m.Kb(),m.Lb(44,"ion-row"),m.Lb(45,"ion-col"),m.Lb(46,"ion-button",28),m.Xb("click",function(){return t.navigationBtnClick()}),m.pc(47," Route "),m.Kb(),m.Kb(),m.Kb(),m.Lb(48,"ion-row"),m.Lb(49,"ion-col"),m.pc(50,"Description:"),m.Kb(),m.Lb(51,"ion-col"),m.pc(52),m.Kb(),m.Kb(),m.oc(53,oe,5,2,"ion-row",29),m.Lb(54,"div",30),m.Lb(55,"app-ionic-horizontal-scrollable"),m.oc(56,ae,1,2,"img",31),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb()),2&e&&(m.xb(5),m.ec("ngIf",t.ProgressIsVisible),m.xb(2),m.ec("ngIf",t.errorMessage),m.xb(11),m.ec("ngIf",t.model.recentSearches.length>0),m.xb(20),m.qc(t.model.latestSearchResult.Name),m.xb(2),m.qc(t.model.latestSearchResult.Description),m.xb(12),m.qc(t.model.latestSearchResult.Description),m.xb(1),m.ec("ngForOf",t.model.latestSearchResult.Information),m.xb(3),m.ec("ngForOf",t.model.latestSearchResult.Images))},styles:["#map-content[_ngcontent-%COMP%]{height:100%;width:100%;position:fixed}.error[_ngcontent-%COMP%]{color:red}#error-message[_ngcontent-%COMP%]{margin-left:20px}#available-floors-btn[_ngcontent-%COMP%]{position:fixed;bottom:0;display:block;z-index:10}.center[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;display:block}ion-progress-bar[_ngcontent-%COMP%]{position:absolute;z-index:9999}.vertical-line[_ngcontent-%COMP%]{border-left:2px solid #9d9fa6;height:38px}.nav-hbar[_ngcontent-%COMP%]{border-top:2px solid var(--ion-color-medium,#9d9fa6);border-bottom:2px solid var(--ion-color-medium,#9d9fa6);border-radius:2px;height:0;width:auto;margin:0 45%}.nav-bottom-drawer[_ngcontent-%COMP%]{background-color:var(--ion-item-background,#fff);border-top-left-radius:20px;border-top-right-radius:20px;box-shadow:0 4px 8px 0 rgba(0,0,0,.4),0 6px 20px 0 rgba(0,0,0,.29);height:inherit;z-index:1}.square-md[_ngcontent-%COMP%]{height:64px;width:64px}.square-sm[_ngcontent-%COMP%]{height:32px;width:32px}.square-xs[_ngcontent-%COMP%]{height:16px;width:16px}#locationdrawerContent[_ngcontent-%COMP%]{margin-left:30px;margin-right:30px;position:center}#locationdrawerName[_ngcontent-%COMP%]{font-weight:700}.ion-img[_ngcontent-%COMP%]{height:200px}"]}),ce),de=((se=function e(){l(this,e)}).\u0275mod=m.Gb({type:se}),se.\u0275inj=m.Fb({factory:function(e){return new(e||se)},imports:[[f.b,u.V]]}),se),fe=c("4R65"),ve=c("Bfh1"),pe=c("AytR"),be=((ue=function(){function e(t,n,r){l(this,e),this.locale=t,this.httpClient=n,this.env=r}return d(e,[{key:"GetRoute",value:function(t,n){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.httpClient.get(this.env.serverUrl+e.serverPathPrefix+e.routePath+"?start="+t.lat+","+t.lng+"&end="+n.lat+","+n.lng+"&locale="+this.locale).toPromise();case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,this)}))}},{key:"GetBounds",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.httpClient.get(this.env.serverUrl+e.serverPathPrefix+e.boundsPath).toPromise();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}}]),e}()).serverPathPrefix="/osm",ue.routePath="/route",ue.boundsPath="/bounds",ue.\u0275fac=function(e){return new(e||ue)(m.Tb(m.v),m.Tb(D.b),m.Tb(pe.a))},ue.\u0275prov=m.Eb({token:ue,factory:ue.\u0275fac,providedIn:"root"}),ue),me=["ionSlides"];function ge(e,t){if(1&e&&(m.Lb(0,"ion-slide"),m.Lb(1,"ion-text"),m.Lb(2,"h2"),m.pc(3),m.Kb(),m.Lb(4,"p"),m.pc(5),m.Kb(),m.Kb(),m.Kb()),2&e){var n=t.$implicit;m.xb(3),m.qc(n.Text),m.xb(2),m.rc("",n.Distance,"m")}}var ye,we,xe=((we=function(){function e(t){l(this,e),this.element=t,this.nextSlide=new m.o,this.previousSlide=new m.o,this.slideOpts={initialSlide:0,speed:400}}return d(e,[{key:"ngOnInit",value:function(){this.hide()}},{key:"onPrevSlide",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this.previousSlide,e.next=3,this.ionSlides.getActiveIndex();case 3:e.t1=e.sent,e.t0.emit.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e,this)}))}},{key:"onNextSlide",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this.nextSlide,e.next=3,this.ionSlides.getActiveIndex();case 3:e.t1=e.sent,e.t0.emit.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e,this)}))}},{key:"hide",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.element.nativeElement.hidden=!0;case 1:case"end":return e.stop()}},e,this)}))}},{key:"show",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.element.nativeElement.hidden=!1;case 1:case"end":return e.stop()}},e,this)}))}}]),e}()).\u0275fac=function(e){return new(e||we)(m.Ib(m.m))},we.\u0275cmp=m.Cb({type:we,selectors:[["app-navigation-instruction-slides"]],viewQuery:function(e,t){var n;1&e&&m.tc(me,!0),2&e&&m.gc(n=m.Yb())&&(t.ionSlides=n.first)},inputs:{instructions:"instructions"},outputs:{nextSlide:"nextSlide",previousSlide:"previousSlide"},decls:4,vars:2,consts:[["pager","true",3,"options","ionSlideNextEnd","ionSlidePrevEnd"],["ionSlides",""],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(m.Lb(0,"ion-item"),m.Lb(1,"ion-slides",0,1),m.Xb("ionSlideNextEnd",function(){return t.onNextSlide()})("ionSlidePrevEnd",function(){return t.onPrevSlide()}),m.oc(3,ge,6,2,"ion-slide",2),m.Kb(),m.Kb()),2&e&&(m.xb(1),m.ec("options",t.slideOpts),m.xb(2),m.ec("ngForOf",t.instructions))},directives:[u.v,u.N,f.i,u.M,u.R],styles:["[_nghost-%COMP%]{z-index:auto}ion-slide[_ngcontent-%COMP%]{height:100%;width:100%}@media (min-width:992px){ion-slide[_ngcontent-%COMP%]{padding-bottom:2em}}@media (max-width:991.98px){ion-slide[_ngcontent-%COMP%]{padding-bottom:.5em}}"]}),we),ke=((ye=function(){function e(){l(this,e)}return d(e,[{key:"load",value:function(t,n,r){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t.ready().then(function(){return Object(p.a)(o,void 0,void 0,regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.get(e.LAST_MAP_EVENT_KEY).then(function(e){n.setView([49.452368,11.093299],r),null!=e&&n.flyTo(e.center,e.zoom)});case 2:case"end":return i.stop()}},i)}))});case 1:case"end":return i.stop()}},i)}))}}],[{key:"persist",value:function(e,t){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.set(this.LAST_MAP_EVENT_KEY,t);case 2:case"end":return n.stop()}},n,this)}))}}]),e}()).LAST_MAP_EVENT_KEY="lastOpenStreetMapEventTarget",ye.\u0275fac=function(e){return new(e||ye)},ye.\u0275prov=m.Eb({token:ye,factory:ye.\u0275fac,providedIn:"root"}),ye),Se=["inputFrom"],Re=["inputTo"];function Ce(e,t){if(1&e){var n=m.Mb();m.Lb(0,"ion-item",12),m.Xb("click",function(){return m.jc(n),m.Zb().listMyLocationClick()}),m.Lb(1,"ion-text"),m.pc(2,"My Location"),m.Kb(),m.Kb()}}function Le(e,t){if(1&e){var n=m.Mb();m.Lb(0,"ion-item",12),m.Xb("click",function(){m.jc(n);var e=t.$implicit;return m.Zb().listRecentSearchClick(e)}),m.Lb(1,"ion-text"),m.pc(2),m.Kb(),m.Kb()}if(2&e){var r=t.$implicit;m.xb(2),m.qc(r.Name)}}var Ie,Oe,Me=function(e){return e[e.No=0]="No",e[e.From=1]="From",e[e.To=2]="To",e}({}),Pe=((Ie=function(){function e(t,n){l(this,e),this.model=t,this.geolocation=n,this.inputToCurrentlyActive=!1,this.myLocationInInput=Me.From}return d(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.UpdateFromNavigationModel(),this.inputToCurrentlyActive=!1,e.next=4,this.inputFrom.setFocus();case 4:case"end":return e.stop()}},e,this)}))}},{key:"SetFocus",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.inputToCurrentlyActive){e.next=5;break}return e.next=3,this.inputTo.setFocus();case 3:e.next=7;break;case 5:return e.next=7,this.inputFrom.setFocus();case 7:case"end":return e.stop()}},e,this)}))}},{key:"toggleActiveInput",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.inputToCurrentlyActive=!this.inputToCurrentlyActive,e.next=3,this.SetFocus();case 3:case"end":return e.stop()}},e,this)}))}},{key:"updateInputValues",value:function(){this.inputFrom.value=this.routeLocationFrom.Name,this.inputTo.value=this.routeLocationTo.Name}},{key:"UpdateFromNavigationModel",value:function(){this.routeLocationFrom=this.model.Route.Start,this.routeLocationTo=this.model.Route.Destination,this.updateInputValues()}},{key:"showMyLocation",value:function(){return this.myLocationInInput===Me.No}},{key:"onInputFromFocus",value:function(){this.inputToCurrentlyActive=!1}},{key:"onInputToFocus",value:function(){this.inputToCurrentlyActive=!0}},{key:"swapInputs",value:function(){var e=this.routeLocationFrom;this.routeLocationFrom=this.routeLocationTo,this.routeLocationTo=e,this.myLocationInInput!==Me.No&&(this.myLocationInInput=this.myLocationInInput===Me.From?Me.To:Me.From),this.updateInputValues()}},{key:"listRecentSearchClick",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.inputToCurrentlyActive?(this.routeLocationTo=e,this.myLocationInInput===Me.To&&(this.myLocationInInput=Me.No)):(this.routeLocationFrom=e,this.myLocationInInput===Me.From&&(this.myLocationInInput=Me.No)),this.updateInputValues(),t.next=4,this.toggleActiveInput();case 4:case"end":return t.stop()}},t,this)}))}},{key:"listMyLocationClick",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.geolocation.getCurrentPosition();case 2:return t=e.sent,n={Name:"My Location",LatLng:{lat:t.coords.latitude,lng:t.coords.longitude}},this.inputToCurrentlyActive?(this.routeLocationTo=n,this.myLocationInInput=Me.To):(this.routeLocationFrom=n,this.myLocationInInput=Me.From),this.updateInputValues(),e.next=8,this.toggleActiveInput();case 8:case"end":return e.stop()}},e,this)}))}},{key:"From",get:function(){return this.routeLocationFrom}},{key:"To",get:function(){return this.routeLocationTo}}]),e}()).\u0275fac=function(e){return new(e||Ie)(m.Ib(E),m.Ib(ve.a))},Ie.\u0275cmp=m.Cb({type:Ie,selectors:[["app-route-input"]],viewQuery:function(e,t){var n;1&e&&(m.tc(Se,!0),m.tc(Re,!0)),2&e&&(m.gc(n=m.Yb())&&(t.inputFrom=n.first),m.gc(n=m.Yb())&&(t.inputTo=n.first))},decls:22,vars:2,consts:[[1,"container"],[1,"ion-no-padding","ion-item-style"],["size","11"],[1,"ion-margin-end"],[3,"ionFocus"],["inputFrom",""],["inputTo",""],["size","1",1,"swappicon","ion-activatable","ripple-parent",3,"click"],["size","large","name","swap-vertical-outline"],[1,"ion-no-padding"],["button","",3,"click",4,"ngIf"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"]],template:function(e,t){1&e&&(m.Lb(0,"div",0),m.Lb(1,"ion-item",1),m.Lb(2,"ion-grid"),m.Lb(3,"ion-row"),m.Lb(4,"ion-col",2),m.Lb(5,"ion-item"),m.Lb(6,"ion-label",3),m.pc(7,"From:"),m.Kb(),m.Lb(8,"ion-input",4,5),m.Xb("ionFocus",function(){return t.onInputFromFocus()}),m.Kb(),m.Kb(),m.Lb(10,"ion-item"),m.Lb(11,"ion-label",3),m.pc(12,"To:"),m.Kb(),m.Lb(13,"ion-input",4,6),m.Xb("ionFocus",function(){return t.onInputToFocus()}),m.Kb(),m.Kb(),m.Kb(),m.Lb(15,"ion-col",7),m.Xb("click",function(){return t.swapInputs()}),m.Jb(16,"ion-icon",8),m.Jb(17,"ion-ripple-effect"),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Lb(18,"ion-content"),m.Lb(19,"ion-list",9),m.oc(20,Ce,3,0,"ion-item",10),m.oc(21,Le,3,1,"ion-item",11),m.Kb(),m.Kb()),2&e&&(m.xb(20),m.ec("ngIf",t.showMyLocation()),m.xb(1),m.ec("ngForOf",t.model.recentSearches))},directives:[u.v,u.r,u.I,u.o,u.x,u.u,u.eb,u.t,u.G,u.p,u.y,f.j,f.i,u.R],styles:[".container[_ngcontent-%COMP%]{position:relative}.container[_ngcontent-%COMP%], .input-container[_ngcontent-%COMP%]{width:100%;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.input-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.swappicon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.swappicon[_ngcontent-%COMP%]:hover{cursor:pointer}.ripple-parent[_ngcontent-%COMP%]{position:relative;overflow:hidden}"]}),Ie),Ne=["*"],Ke=((Oe=function(){function e(){l(this,e)}return d(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Oe)},Oe.\u0275cmp=m.Cb({type:Oe,selectors:[["app-ionic-horizontal-scrollable"]],ngContentSelectors:Ne,decls:2,vars:0,consts:[[1,"scroll-x-container"]],template:function(e,t){1&e&&(m.dc(),m.Lb(0,"div",0),m.cc(1),m.Kb())},styles:["[_nghost-%COMP%]     .scroll-x-container>*{display:inline-block}.scroll-x-container[_ngcontent-%COMP%]{overflow-x:auto;white-space:nowrap}"]}),Oe),_e=["drawerContent"],De=["searchDrawer"],Fe=["locationDrawer"],Te=["routeDrawer"],Ee=["inNavigationDrawer"],Be=["changeRouteDrawer"],Ae=["routeInput"];function je(e,t){if(1&e){var n=m.Mb();m.Lb(0,"ion-item",43),m.Xb("click",function(){m.jc(n);var e=t.$implicit;return m.Zb(2).search.emit(e.Name)}),m.Lb(1,"ion-text"),m.pc(2),m.Kb(),m.Kb()}if(2&e){var r=t.$implicit;m.xb(2),m.qc(r.Name)}}function Ve(e,t){if(1&e&&(m.Lb(0,"ion-list",11),m.Lb(1,"ion-list-header"),m.Lb(2,"h2"),m.pc(3,"Recent Searches"),m.Kb(),m.Kb(),m.oc(4,je,3,1,"ion-item",12),m.Kb()),2&e){var n=m.Zb();m.xb(4),m.ec("ngForOf",n.model.recentSearches)}}function ze(e,t){if(1&e){var n=m.Mb();m.Lb(0,"ion-item",43),m.Xb("click",function(){m.jc(n);var e=t.$implicit;return m.Zb().campusClick.emit(e)}),m.Lb(1,"ion-label"),m.Lb(2,"h2"),m.pc(3),m.Kb(),m.Lb(4,"h3"),m.pc(5),m.Kb(),m.Kb(),m.Kb()}if(2&e){var r=t.$implicit;m.xb(3),m.sc("",r.ShortName,": ",r.Name,""),m.xb(2),m.qc(r.Address)}}function Xe(e,t){if(1&e&&(m.Lb(0,"ion-row"),m.Lb(1,"ion-col"),m.pc(2),m.Kb(),m.Lb(3,"ion-col"),m.pc(4),m.Kb(),m.Kb()),2&e){var n=t.$implicit;m.xb(2),m.qc(n[0]),m.xb(2),m.qc(n[1])}}function Ge(e,t){if(1&e&&m.Jb(0,"img",44),2&e){var n=t.$implicit;m.fc("src",n.Path,m.lc),m.fc("alt",n.Name)}}function Je(e,t){1&e&&m.Jb(0,"ion-progress-bar",45)}function Ye(e,t){if(1&e){var n=m.Mb();m.Lb(0,"ion-button",47),m.Xb("click",function(){return m.jc(n),m.Zb(2).onLaunchNavigationClick()}),m.pc(1," Go "),m.Kb()}}function qe(e,t){if(1&e&&(m.Lb(0,"ion-row"),m.Lb(1,"ion-col"),m.Lb(2,"ion-label"),m.Lb(3,"h2"),m.pc(4),m.Kb(),m.Kb(),m.Lb(5,"ion-text"),m.pc(6),m.Kb(),m.Kb(),m.Lb(7,"ion-col"),m.oc(8,Ye,2,0,"ion-button",46),m.Kb(),m.Kb()),2&e){var n=m.Zb();m.xb(4),m.rc("",n.model.Route.Time," min"),m.xb(2),m.rc("",n.model.Route.Distance," m"),m.xb(2),m.ec("ngIf",!n.UseDrawerForNavigation())}}function Ze(e,t){if(1&e){var n=m.Mb();m.Lb(0,"ion-item",43),m.Xb("click",function(){m.jc(n);var e=t.$implicit;return m.Zb(2).navInstructionClick.emit(e)}),m.Lb(1,"ion-label"),m.pc(2),m.Kb(),m.Lb(3,"ion-text"),m.pc(4),m.Kb(),m.Kb()}if(2&e){var r=t.$implicit;m.xb(2),m.qc(r.Text),m.xb(2),m.rc("",r.Distance,"m")}}function Ue(e,t){if(1&e&&(m.Lb(0,"ion-list"),m.oc(1,Ze,5,2,"ion-item",12),m.Kb()),2&e){var n=m.Zb();m.xb(1),m.ec("ngForOf",n.model.Route.NavigationInstructions)}}var He,We=function(e){return e[e.SearchView=0]="SearchView",e[e.LocationView=1]="LocationView",e[e.RouteView=2]="RouteView",e[e.InNavigationView=3]="InNavigationView",e[e.ChangeRouteView=4]="ChangeRouteView",e}({}),$e=((He=function(){function e(t,n){l(this,e),this.model=t,this.platform=n,this.state=We.SearchView,this.stateChange=new m.o,this.campusClick=new m.o,this.detailsClick=new m.o,this.navInstructionClick=new m.o,this.search=new m.o,this.newRoute=new m.o}return d(e,[{key:"ngAfterViewInit",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.locationDrawer.SetState(q.a.Hidden),this.routeDrawer.SetState(q.a.Hidden),this.inNavigationDrawer.SetState(q.a.Hidden),this.changeRouteDrawer.SetState(q.a.Hidden,!1),this.searchDrawer.SetState(q.a.Hidden)]);case 2:case"end":return e.stop()}},e,this)}))}},{key:"SetState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=this.state,n.next=n.t0===We.SearchView?3:n.t0===We.LocationView?6:n.t0===We.RouteView?9:n.t0===We.InNavigationView?12:n.t0===We.ChangeRouteView?15:17;break;case 3:return n.next=5,this.searchDrawer.SetState(q.a.Hidden);case 5:return n.abrupt("break",17);case 6:return n.next=8,this.locationDrawer.SetState(q.a.Hidden);case 8:return n.abrupt("break",17);case 9:return n.next=11,this.routeDrawer.SetState(q.a.Hidden);case 11:return n.abrupt("break",17);case 12:return n.next=14,this.inNavigationDrawer.SetState(q.a.Hidden);case 14:return n.abrupt("break",17);case 15:return n.next=17,this.changeRouteDrawer.SetState(q.a.Hidden,!1);case 17:n.t1=(this.state=e,this.state),n.next=n.t1===We.SearchView?20:n.t1===We.LocationView?23:n.t1===We.RouteView?26:n.t1===We.InNavigationView?29:n.t1===We.ChangeRouteView?32:34;break;case 20:return n.next=22,this.searchDrawer.SetState(Z.a.GetRecommendedDrawerStateForDevice());case 22:return n.abrupt("break",34);case 23:return n.next=25,this.locationDrawer.SetState(Z.a.GetRecommendedDrawerStateForDevice());case 25:return n.abrupt("break",34);case 26:return n.next=28,this.routeDrawer.SetState(Z.a.GetRecommendedDrawerStateForDevice());case 28:return n.abrupt("break",34);case 29:return n.next=31,this.inNavigationDrawer.SetState(Z.a.GetRecommendedDrawerStateForDevice());case 31:return n.abrupt("break",34);case 32:return n.next=34,this.changeRouteDrawer.SetState(Z.a.GetRecommendedDrawerStateForDevice());case 34:t&&this.stateChange.emit(this.state);case 35:case"end":return n.stop()}},n,this)}))}},{key:"onRouteClick",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.stateChange.emit(We.RouteView);case 1:case"end":return e.stop()}},e,this)}))}},{key:"onLaunchNavigationClick",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.stateChange.emit(We.InNavigationView);case 1:case"end":return e.stop()}},e,this)}))}},{key:"onEndNavigationClick",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.stateChange.emit(We.LocationView);case 1:case"end":return e.stop()}},e,this)}))}},{key:"onSearchFocus",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.platform.is("hybrid"),!e.t0){e.next=4;break}return e.next=4,this.searchDrawer.SetState(q.a.Top);case 4:case"end":return e.stop()}},e,this)}))}},{key:"emitRoute",value:function(e){}},{key:"onCloseLocationDrawer",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.stateChange.emit(We.SearchView);case 1:case"end":return e.stop()}},e,this)}))}},{key:"onCloseRouteDrawer",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.stateChange.emit(We.LocationView);case 1:case"end":return e.stop()}},e,this)}))}},{key:"onChangeRouteStartEndClick",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.routeInput.UpdateFromNavigationModel(),e.next=3,this.SetState(We.ChangeRouteView,!0);case 3:return e.next=5,this.routeInput.SetFocus();case 5:case"end":return e.stop()}},e,this)}))}},{key:"onSearchDrawerStateChange",value:function(e){void 0!==this.drawerContent&&(this.drawerContent.scrollY=e===q.a.Top)}},{key:"onChangeRouteDrawerStateChange",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(e),t.t0=e===q.a.Hidden,!t.t0){t.next=5;break}return t.next=5,this.SetState(We.RouteView,!0);case 5:case"end":return t.stop()}},t,this)}))}},{key:"onCancelChangeRoute",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.SetState(We.RouteView,!1);case 2:case"end":return e.stop()}},e,this)}))}},{key:"UseDrawerForNavigation",value:function(){return!(Z.a.GetRecommendedDrawerStateForDevice()===q.a.Bottom)}}]),e}()).\u0275fac=function(e){return new(e||He)(m.Ib(E),m.Ib(u.ab))},He.\u0275cmp=m.Cb({type:He,selectors:[["app-nav-drawer-manager"]],viewQuery:function(e,t){var n;1&e&&(m.tc(_e,!0),m.tc(De,!0),m.tc(Fe,!0),m.tc(Te,!0),m.tc(Ee,!0),m.tc(Be,!0),m.tc(Ae,!0)),2&e&&(m.gc(n=m.Yb())&&(t.drawerContent=n.first),m.gc(n=m.Yb())&&(t.searchDrawer=n.first),m.gc(n=m.Yb())&&(t.locationDrawer=n.first),m.gc(n=m.Yb())&&(t.routeDrawer=n.first),m.gc(n=m.Yb())&&(t.inNavigationDrawer=n.first),m.gc(n=m.Yb())&&(t.changeRouteDrawer=n.first),m.gc(n=m.Yb())&&(t.routeInput=n.first))},inputs:{state:"state"},outputs:{stateChange:"stateChange",campusClick:"campusClick",detailsClick:"detailsClick",navInstructionClick:"navInstructionClick",search:"search",newRoute:"newRoute"},decls:124,vars:16,consts:[["id","searchDrawer",3,"stateChange"],["searchDrawer",""],[1,"nav-bottom-drawer"],[1,"drawer-grip"],[1,"ion-padding-top"],[1,"nav-hbar"],[3,"discovery","route","searchBarFocus"],["searchInput",""],[1,"ion-item-style"],["drawerContent",""],["class","ion-no-padding",4,"ngIf"],[1,"ion-no-padding"],["button","",3,"click",4,"ngFor","ngForOf"],[1,"ion-padding-vertical"],["id","locationDrawer","state","DrawerState.Hidden"],["locationDrawer",""],[1,"ion-padding-bottom"],["id","locationdrawerContent"],[1,"ion-justify-content-between","ion-align-self-center"],[1,"ion-justify-content-end","ion-padding-horizontal"],["shape","round","color","medium",1,"square-sm","ion-no-padding","ion-float-right",3,"click"],["slot","icon-only","name","close-outline","size","small"],["color","primary","expand","block",3,"click"],["id","routeBtn","color","primary","expand","block",3,"click"],[4,"ngFor","ngForOf"],[1,"ion-padding-horizontal"],["class","ion-no-margin ion-padding-end ion-img",3,"src","alt",4,"ngFor","ngForOf"],["id","routeDrawer","state","DrawerState.Hidden"],["routeDrawer",""],["type","indeterminate",4,"ngIf"],[1,"ion-no-margin"],[1,"span-button",3,"click"],[4,"ngIf"],["id","inNavigationDrawer","state","DrawerState.Hidden",3,"shouldDockTop"],["inNavigationDrawer",""],[1,"ion-no-padding","ion-item-style"],["color","danger","expand","block",3,"click"],["id","changeRouteDrawer","state","DrawerState.Hidden",3,"shouldDockBottom","shouldDockMiddle","stateChange"],["changeRouteDrawer",""],[1,"ion-align-items-baseline"],[1,"ion-text-center"],["size","6",1,"ion-text-center"],["routeInput",""],["button","",3,"click"],[1,"ion-no-margin","ion-padding-end","ion-img",3,"src","alt"],["type","indeterminate"],["color","success","expand","block",3,"click",4,"ngIf"],["color","success","expand","block",3,"click"]],template:function(e,t){if(1&e){var n=m.Mb();m.Lb(0,"app-ionic-bottom-drawer",0,1),m.Xb("stateChange",function(e){return t.onSearchDrawerStateChange(e)}),m.Lb(2,"div",2),m.Lb(3,"div",3),m.Jb(4,"div",4),m.Jb(5,"div",5),m.Lb(6,"app-search-input",6,7),m.Xb("discovery",function(e){return t.search.emit(e)})("route",function(e){return t.emitRoute(e)})("searchBarFocus",function(e){return t.onSearchFocus(e)}),m.Kb(),m.Kb(),m.Lb(8,"ion-content",8,9),m.oc(10,Ve,5,1,"ion-list",10),m.Lb(11,"ion-list",11),m.Lb(12,"ion-list-header"),m.Lb(13,"h2"),m.pc(14,"Choose a Campus"),m.Kb(),m.Kb(),m.oc(15,ze,6,3,"ion-item",12),m.Kb(),m.Jb(16,"div",13),m.Jb(17,"div",13),m.Jb(18,"div",13),m.Jb(19,"div",13),m.Jb(20,"div",13),m.Jb(21,"div",13),m.Kb(),m.Kb(),m.Kb(),m.Lb(22,"app-ionic-bottom-drawer",14,15),m.Lb(24,"div",2),m.Lb(25,"div",3),m.Jb(26,"div",4),m.Jb(27,"div",5),m.Jb(28,"div",16),m.Kb(),m.Lb(29,"ion-content",8),m.Lb(30,"ion-grid",17),m.Lb(31,"ion-row",18),m.Lb(32,"ion-col"),m.Lb(33,"ion-label"),m.Lb(34,"h1"),m.pc(35),m.Kb(),m.Kb(),m.Lb(36,"ion-text"),m.pc(37),m.Kb(),m.Kb(),m.Lb(38,"ion-col",19),m.Lb(39,"ion-button",20),m.Xb("click",function(){return t.onCloseLocationDrawer()}),m.Jb(40,"ion-icon",21),m.Kb(),m.Kb(),m.Kb(),m.Lb(41,"ion-row"),m.Lb(42,"ion-col"),m.Lb(43,"ion-button",22),m.Xb("click",function(){return t.detailsClick.emit()}),m.pc(44," Details "),m.Kb(),m.Kb(),m.Lb(45,"ion-col"),m.Lb(46,"ion-button",23),m.Xb("click",function(){return t.onRouteClick()}),m.pc(47," Route "),m.Kb(),m.Kb(),m.Kb(),m.oc(48,Xe,5,2,"ion-row",24),m.Kb(),m.Lb(49,"div",25),m.Lb(50,"app-ionic-horizontal-scrollable"),m.oc(51,Ge,1,2,"img",26),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Lb(52,"app-ionic-bottom-drawer",27,28),m.Lb(54,"div",2),m.Lb(55,"div",3),m.Jb(56,"div",4),m.Jb(57,"div",5),m.Jb(58,"div",16),m.oc(59,Je,1,0,"ion-progress-bar",29),m.Lb(60,"ion-item",30),m.Lb(61,"ion-grid"),m.Lb(62,"ion-row",18),m.Lb(63,"ion-col"),m.Lb(64,"ion-label"),m.Lb(65,"h1"),m.pc(66),m.Kb(),m.Kb(),m.Lb(67,"ion-text"),m.pc(68,"From "),m.Lb(69,"span",31),m.Xb("click",function(){return t.onChangeRouteStartEndClick()}),m.pc(70),m.Kb(),m.Kb(),m.Kb(),m.Lb(71,"ion-col",19),m.Lb(72,"ion-button",20),m.Xb("click",function(){return t.onCloseRouteDrawer()}),m.Jb(73,"ion-icon",21),m.Kb(),m.Kb(),m.Kb(),m.oc(74,qe,9,3,"ion-row",32),m.Kb(),m.Kb(),m.Kb(),m.Lb(75,"ion-content",8),m.oc(76,Ue,2,1,"ion-list",32),m.Jb(77,"div",13),m.Jb(78,"div",13),m.Jb(79,"div",13),m.Jb(80,"div",13),m.Jb(81,"div",13),m.Jb(82,"div",13),m.Jb(83,"div",13),m.Jb(84,"div",13),m.Kb(),m.Kb(),m.Kb(),m.Lb(85,"app-ionic-bottom-drawer",33,34),m.Lb(87,"div",2),m.Lb(88,"div",3),m.Jb(89,"div",4),m.Jb(90,"div",5),m.Jb(91,"div",16),m.Lb(92,"ion-item",35),m.Lb(93,"ion-grid"),m.Lb(94,"ion-row"),m.Lb(95,"ion-col"),m.Lb(96,"ion-label"),m.Lb(97,"h2"),m.pc(98),m.Kb(),m.Kb(),m.Lb(99,"ion-text"),m.pc(100),m.Kb(),m.Kb(),m.Lb(101,"ion-col"),m.Lb(102,"ion-button",36),m.Xb("click",function(){return t.onEndNavigationClick()}),m.pc(103," End Route "),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Lb(104,"app-ionic-bottom-drawer",37,38),m.Xb("stateChange",function(e){return t.onChangeRouteDrawerStateChange(e)}),m.Lb(106,"div",2),m.Lb(107,"div",3),m.Jb(108,"div",4),m.Jb(109,"div",5),m.Lb(110,"ion-item",35),m.Lb(111,"ion-grid"),m.Lb(112,"ion-row",39),m.Lb(113,"ion-col",40),m.Lb(114,"span",31),m.Xb("click",function(){return t.onCancelChangeRoute()}),m.pc(115,"Cancel"),m.Kb(),m.Kb(),m.Lb(116,"ion-col",41),m.Lb(117,"h3"),m.pc(118,"Change Route"),m.Kb(),m.Kb(),m.Lb(119,"ion-col",40),m.Lb(120,"span",31),m.Xb("click",function(){m.jc(n);var e=m.hc(123);return t.newRoute.emit([e.From,e.To])}),m.pc(121,"Route"),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Kb(),m.Jb(122,"app-route-input",null,42),m.Kb(),m.Kb()}2&e&&(m.xb(10),m.ec("ngIf",t.model.recentSearches.length>0),m.xb(5),m.ec("ngForOf",t.model.availableCampus),m.xb(20),m.qc(t.model.latestSearchResult.Name),m.xb(2),m.qc(t.model.latestSearchResult.Description),m.xb(11),m.ec("ngForOf",t.model.latestSearchResult.Information),m.xb(3),m.ec("ngForOf",t.model.latestSearchResult.Images),m.xb(8),m.ec("ngIf",0===t.model.Route.Distance),m.xb(7),m.rc("To ",t.model.Route.Destination.Name,""),m.xb(4),m.qc(t.model.Route.Start.Name),m.xb(4),m.ec("ngIf",0!==t.model.Route.Distance),m.xb(2),m.ec("ngIf",0!==t.model.Route.Distance),m.xb(9),m.ec("shouldDockTop",!1),m.xb(13),m.rc("",t.model.Route.Time," min"),m.xb(2),m.rc("",t.model.Route.Distance," m"),m.xb(4),m.ec("shouldDockBottom",!1)("shouldDockMiddle",!1))},directives:[Z.a,Y,u.p,f.j,u.y,u.z,f.i,u.r,u.I,u.o,u.x,u.R,u.h,u.t,Ke,u.v,Pe,u.B],styles:[".vertical-line[_ngcontent-%COMP%]{border-left:2px solid #9d9fa6;height:38px}.span-button[_ngcontent-%COMP%]{color:var(--ion-color-primary,#3880ff)}.span-button[_ngcontent-%COMP%]:hover{cursor:pointer}.nav-hbar[_ngcontent-%COMP%]{border-top:2px solid var(--ion-color-medium,#9d9fa6);border-bottom:2px solid var(--ion-color-medium,#9d9fa6);border-radius:2px;height:0;width:auto;margin:0 45%}.nav-bottom-drawer[_ngcontent-%COMP%]{background-color:var(--ion-item-background,#fff);border-top-left-radius:20px;border-top-right-radius:20px;box-shadow:0 4px 8px 0 rgba(0,0,0,.4),0 6px 20px 0 rgba(0,0,0,.29);height:inherit}.square-md[_ngcontent-%COMP%]{height:64px;width:64px}.square-sm[_ngcontent-%COMP%]{height:32px;width:32px}.square-xs[_ngcontent-%COMP%]{height:16px;width:16px}#locationdrawerContent[_ngcontent-%COMP%]{margin-left:30px;margin-right:30px;position:center}#locationdrawerName[_ngcontent-%COMP%]{font-weight:700}#inNavigationDrawer[_ngcontent-%COMP%]{z-index:1}#locationDrawer[_ngcontent-%COMP%]{z-index:2}#routeDrawer[_ngcontent-%COMP%]{z-index:3}#searchDrawer[_ngcontent-%COMP%]{z-index:4}.ion-img[_ngcontent-%COMP%]{height:200px}"]}),He),Qe=["searchInput"],et=["navSlides"],tt=["drawerManager"];function nt(e,t){1&e&&m.Jb(0,"ion-progress-bar",9)}function rt(e,t){if(1&e&&(m.Lb(0,"ion-text",10),m.Lb(1,"h5"),m.Lb(2,"span",11),m.pc(3),m.Kb(),m.Kb(),m.Lb(4,"p"),m.Pb(5,12),m.Kb(),m.Lb(6,"p"),m.Sb(7,13),m.Jb(8,"br"),m.Jb(9,"a",14),m.Qb(),m.Kb(),m.Kb()),2&e){var n=m.Zb();m.xb(3),m.qc(n.errorMessage)}}var it=W.a.Keyboard,ot=fe.icon({iconRetinaUrl:"leaflet/marker-icon-2x.png",iconUrl:"leaflet/marker-icon.png",shadowUrl:"leaflet/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});fe.Marker.prototype.options.icon=ot;var at,st,ct,ut=((ct=function(){function e(t,n,r,i,o,a,s,c,u){l(this,e),this.dataService=t,this.route=n,this.router=r,this.model=i,this.storage=o,this.geolocation=a,this.openStreetMapService=s,this.lastOpenStreetMapCenterPersistence=c,this.platform=u,this.searchMarker=[],this.routes=[],this.progressIsVisible=!1,this.currentPositionMarker=null,this.isInitialized=!1,this.isSubscribed=!1,this.DEFAULT_ZOOM=17,this.MAX_ZOOM=18,this.MIN_ZOOM=14,this.isHybridPlatform=this.platform.is("hybrid")}return d(e,[{key:"ngOnInit",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.model.availableCampus&&0!==this.model.availableCampus.length){e.next=6;break}return e.next=3,this.dataService.get_campus_search().toPromise();case 3:t=e.sent,n=a(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this.model.availableCampus.push(new U(i))}catch(o){n.e(o)}finally{n.f()}case 6:case"end":return e.stop()}},e,this)}))}},{key:"ionViewDidEnter",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.isInitialized,e.t0){e.next=5;break}return e.next=4,this.initializeMap(this.router);case 4:this.isInitialized=!0;case 5:return e.prev=5,e.next=8,this.geolocation.getCurrentPosition();case 8:t=e.sent,null===this.currentPositionMarker?this.currentPositionMarker=fe.marker([t.coords.latitude,t.coords.longitude]).addTo(this.map).bindPopup("Position"):this.currentPositionMarker.setLatLng([t.coords.latitude,t.coords.longitude]),e.next=15;break;case 12:e.prev=12,e.t1=e.catch(5),console.log("Error getting location",e.t1);case 15:!1===this.isSubscribed&&(this.isSubscribed=!0,this.route.queryParams.subscribe(function(e){return Object(p.a)(n,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null!=e,!t.t0){t.next=20;break}if(null==e.location){t.next=8;break}return t.next=5,this.execSearch(e.location);case 5:this.clearRoutes(),t.next=20;break;case 8:if(null==e.destination){t.next=16;break}return this.drawerManager.SetState(We.RouteView),t.next=12,this.execDirectSearch(e.destination);case 12:return t.next=14,this.routeToLatestSearchResult();case 14:t.next=20;break;case 16:return t.next=18,this.drawerManager.SetState(We.SearchView);case 18:this.clearSearchMarkers(),this.clearRoutes();case 20:case"end":return t.stop()}},t,this)}))}));case 16:case"end":return e.stop()}},e,this,[[5,12]])}))}},{key:"initializeMap",value:function(t){var n;return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){var i,o,s,c,u,l,h,d,f,v=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l=function(e){t.navigate(["tabs/navigation"],{queryParams:{location:e.target.options.className}}).then(function(){return console.log(e.latlng,e.target.options.className)})},r.next=3,this.openStreetMapService.GetBounds();case 3:return i=r.sent,o=fe.latLng(i.SouthWest.Lat,i.SouthWest.Lng),s=fe.latLng(i.NorthEast.Lat,i.NorthEast.Lng),c=fe.latLngBounds(o,s),console.log(i,c),this.map=fe.map("leafletMap",{maxBounds:c,maxZoom:this.MAX_ZOOM,minZoom:this.MIN_ZOOM,zoomControl:!this.platform.is("hybrid")}),this.map.on("moveend",function(e){ke.persist(v.storage,{center:e.target.getCenter(),zoom:e.target.getZoom()})}),r.next=12,this.lastOpenStreetMapCenterPersistence.load(this.storage,this.map,this.DEFAULT_ZOOM);case 12:if(fe.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"edupala.com \xa9 Angular LeafLet"}).addTo(this.map),r.t0=this.platform.is("hybrid"),!r.t0){r.next=18;break}return r.next=17,this.delay(500);case 17:this.map.invalidateSize();case 18:return r.next=20,this.dataService.get_buildings_search().toPromise();case 20:if(null!==(u=r.sent)){h=a(u);try{for(h.s();!(d=h.n()).done;)null!==(f=d.value).edges.Body&&f.edges.Body.length>0&&fe.polygon(e.convertToLeafLetCoordinates(f.edges.Body),{className:f.Name,color:null!==(n=f.Color)&&void 0!==n?n:"#0083C6"}).addTo(this.map).on("click",l)}catch(p){h.e(p)}finally{h.f()}}case 22:case"end":return r.stop()}},r,this)}))}},{key:"ngOnDestroy",value:function(){this.map.remove()}},{key:"onSearch",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.router.navigate(["/tabs/navigation"],{queryParams:{location:e}});case 2:case"end":return t.stop()}},t,this)}))}},{key:"execSearch",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,o,s,c,u,l,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.model.errorMessage="",this.progressIsVisible=!0,t.prev=1,this.clearSearchMarkers(),t.next=5,this.execDirectSearch(e);case 5:if(!t.sent){t.next=11;break}return this.searchMarker.push(this.showMarker(this.model.latestSearchResult.LatLng.lat,this.model.latestSearchResult.LatLng.lng,this.model.latestSearchResult.Name,!0)),this.map.flyTo(this.model.latestSearchResult.LatLng,this.DEFAULT_ZOOM),t.next=10,this.showElementDrawer();case 10:return t.abrupt("return",void t.sent);case 11:return t.next=13,this.dataService.get_buildings_search(e).toPromise();case 13:if(!((n=t.sent)&&n.length>0)){t.next=19;break}r=a(n);try{for(r.s();!(i=r.n()).done;)o=i.value,s=this.getCenterCoordinateFromBody(o.edges.Body),this.searchMarker.push(this.showMarker(s.Latitude,s.Longitude,o.Name,!1))}catch(d){r.e(d)}finally{r.f()}t.next=23;break;case 19:return t.next=21,this.dataService.get_campus_search(e).toPromise();case 21:if((c=t.sent)&&c.length>0){u=a(c);try{for(u.s();!(l=u.n()).done;)h=l.value,this.searchMarker.push(this.showMarker(h.Latitude,h.Longitude,h.Name,!1))}catch(d){u.e(d)}finally{u.f()}}case 23:t.next=28;break;case 25:t.prev=25,t.t0=t.catch(1),this.handleInputError(t.t0,e);case 28:return t.prev=28,this.progressIsVisible=!1,t.finish(28);case 31:case"end":return t.stop()}},t,this,[[1,25,28,31]])}))}},{key:"execDirectSearch",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,o,a,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.dataService.get_location(e).toPromise();case 3:if(!(n=t.sent)){t.next=12;break}return t.next=7,this.dataService.get_building(n.Building).toPromise();case 7:return r=t.sent,i=this.getCenterCoordinateFromBody(r.edges.Body),t.next=11,this.model.addRecentSearchLocation(n,{lat:i.Latitude,lng:i.Longitude},r);case 11:return t.abrupt("return",!0);case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.log(t.t0);case 17:return t.prev=17,t.next=20,this.dataService.get_building(e,!1).toPromise();case 20:if(!(o=t.sent)){t.next=26;break}return a=this.getCenterCoordinateFromBody(o.edges.Body),t.next=25,this.model.addRecentSearchBuilding(o,{lat:a.Latitude,lng:a.Longitude});case 25:return t.abrupt("return",!0);case 26:t.next=31;break;case 28:t.prev=28,t.t1=t.catch(17),console.log(t.t1);case 31:return t.prev=31,t.next=34,this.dataService.get_campus(e,!1).toPromise();case 34:if(!(s=t.sent)){t.next=39;break}return t.next=38,this.model.addRecentSearchCampus(s);case 38:return t.abrupt("return",!0);case 39:t.next=44;break;case 41:t.prev=41,t.t2=t.catch(31),console.log(t.t2);case 44:return t.abrupt("return",!1);case 45:case"end":return t.stop()}},t,this,[[0,14],[17,28],[31,41]])}))}},{key:"onRoute",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e),this.clearRoutes(),t.next=4,this.drawerManager.SetState(We.RouteView,!1);case 4:return t.next=6,this.openStreetMapService.GetRoute(e[0].LatLng,e[1].LatLng);case 6:return n=t.sent,this.model.SetOsmRouteAsRoute(n[0],e[0],e[1]),r=fe.polyline(this.model.Route.Coordinates,{color:"red"}).addTo(this.map),this.map.flyTo(r.getCenter(),this.DEFAULT_ZOOM),t.next=12,this.map.fitBounds(r.getBounds());case 12:this.routes.push(r);case 13:case"end":return t.stop()}},t,this)}))}},{key:"showElementDrawer",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.isHybridPlatform,!e.t0){e.next=4;break}return e.next=4,it.hide();case 4:return e.next=6,this.drawerManager.SetState(We.LocationView);case 6:case"end":return e.stop()}},e,this)}))}},{key:"onCampusClick",value:function(e){this.map.flyTo(e.LatLng,this.DEFAULT_ZOOM)}},{key:"onDrawerManagerStateChange",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=(console.log(e),e),t.next=t.t0===We.SearchView?3:t.t0===We.LocationView?6:t.t0===We.RouteView?9:t.t0===We.InNavigationView?12:14;break;case 3:return t.next=5,this.router.navigate(["/tabs/navigation"]);case 5:return t.abrupt("break",14);case 6:return t.next=8,this.router.navigate(["/tabs/navigation"],{queryParams:{location:this.model.latestSearchResult.Name}});case 8:return t.abrupt("break",14);case 9:return t.next=11,this.router.navigate(["/tabs/navigation"],{queryParams:{destination:this.model.latestSearchResult.Name}});case 11:return t.abrupt("break",14);case 12:return t.next=14,this.onLaunchNavigation();case 14:case"end":return t.stop()}},t,this)}))}},{key:"onDetailsClick",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.router.navigate(["tabs/navigation/detail"],{queryParams:0===this.routes.length?this.model.latestSearchResult.DetailRouterParams:this.model.latestSearchResult.RouteRouterParams});case 2:case"end":return e.stop()}},e,this)}))}},{key:"routeToLatestSearchResult",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.geolocation.getCurrentPosition();case 2:return n=t.sent,r={lat:n.coords.latitude,lng:n.coords.longitude},t.next=6,this.openStreetMapService.GetRoute(r,this.model.latestSearchResult.LatLng);case 6:return i=t.sent,this.model.SetOsmRouteAsRoute(i[0],{Name:e.MyLocation,LatLng:r},this.model.latestSearchResult),o=fe.polyline(this.model.Route.Coordinates,{color:"red"}).addTo(this.map),this.map.flyTo(o.getCenter(),this.DEFAULT_ZOOM),t.next=12,this.map.fitBounds(o.getBounds());case 12:this.routes.push(o);case 13:case"end":return t.stop()}},t,this)}))}},{key:"onLaunchNavigation",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.navSlides.instructions=this.model.Route.NavigationInstructions,e.next=3,this.navSlides.show();case 3:return this.map.flyTo(this.model.Route.Coordinates[this.model.Route.NavigationInstructions[0].Interval[0]],this.MAX_ZOOM),e.next=6,this.drawerManager.SetState(We.InNavigationView);case 6:case"end":return e.stop()}},e,this)}))}},{key:"onSlideChange",value:function(e){this.onNavigationInstructionClick(this.model.Route.NavigationInstructions[e])}},{key:"onNavigationInstructionClick",value:function(e){this.map.flyTo(this.model.Route.Coordinates[e.Interval[0]],this.MAX_ZOOM)}},{key:"handleInputError",value:function(e,t){if(e instanceof D.d){var n=e;this.errorMessage=400===n.status?"Studi-Guide can't find "+t:n.message}else this.errorMessage=e.message}},{key:"showMarker",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3?arguments[3]:void 0,i=fe.marker([e,t]).addTo(this.map);return n?r?i.bindPopup(n).openPopup():i.bindPopup(n):i}},{key:"getCenterCoordinateFromBody",value:function(e){var t,n=[],r=a(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push([i.Latitude,i.Longitude])}}catch(c){r.e(c)}finally{r.f()}var o=new fe.Polygon(n).addTo(this.map),s={Longitude:o.getCenter().lng,Latitude:o.getCenter().lat};return o.remove(),s}},{key:"clearSearchMarkers",value:function(){var e,t=a(this.searchMarker);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.map.removeLayer(n)}}catch(r){t.e(r)}finally{t.f()}}},{key:"clearRoutes",value:function(){var e,t=a(this.routes);try{for(t.s();!(e=t.n()).done;)e.value.remove()}catch(n){t.e(n)}finally{t.f()}this.routes=[],this.model.ClearRoute(),this.navSlides.hide()}},{key:"delay",value:function(e){return new Promise(function(t){return setTimeout(t,e)})}}],[{key:"convertToLeafLetCoordinates",value:function(e){var t,n=[],r=a(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push({lat:i.Latitude,lng:i.Longitude})}}catch(o){r.e(o)}finally{r.f()}return n}}]),e}()).MyLocation="My Location",ct.\u0275fac=function(e){return new(e||ct)(m.Ib(b.a),m.Ib(h.a),m.Ib(h.g),m.Ib(E),m.Ib(F.b),m.Ib(ve.a),m.Ib(be),m.Ib(ke),m.Ib(u.ab))},ct.\u0275cmp=m.Cb({type:ct,selectors:[["app-map-page"]],viewQuery:function(e,t){var n;1&e&&(m.tc(Qe,!0),m.tc(et,!0),m.tc(tt,!0)),2&e&&(m.gc(n=m.Yb())&&(t.searchInput=n.first),m.gc(n=m.Yb())&&(t.navSlides=n.first),m.gc(n=m.Yb())&&(t.drawerManager=n.first))},decls:9,vars:2,consts:function(){return[[3,"campusClick","navInstructionClick","search","detailsClick","stateChange","newRoute"],["drawerManager",""],[3,"nextSlide","previousSlide"],["navSlides",""],["data-tap-disabled","true","scroll-y","false"],["type","indeterminate","color","secondary",4,"ngIf"],["id","map-content"],["id","error-message",4,"ngIf"],["id","leafletMap"],["type","indeterminate","color","secondary"],["id","error-message"],[1,"error"],"Make sure your search is spelled correctly.","Should this place be on Studi-Guide? " + "\ufffd#8\ufffd\ufffd/#8\ufffd" + "" + "\ufffd#9\ufffd" + "Request a missing place" + "\ufffd/#9\ufffd" + "",["href","https://github.com/Studi-Guide/Studi-Guide/issues/new/choose"]]},template:function(e,t){1&e&&(m.Lb(0,"app-nav-drawer-manager",0,1),m.Xb("campusClick",function(e){return t.onCampusClick(e)})("navInstructionClick",function(e){return t.onNavigationInstructionClick(e)})("search",function(e){return t.onSearch(e)})("detailsClick",function(){return t.onDetailsClick()})("stateChange",function(e){return t.onDrawerManagerStateChange(e)})("newRoute",function(e){return t.onRoute(e)}),m.Kb(),m.Lb(2,"app-navigation-instruction-slides",2,3),m.Xb("nextSlide",function(e){return t.onSlideChange(e)})("previousSlide",function(e){return t.onSlideChange(e)}),m.Kb(),m.Lb(4,"ion-content",4),m.oc(5,nt,1,0,"ion-progress-bar",5),m.Lb(6,"div",6),m.oc(7,rt,10,1,"ion-text",7),m.Jb(8,"div",8),m.Kb(),m.Kb()),2&e&&(m.xb(5),m.ec("ngIf",t.progressIsVisible),m.xb(2),m.ec("ngIf",t.errorMessage))},directives:[$e,xe,u.p,f.j,u.B,u.R],styles:["#map-content[_ngcontent-%COMP%]{height:100%;width:100%;position:fixed}.error[_ngcontent-%COMP%]{color:red}#error-message[_ngcontent-%COMP%]{margin-left:20px}#leafletMap[_ngcontent-%COMP%]{height:100%;width:100%;z-index:0}#leafletMap[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}#available-floors-btn[_ngcontent-%COMP%]{position:fixed;bottom:0;display:block;z-index:10}.draggable[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.center[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;display:block}ion-progress-bar[_ngcontent-%COMP%]{position:absolute;z-index:9999}"]}),ct),lt=((st=function e(){l(this,e)}).\u0275mod=m.Gb({type:st}),st.\u0275inj=m.Fb({factory:function(e){return new(e||st)},imports:[[f.b]]}),st),ht=((at=function e(){l(this,e)}).\u0275mod=m.Gb({type:at}),at.\u0275inj=m.Fb({factory:function(e){return new(e||at)},imports:[[u.V,f.b,v.a,h.i.forChild([{path:"detail",component:he},{path:"",component:ut}]),de,lt]]}),at);m.mc(he,[u.s,u.U,u.i,u.f,u.g,u.p,f.j,u.B,u.R,_,Z.a,Y,u.y,u.z,f.i,u.v,u.r,u.I,u.o,u.x,u.h,u.t,Ke],[])},wyfB:function(e,t){function n(e){return e&&e.ownerSVGElement&&e.getCTM}e.exports=function(e,t){if(!n(e))throw new Error("svg element is required for svg.panzoom to work");var r=e.ownerSVGElement;if(!r)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");return t.disableKeyboardInteraction||r.setAttribute("tabindex",0),{getBBox:function(){var t=e.getBBox();return{left:t.x,top:t.y,width:t.width,height:t.height}},getScreenCTM:function(){return r.getCTM()||r.getScreenCTM()},getOwner:function(){return r},applyTransform:function(t){e.setAttribute("transform","matrix("+t.scale+" 0 0 "+t.scale+" "+t.x+" "+t.y+")")},initTransform:function(t){var n=e.getCTM();null===n&&(n=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),t.x=n.e,t.y=n.f,t.scale=n.a,r.removeAttributeNS(null,"viewBox")}}},e.exports.canAttach=n}}])}();