!function(){function e(){var t=i([":search error|missing place request\u241fc583358f0f963680c102622c2f41dea5db729fb5\u241f8414130712017189041:Should this place be on Studi-Guide? ",":LINE_BREAK:",":START_LINK:Request a missing place",":CLOSE_LINK:"]);return e=function(){return t},t}function t(){var e=i([":search error|spelling check\u241f3149bc3f0a5c01aac3807ac5700243e6877464b2\u241f8075391416841215266:Make sure your search is spelled correctly."]);return t=function(){return e},e}function n(){var e=i([":search error|missing place request\u241fc583358f0f963680c102622c2f41dea5db729fb5\u241f8414130712017189041:Should this place be on Studi-Guide? ",":LINE_BREAK:",":START_LINK:Request a missing place",":CLOSE_LINK:"]);return n=function(){return e},e}function r(){var e=i([":search error|spelling check\u241f3149bc3f0a5c01aac3807ac5700243e6877464b2\u241f8075391416841215266:Make sure your search is spelled correctly."]);return r=function(){return e},e}function i(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function o(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"0Tit":function(e,t){var n="function"==typeof Float32Array;function r(e,t){return 1-3*t+3*e}function i(e,t){return 3*t-6*e}function o(e){return 3*e}function a(e,t,n){return((r(t,n)*e+i(t,n))*e+o(t))*e}function s(e,t,n){return 3*r(t,n)*e*e+2*i(t,n)*e+o(t)}function c(e){return e}e.exports=function(e,t,r,i){if(!(0<=e&&e<=1&&0<=r&&r<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&r===i)return c;for(var o=n?new Float32Array(11):new Array(11),u=0;u<11;++u)o[u]=a(.1*u,e,r);return function(n){return 0===n?0:1===n?1:a(function(t){for(var n=0,i=1;10!==i&&o[i]<=t;++i)n+=.1;--i;var c=n+(t-o[i])/(o[i+1]-o[i])*.1,u=s(c,e,r);return u>=.001?function(e,t,n,r){for(var i=0;i<4;++i){var o=s(t,n,r);if(0===o)return t;t-=(a(t,n,r)-e)/o}return t}(t,c,e,r):0===u?c:function(e,t,n,r,i){var o,s,c=0;do{(o=a(s=t+(n-t)/2,r,i)-e)>0?n=s:t=s}while(Math.abs(o)>1e-7&&++c<10);return s}(t,n,n+.1,e,r)}(n),t,i)}}},"6f8I":function(e,t){function n(){return"function"==typeof cancelAnimationFrame?cancelAnimationFrame:clearTimeout}function r(){return"function"==typeof requestAnimationFrame?requestAnimationFrame:function(e){return setTimeout(e,16)}}e.exports=function(e,t,i){"object"!=typeof i&&(i={});var o,a,s,c,u,l,d,h,f,b,m="number"==typeof i.minVelocity?i.minVelocity:5,v="number"==typeof i.amplitude?i.amplitude:.25,p="function"==typeof i.cancelAnimationFrame?i.cancelAnimationFrame:n(),g="function"==typeof i.requestAnimationFrame?i.requestAnimationFrame:r();return{start:function(){o=e(),l=f=c=d=0,a=new Date,p(s),p(b),s=g(y)},stop:function(){p(s),p(b);var t=e();u=t.x,h=t.y,a=Date.now(),(c<-m||c>m)&&(u+=l=v*c),(d<-m||d>m)&&(h+=f=v*d),b=g(w)},cancel:function(){p(s),p(b)}};function y(){var t=Date.now(),n=t-a;a=t;var r=e(),i=r.x-o.x,u=r.y-o.y;o=r;var l=1e3/(1+n);c=.8*i*l+.2*c,d=.8*u*l+.2*d,s=g(y)}function w(){var e=Date.now()-a,n=!1,r=0,i=0;l&&((r=-l*Math.exp(-e/342))>.5||r<-.5?n=!0:r=l=0),f&&((i=-f*Math.exp(-e/342))>.5||i<-.5?n=!0:i=f=0),n&&(t(u+r,h+i),b=g(w))}}},AMdQ:function(e,t){e.exports=function(e){!function(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],n=0;n<t.length;++n)if(e.hasOwnProperty(t[n]))throw new Error("Subject cannot be eventified, since it already has property '"+t[n]+"'")}(e);var t=function(e){var t=Object.create(null);return{on:function(n,r,i){if("function"!=typeof r)throw new Error("callback is expected to be a function");var o=t[n];return o||(o=t[n]=[]),o.push({callback:r,ctx:i}),e},off:function(n,r){if(void 0===n)return t=Object.create(null),e;if(t[n])if("function"!=typeof r)delete t[n];else for(var i=t[n],o=0;o<i.length;++o)i[o].callback===r&&i.splice(o,1);return e},fire:function(n){var r,i=t[n];if(!i)return e;arguments.length>1&&(r=Array.prototype.splice.call(arguments,1));for(var o=0;o<i.length;++o){var a=i[o];a.callback.apply(a.ctx,r)}return e}}}(e);return e.on=t.on,e.off=t.off,e.fire=t.fire,e}},AgEI:function(e,t){function n(e){return e.stopPropagation(),!1}function r(){}e.exports=function(e){if(e)return{capture:r,release:r};var t,i,o,a=!1;return{capture:function(e){a=!0,i=window.document.onselectstart,o=window.document.ondragstart,window.document.onselectstart=n,(t=e).ondragstart=n},release:function(){a&&(a=!1,window.document.onselectstart=i,t&&(t.ondragstart=o))}}}},QIvw:function(e,t){e.exports=function(){this.x=0,this.y=0,this.scale=1}},Vkd7:function(e,t){function n(e){return e&&e.parentElement&&e.style}e.exports=function(e,t){if(!n(e))throw new Error("panzoom requires DOM element to be attached to the DOM tree");var r=e.parentElement;return e.scrollTop=0,t.disableKeyboardInteraction||r.setAttribute("tabindex",0),{getBBox:function(){return{left:0,top:0,width:e.clientWidth,height:e.clientHeight}},getOwner:function(){return r},applyTransform:function(t){e.style.transformOrigin="0 0 0",e.style.transform="matrix("+t.scale+", 0, 0, "+t.scale+", "+t.x+", "+t.y+")"}}},e.exports.canAttach=n},cQc6:function(e,t){e.exports=function(e,t){for(var n=e[0],r=e[1],i=!1,o=0,a=t.length-1;o<t.length;a=o++){var s=t[o][0],c=t[o][1],u=t[a][1];c>r!=u>r&&n<(t[a][0]-s)*(r-c)/(u-c)+s&&(i=!i)}return i}},dwjH:function(e,t,n){var r=n("0Tit"),i={ease:r(.25,.1,.25,1),easeIn:r(.42,0,1,1),easeOut:r(0,0,.58,1),easeInOut:r(.42,0,.58,1),linear:r(0,0,1,1)};function o(){}function a(){var e=new Set,t=new Set,n=0;return{next:r,cancel:r,clearAll:function(){e.clear(),t.clear(),cancelAnimationFrame(n),n=0}};function r(e){t.add(e),n||(n=requestAnimationFrame(i))}function i(){n=0;var r=t;t=e,(e=r).forEach(function(e){e()}),e.clear()}}e.exports=function(e,t,n){var r=Object.create(null),a=Object.create(null),s="function"==typeof(n=n||{}).easing?n.easing:i[n.easing];s||(n.easing&&console.warn("Unknown easing function in amator: "+n.easing),s=i.ease);var c="function"==typeof n.step?n.step:o,u="function"==typeof n.done?n.done:o,l=function(e){if(!e)return"undefined"!=typeof window&&window.requestAnimationFrame?{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}:{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}};if("function"!=typeof e.next)throw new Error("Scheduler is supposed to have next(cb) function");if("function"!=typeof e.cancel)throw new Error("Scheduler is supposed to have cancel(handle) function");return e}(n.scheduler),d=Object.keys(t);d.forEach(function(n){r[n]=e[n],a[n]=t[n]-e[n]});var h,f=Math.max(1,.06*("number"==typeof n.duration?n.duration:400)),b=0;return h=l.next(function t(){var n=s(b/f);b+=1,function(t){d.forEach(function(n){e[n]=a[n]*t+r[n]})}(n),b<=f?(h=l.next(t),c(e)):(h=0,setTimeout(function(){u(e)},0))}),{cancel:function(){l.cancel(h),h=0}}},e.exports.makeAggregateRaf=a,e.exports.sharedScheduler=a()},fQX0:function(e,t,n){"use strict";var r=n("fWck"),i=n("dwjH"),o=n("AMdQ"),a=n("6f8I"),s=n("AgEI"),c=s(),u=s(!0),l=n("QIvw"),d=n("wyfB"),h=n("Vkd7");function f(e,t){var n=(t=t||{}).controller;if(n||(d.canAttach(e)?n=d(e,t):h.canAttach(e)&&(n=h(e,t))),!n)throw new Error("Cannot create panzoom for the current type of dom element");var s=n.getOwner(),f={x:0,y:0},m=!1,y=new l;n.initTransform&&n.initTransform(y);var w,x="function"==typeof t.filterKey?t.filterKey:v,S="number"==typeof t.pinchSpeed?t.pinchSpeed:1,k=t.bounds,R="number"==typeof t.maxZoom?t.maxZoom:Number.POSITIVE_INFINITY,C="number"==typeof t.minZoom?t.minZoom:0,I="number"==typeof t.boundsPadding?t.boundsPadding:.05,M="number"==typeof t.zoomDoubleClickSpeed?t.zoomDoubleClickSpeed:1.75,O=t.beforeWheel||v,P=t.beforeMouseDown||v,D="number"==typeof t.zoomSpeed?t.zoomSpeed:1,K=b(t.transformOrigin),J=t.enableTextSelection?u:c;!function(e){var t=typeof e;if("undefined"!==t&&"boolean"!==t&&!(p(e.left)&&p(e.top)&&p(e.bottom)&&p(e.right)))throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}(k),t.autocenter&&function(){var e,t,r=0,i=0,o=Q();if(o)r=o.left,i=o.top,e=o.right-o.left,t=o.bottom-o.top;else{var a=s.getBoundingClientRect();e=a.width,t=a.height}var c=n.getBBox();if(0!==c.width&&0!==c.height){var u=Math.min(e/c.width,t/c.height);y.x=-(c.left+c.width/2)*u+e/2+r,y.y=-(c.top+c.height/2)*u+t/2+i,y.scale=u}}();var B,L,F,E,A,N,_,T,j=0,V=!1,z=!1;A="smoothScroll"in t&&!t.smoothScroll?{start:v,stop:v,cancel:v}:a(function(){return{x:y.x,y:y.y}},function(e,t){Re(),q(e,t)},t.smoothScroll);var W=!1;ie();var G={dispose:function(){oe()},moveBy:re,moveTo:q,smoothMoveTo:function(e,t){re(e-y.x,t-y.y,!0)},centerOn:function(e){var t=e.ownerSVGElement;if(!t)throw new Error("ui element is required to be within the scene");var n=e.getBoundingClientRect(),r=n.left+n.width/2,i=n.top+n.height/2,o=t.getBoundingClientRect();re(o.width/2-r,o.height/2-i,!0)},zoomTo:ke,zoomAbs:ne,smoothZoom:xe,smoothZoomAbs:function(e,t,n){var r={scale:y.scale},o={scale:n};A.cancel(),Re(),_=i(r,o,{step:function(n){ne(e,t,n.scale)}})},showRectangle:function(e){var t=s.getBoundingClientRect(),n=Z(t.width,t.height),r=e.right-e.left,i=e.bottom-e.top;if(!Number.isFinite(r)||!Number.isFinite(i))throw new Error("Invalid rectangle");var o=Math.min(n.x/r,n.y/i);y.x=-(e.left+r/2)*o+n.x/2,y.y=-(e.top+i/2)*o+n.y/2,y.scale=o},pause:function(){oe(),W=!0},resume:function(){W&&(ie(),W=!1)},isPaused:function(){return W},getTransform:function(){return y},getMinZoom:function(){return C},setMinZoom:function(e){C=e},getMaxZoom:function(){return R},setMaxZoom:function(e){R=e},getTransformOrigin:function(){return K},setTransformOrigin:function(e){K=b(e)},getZoomSpeed:function(){return D},setZoomSpeed:function(e){if(!Number.isFinite(e))throw new Error("Zoom speed should be a number");D=e}};o(G);var H="number"==typeof t.initialX?t.initialX:y.x,X="number"==typeof t.initialY?t.initialY:y.y,Y="number"==typeof t.initialZoom?t.initialZoom:y.scale;return H==y.x&&X==y.y&&Y==y.Scale||ne(H,X,Y),G;function Z(e,t){if(n.getScreenCTM){var r=n.getScreenCTM(),i=r.d,o=r.f;f.x=e*r.a-r.e,f.y=t*i-o}else f.x=e,f.y=t;return f}function q(e,t){y.x=e,y.y=t,$(),Pe("pan"),ee()}function U(e,t){q(y.x+e,y.y+t)}function $(){var e=Q();if(e){var t,r,i=!1,o={left:(r={x:(t=n.getBBox()).left*y.scale+y.x,y:t.top*y.scale+y.y}).x,top:r.y,right:t.width*y.scale+r.x,bottom:t.height*y.scale+r.y},a=e.left-o.right;return a>0&&(y.x+=a,i=!0),(a=e.right-o.left)<0&&(y.x+=a,i=!0),(a=e.top-o.bottom)>0&&(y.y+=a,i=!0),(a=e.bottom-o.top)<0&&(y.y+=a,i=!0),i}}function Q(){if(k){if("boolean"==typeof k){var e=s.getBoundingClientRect(),t=e.width,n=e.height;return{left:t*I,top:n*I,right:t*(1-I),bottom:n*(1-I)}}return k}}function ee(){m=!0,w=window.requestAnimationFrame(ae)}function te(e,t,n){if(g(e)||g(t)||g(n))throw new Error("zoom requires valid numbers");var r=y.scale*n;if(r<C){if(y.scale===C)return;n=C/y.scale}if(r>R){if(y.scale===R)return;n=R/y.scale}var i=Z(e,t);y.x=i.x-n*(i.x-y.x),y.y=i.y-n*(i.y-y.y),k&&1===I&&1===C?(y.scale*=n,$()):$()||(y.scale*=n),Pe("zoom"),ee()}function ne(e,t,n){te(e,t,n/y.scale)}function re(e,t,n){if(!n)return U(e,t);N&&N.cancel();var r=0,o=0;N=i({x:0,y:0},{x:e,y:t},{step:function(e){U(e.x-r,e.y-o),r=e.x,o=e.y}})}function ie(){s.addEventListener("mousedown",be,{passive:!1}),s.addEventListener("dblclick",fe,{passive:!1}),s.addEventListener("touchstart",ce,{passive:!1}),s.addEventListener("keydown",se,{passive:!1}),r.addWheelListener(s,ye,{passive:!1}),ee()}function oe(){r.removeWheelListener(s,ye),s.removeEventListener("mousedown",be),s.removeEventListener("keydown",se),s.removeEventListener("dblclick",fe),s.removeEventListener("touchstart",ce),w&&(window.cancelAnimationFrame(w),w=0),A.cancel(),pe(),ge(),J.release(),Me()}function ae(){m&&(m=!1,n.applyTransform(y),Pe("transform"),w=0)}function se(e){var t=0,n=0,r=0;if(38===e.keyCode?n=1:40===e.keyCode?n=-1:37===e.keyCode?t=1:39===e.keyCode?t=-1:189===e.keyCode||109===e.keyCode?r=1:187!==e.keyCode&&107!==e.keyCode||(r=-1),!x(e,t,n,r)){if(t||n){e.preventDefault(),e.stopPropagation();var i=s.getBoundingClientRect();re(.05*(o=Math.min(i.width,i.height))*t,.05*o*n)}if(r){var o,a=Ce(100*r);ke((o=K?Se():{x:(c=s.getBoundingClientRect()).width/2,y:c.height/2}).x,o.y,a)}var c}}function ce(e){if(function(e){t.onTouch&&!t.onTouch(e)||(e.stopPropagation(),e.preventDefault())}(e),1===e.touches.length)return function(e){var t=we(e.touches[0]);B=t;var n=Z(t.x,t.y);L=n.x,F=n.y,A.cancel(),ue()}(e);2===e.touches.length&&(E=he(e.touches[0],e.touches[1]),T=!0,ue())}function ue(){V||(V=!0,document.addEventListener("touchmove",le),document.addEventListener("touchend",de),document.addEventListener("touchcancel",de))}function le(e){if(1===e.touches.length){e.stopPropagation();var t=Z((l=we(e.touches[0])).x,l.y),n=t.x-L,r=t.y-F;0!==n&&0!==r&&Ie(),L=t.x,F=t.y,re(n,r)}else if(2===e.touches.length){T=!0;var i=e.touches[0],o=e.touches[1],a=he(i,o),s=1+(a/E-1)*S,c=we(i),u=we(o);if(L=(c.x+u.x)/2,F=(c.y+u.y)/2,K){var l=Se();L=l.x,F=l.y}ke(L,F,s),E=a,e.stopPropagation(),e.preventDefault()}}function de(e){if(e.touches.length>0){var t=Z((n=we(e.touches[0])).x,n.y);L=t.x,F=t.y}else{var n,r=new Date;r-j<300&&(K?xe((n=Se()).x,n.y,M):xe(B.x,B.y,M)),j=r,Me(),ge()}}function he(e,t){var n=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.sqrt(n*n+r*r)}function fe(e){!function(e){t.onDoubleClick&&!t.onDoubleClick(e)||(e.preventDefault(),e.stopPropagation())}(e);var n=we(e);K&&(n=Se()),xe(n.x,n.y,M)}function be(e){if(!P(e)){if(V)return e.stopPropagation(),!1;if(1===e.button&&null!==window.event||0===e.button){A.cancel();var t=we(e),n=Z(t.x,t.y);return L=n.x,F=n.y,document.addEventListener("mousemove",me),document.addEventListener("mouseup",ve),J.capture(e.target||e.srcElement),!1}}}function me(e){if(!V){Ie();var t=we(e),n=Z(t.x,t.y),r=n.x-L,i=n.y-F;L=n.x,F=n.y,re(r,i)}}function ve(){J.release(),Me(),pe()}function pe(){document.removeEventListener("mousemove",me),document.removeEventListener("mouseup",ve),z=!1}function ge(){document.removeEventListener("touchmove",le),document.removeEventListener("touchend",de),document.removeEventListener("touchcancel",de),z=!1,T=!1,V=!1}function ye(e){if(!O(e)){A.cancel();var t=e.deltaY;e.deltaMode>0&&(t*=100);var n=Ce(t);if(1!==n){var r=K?Se():we(e);ke(r.x,r.y,n),e.preventDefault()}}}function we(e){var t=s.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}function xe(e,t,n){var r=y.scale,o={scale:r},a={scale:n*r};A.cancel(),Re(),_=i(o,a,{step:function(n){ne(e,t,n.scale)},done:Oe})}function Se(){var e=s.getBoundingClientRect();return{x:e.width*K.x,y:e.height*K.y}}function ke(e,t,n){return A.cancel(),Re(),te(e,t,n)}function Re(){_&&(_.cancel(),_=null)}function Ce(e){return 1-Math.sign(e)*Math.min(.25,Math.abs(D*e/128))}function Ie(){z||(Pe("panstart"),z=!0,A.start())}function Me(){z&&(T||A.stop(),Pe("panend"))}function Oe(){Pe("zoomend")}function Pe(e){G.fire(e,G)}}function b(e){if(e)return"object"==typeof e?(p(e.x)&&p(e.y)||m(e),e):void m()}function m(e){throw console.error(e),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join("\n"))}function v(){}function p(e){return Number.isFinite(e)}function g(e){return Number.isNaN?Number.isNaN(e):e!=e}e.exports=f,function(){if("undefined"!=typeof document){var e=document.getElementsByTagName("script");if(e){for(var t,n=0;n<e.length;++n){var r=e[n];if(r.src&&r.src.match(/\bpanzoom(\.min)?\.js/)){t=r;break}}if(t){var i=t.getAttribute("query");if(i){var o=t.getAttribute("name")||"pz",a=Date.now();!function e(){var n=document.querySelector(i);if(!n)return Date.now()-a<2e3?void setTimeout(e,100):void console.error("Cannot find the panzoom element",o);var r=function(e){for(var t=e.attributes,n={},r=0;r<t.length;++r){var i=s(t[r]);i&&(n[i.name]=i.value)}return n}(t);console.log(r),window[o]=f(n,r)}()}}}}function s(e){if(e.name&&"p"===e.name[0]&&"z"===e.name[1]&&"-"===e.name[2])return{name:e.name.substr(3),value:JSON.parse(e.value)}}}()},fWck:function(e,t){function n(e,t,n){e.addEventListener("wheel",t,n)}e.exports=n,e.exports.addWheelListener=n,e.exports.removeWheelListener=function(e,t,n){e.removeEventListener("wheel",t,n)}},sO0u:function(i,s,c){"use strict";c.r(s),c.d(s,"NavigationPageModule",function(){return Ve});var l=c("TEn/"),h=c("tyNb"),f=c("ofXK"),b=c("3Pt+"),m=c("mrSG"),v=c("EnSQ"),p=c("WdNr"),g=c("fXoL"),y=function(){function e(t){u(this,e),this.icon=t}return d(e,[{key:"render",value:function(e,t,n,r,i){var o=new Image;o.onload=function(){e.drawImage(o,t,n,r,i)},o.src="assets/"+this.icon}}]),e}(),w=c("cQc6"),x=function(){function e(t){u(this,e),this.mapItem=t,this.doAnim=!1}return d(e,[{key:"render",value:function(e){this.mapItem.Sections&&this.mapItem.Sections.length>0&&(e.beginPath(),this.renderSections(e),e.strokeStyle="#FFF",e.fillStyle=this.mapItem.Color,e.stroke(),e.fill(),e.closePath())}},{key:"startAnimation",value:function(e,t){var n=this;this.animationCallback=function(){if(!0===n.doAnim){e.save();var r=new Date;if(e.beginPath(),n.renderSections(e),e.lineWidth=1,e.strokeStyle=r.getSeconds()%2==0?"#FFF":"#000",e.fillStyle=r.getSeconds()%2==0?"#000":n.mapItem.Color,e.stroke(),e.fill(),e.closePath(),e.restore(),window.requestAnimationFrame(n.animationCallback),void 0!==t&&void 0!==t.renderer&&void 0!==t.floor){var i,o=a(t.renderer);try{for(o.s();!(i=o.n()).done;){i.value.render(e,t)}}catch(s){o.e(s)}finally{o.f()}}}},this.doAnim=!0,window.requestAnimationFrame(this.animationCallback)}},{key:"stopAnimation",value:function(e){this.doAnim=!1,this.animationCallback=null}},{key:"renderSections",value:function(e){e.moveTo(this.mapItem.Sections[0].Start.X,this.mapItem.Sections[0].Start.Y);for(var t=1;t<this.mapItem.Sections.length;t++)e.lineTo(this.mapItem.Sections[t].Start.X,this.mapItem.Sections[t].Start.Y);e.lineTo(this.mapItem.Sections[0].Start.X,this.mapItem.Sections[0].Start.Y)}},{key:"MapItem",get:function(){return this.mapItem}}]),e}(),S=function(){function e(t){u(this,e),this.location=t}return d(e,[{key:"render",value:function(e){e.font="12px Arial",e.textAlign="center",e.fillStyle="#000",e.fillText(this.location.Name,this.location.PathNode.Coordinate.X,this.location.PathNode.Coordinate.Y)}},{key:"startAnimation",value:function(e){}},{key:"stopAnimation",value:function(e){}},{key:"Location",get:function(){return this.location}}]),e}(),k=function(){function e(t){u(this,e),this.route=t}return d(e,[{key:"render",value:function(e,t){var n=new y("pin-sharp.png");this.route.Start.Floor===t.floor&&n.render(e,this.route.Start.Node.Coordinate.X-15,this.route.Start.Node.Coordinate.Y-30,30,30);var r=new y("flag-sharp.png");this.route.End.Floor===t.floor&&r.render(e,this.route.End.Node.Coordinate.X-5,this.route.End.Node.Coordinate.Y-30,30,30);var i=this.route.RouteSections.filter(function(e){return e.Floor===t.floor});if(null!=i){var o,s=a(i);try{for(s.s();!(o=s.n()).done;){var c=o.value;e.strokeStyle="#A00",e.lineWidth=3,e.beginPath(),e.moveTo(c.Route[0].Coordinate.X,c.Route[0].Coordinate.Y);for(var u=1;u<c.Route.length;u++)e.lineTo(c.Route[u].Coordinate.X,c.Route[u].Coordinate.Y);e.stroke(),e.closePath()}}catch(w){s.e(w)}finally{s.f()}var l,d=a(i);try{for(d.s();!(l=d.n()).done;){var h=l.value,f=h.Route.length,b=h.Distance,m=h.Route[Math.round((f-1)/2)].Coordinate.X,v=h.Route[Math.round((f-1)/2)].Coordinate.Y,p=e.measureText(b.toString()).width+14,g=parseInt("14px Arial",10)+14;e.fillStyle="#A00",e.fillRect(m-p/2,v-g/2,p,20),e.font="14px Arial",e.fillStyle="#FFF",e.fillText(b.toString(),m,v)}}catch(w){d.e(w)}finally{d.f()}}}},{key:"startAnimation",value:function(e){}},{key:"stopAnimation",value:function(e){}},{key:"Route",get:function(){return this.route}}]),e}(),R=function(){function e(){u(this,e)}return d(e,null,[{key:"GetMapItemRendererCanvas",value:function(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];e.push(new x(a))}return e}},{key:"GetLocationRendererCanvas",value:function(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];e.push(new S(a))}return e}},{key:"GetRouteRendererCanvas",value:function(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];e.push(new k(a))}return e}}]),e}(),C=c("fQX0"),I=c.n(C),M=["fab"];function O(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-fab-button",4),g.Wb("click",function(){g.hc(n);var e=t.index;return g.Yb().emitAnotherFloorToShow(e)}),g.Ib(1,"span",5),g.Jb()}if(2&e){var r=t.$implicit;g.xb(1),g.dc("innerHTML",r,g.ic)}}var P,D,K=((D=function(){function e(t){u(this,e),this._dataService=t,this.floorWithBuilding=new g.o}return d(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e.currentBuilding||void 0===this.currentBuilding){t.next=5;break}return t.next=3,this._dataService.get_building(this.currentBuilding).toPromise();case 3:n=t.sent,this.availableFloors=n.Floors;case 5:case"end":return t.stop()}},t,this)}))}},{key:"emitAnotherFloorToShow",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.floorWithBuilding.emit({floor:this.availableFloors[e],building:this.currentBuilding}),this.currentFloor=this.availableFloors[e];case 1:case"end":return t.stop()}},t,this)}))}}]),e}()).\u0275fac=function(e){return new(e||D)(g.Hb(v.a))},D.\u0275cmp=g.Bb({type:D,selectors:[["app-floor-button"]],viewQuery:function(e,t){var n;1&e&&g.rc(M,!0),2&e&&g.fc(n=g.Xb())&&(t.fab=n.first)},inputs:{currentBuilding:"currentBuilding",currentFloor:"currentFloor"},outputs:{floorWithBuilding:"floorWithBuilding"},features:[g.vb],decls:7,vars:3,consts:[["vertical","top","horizontal","end","slot","fixed"],["fab",""],["side","bottom"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"innerHTML"]],template:function(e,t){1&e&&(g.Kb(0,"ion-fab",0,1),g.Kb(2,"ion-fab-button"),g.Kb(3,"span"),g.nc(4),g.Jb(),g.Jb(),g.Kb(5,"ion-fab-list",2),g.mc(6,O,2,1,"ion-fab-button",3),g.Jb(),g.Jb()),2&e&&(g.xb(4),g.qc("",t.currentBuilding,".",t.currentFloor,""),g.xb(2),g.dc("ngForOf",t.availableFloors))},directives:[l.q,l.r,l.s,f.i],styles:[""]}),D),J=((P=function(){function e(t){u(this,e),this.dataService=t,this.clickThreshold=20,this.mapItemRenderer=[],this.locationRenderer=[],this.routeRenderer=[],this.locationClick=new g.o,this.mapScroll=new g.o}return d(e,[{key:"ngAfterViewInit",value:function(){var e=this;this.panZoomController||(this.panZoomController=I()(document.getElementById("map"),{maxZoom:2,minZoom:.25,initialZoom:.7,bounds:!0,boundsPadding:.1,onTouch:function(t){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=1===t.touches.length,!n.t0){n.next=4;break}return n.next=4,e.onElementClick(t.touches[0].clientX,t.touches[0].clientY,t.target);case 4:return n.abrupt("return",!1);case 5:case"end":return n.stop()}},n)}))}}))}},{key:"showRoute",value:function(e,t){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.stopAllAnimations(),n.next=3,this.renderNavigationPage(e,t.Building,t.Floor);case 3:case"end":return n.stop()}},n,this)}))}},{key:"showDiscoveryLocation",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.stopAllAnimations(),t.next=3,this.dataService.get_locations_search(e).toPromise();case 3:if(null!==(n=t.sent)&&0!==n.length){t.next=6;break}throw new Error("Studi-Guide can't find "+e);case 6:return r=n[0],this.currentBuilding=r.Building,t.next=10,this.dataService.get_map_floor(this.currentBuilding,r.Floor).toPromise();case 10:return i=t.sent,this.mapItemRenderer=R.GetMapItemRendererCanvas.apply(R,o(i)),t.next=14,this.dataService.get_locations(r.Building,r.Floor).toPromise();case 14:return a=t.sent,t.abrupt("return",(this.locationRenderer=R.GetLocationRendererCanvas.apply(R,o(a)),this.clearMapCanvas(),this.createNewCanvasMap(),this.renderMapItems(),this.renderLocations(),this.displayPin(r.PathNode),this.currentFloor=r.Floor,this.CenterMap(r.PathNode.Coordinate.X,r.PathNode.Coordinate.Y),r));case 16:case"end":return t.stop()}},t,this)}))}},{key:"showFloor",value:function(e,t){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this.stopAllAnimations(),null==this.currentRoute){n.next=5;break}return n.next=3,this.renderNavigationPage(this.currentRoute,this.currentBuilding,e);case 3:n.next=13;break;case 5:return n.next=7,this.dataService.get_map_items("",e,t).toPromise();case 7:return r=n.sent,this.mapItemRenderer=R.GetMapItemRendererCanvas.apply(R,o(r)),this.createNewCanvasMap(),n.next=11,this.dataService.get_locations_items("",e,t).toPromise();case 11:i=n.sent,this.locationRenderer=R.GetLocationRendererCanvas.apply(R,o(i)),this.renderMapItems(),this.renderLocations();case 13:this.currentFloor=e,this.currentBuilding=t,this.FitMap();case 14:case"end":return n.stop()}},n,this)}))}},{key:"showDiscoveryMap",value:function(e,t){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.dataService.get_map_items(e,t,"").toPromise();case 2:return r=n.sent,this.mapItemRenderer=R.GetMapItemRendererCanvas.apply(R,o(r)),n.next=6,this.dataService.get_locations_items(e,t,"").toPromise();case 6:i=n.sent,this.locationRenderer=R.GetLocationRendererCanvas.apply(R,o(i)),this.createNewCanvasMap(),this.renderMapItems(),this.renderLocations(),this.currentFloor=t,this.FitMap();case 8:case"end":return n.stop()}},n,this)}))}},{key:"clearMapCanvas",value:function(){var e=document.getElementById("map").getContext("2d");null!=e&&e.clearRect(0,0,e.canvas.width,e.canvas.height)}},{key:"onClick",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.onElementClick(e.clientX,e.clientY,e.target);case 2:case"end":return t.stop()}},t,this)}))}},{key:"onElementClick",value:function(e,t,n){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){var i,o,s,c,l,h,f,b,m,v,p,g,y,x,S,k,R,C;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=this.panZoomController.getTransform(),o=function(){function e(){u(this,e)}return d(e,null,[{key:"transformInOriginCoordinate",value:function(e,t,n){var r=n.getBoundingClientRect(),i=(e.x-r.left)/t,o=(e.y-r.top)/t;return console.log("Transform x:"+e.x+" y:"+e.y+"  to coordinate: x:"+i+" y:"+o),{x:i,y:o}}}]),e}().transformInOriginCoordinate({x:e,y:t},i.scale,n),s=[o.x,o.y],null==this.currentRoute){r.next=18;break}c=[],l=a(this.getInteractiveStairWellMapItemRenderer(this.currentFloor));try{for(l.s();!(h=l.n()).done;)f=h.value,c.push(f.MapItem)}catch(I){l.e(I)}finally{l.f()}b=0,m=c;case 6:if(!(b<m.length)){r.next=18;break}v=m[b],p=[],g=a(v.Sections);try{for(g.s();!(y=g.n()).done;)x=y.value,p.push([x.Start.X,x.Start.Y])}catch(I){g.e(I)}finally{g.f()}if(!w(s,p)){r.next=15;break}return r.next=14,this.showNextFloor(v);case 14:return r.abrupt("return",void r.sent);case 15:b++,r.next=6;break;case 18:S=a(this.locationRenderer),r.prev=19,S.s();case 21:if((k=S.n()).done){r.next=28;break}if(R=k.value,C=R.Location,!(Math.abs(C.PathNode.Coordinate.X-s[0])<this.clickThreshold&&Math.abs(C.PathNode.Coordinate.Y-s[1])<this.clickThreshold)){r.next=26;break}return r.abrupt("return",void this.locationClick.emit(C));case 26:r.next=21;break;case 28:r.next=33;break;case 30:r.prev=30,r.t0=r.catch(19),S.e(r.t0);case 33:return r.prev=33,S.f(),r.finish(33);case 36:case"end":return r.stop()}},r,this,[[19,30,33,36]])}))}},{key:"renderNavigationPage",value:function(e,t,n){var r,i;return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function s(){var c,u,l,d,h,f,b,m,v;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.dataService.get_map_floor(t,n).toPromise();case 2:if(s.t1=r=s.sent,s.t0=null!==s.t1,!s.t0){s.next=6;break}s.t0=void 0!==r;case 6:if(!s.t0){s.next=10;break}s.t2=r,s.next=11;break;case 10:s.t2=new Array;case 11:return c=s.t2,s.next=14,this.dataService.get_locations(t,n).toPromise();case 14:if(s.t4=i=s.sent,s.t3=null!==s.t4,!s.t3){s.next=18;break}s.t3=void 0!==i;case 18:if(!s.t3){s.next=22;break}s.t5=i,s.next=23;break;case 22:s.t5=new Array;case 23:u=s.t5,l=a(e.RouteSections),s.prev=25,l.s();case 27:if((d=l.n()).done){s.next=40;break}if((h=d.value).Floor!==n||h.Building===t){s.next=38;break}return s.next=32,this.dataService.get_map_floor(h.Building,h.Floor).toPromise();case 32:return f=s.sent,c=c.concat(f),s.next=36,this.dataService.get_locations(h.Building,h.Floor).toPromise();case 36:b=s.sent,u=u.concat(b);case 38:s.next=27;break;case 40:s.next=45;break;case 42:s.prev=42,s.t6=s.catch(25),l.e(s.t6);case 45:return s.prev=45,l.f(),s.finish(45);case 48:this.mapItemRenderer=R.GetMapItemRendererCanvas.apply(R,o(c)),this.locationRenderer=R.GetLocationRendererCanvas.apply(R,o(u)),this.routeRenderer=R.GetRouteRendererCanvas(e),this.createNewCanvasMap(),this.currentBuilding=t,this.renderMapItems(),this.renderLocations(),this.renderRoutes({floor:n}),m=a(this.getInteractiveStairWellMapItemRenderer(n));try{for(m.s();!(v=m.n()).done;)v.value.startAnimation(this.renderingContext,{renderer:this.routeRenderer,floor:n})}catch(p){m.e(p)}finally{m.f()}this.currentRoute=e,this.currentFloor=n;case 52:case"end":return s.stop()}},s,this,[[25,42,45,48]])}))}},{key:"createNewCanvasMap",value:function(){var e,t=document.getElementById("map"),n=0,r=0,i=a(this.mapItemRenderer);try{for(i.s();!(e=i.n()).done;){var o=e.value.MapItem;if(o.Sections){var s,c=a(o.Sections);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.End.X>r&&(r=l.End.X),l.End.Y>n&&(n=l.End.Y)}}catch(m){c.e(m)}finally{c.f()}}if(o.PathNodes){var h,f=a(o.PathNodes);try{for(f.s();!(h=f.n()).done;){var b=h.value;b.Coordinate.X>r&&(r=b.Coordinate.X),b.Coordinate.Y>n&&(n=b.Coordinate.Y)}}catch(m){f.e(m)}finally{f.f()}}}}catch(m){i.e(m)}finally{i.f()}this.renderingContext=function(){function e(){u(this,e)}return d(e,null,[{key:"setup",value:function(e,t,n){var r=this.GetPixelRatio();return e.width=t*r,e.height=n*r,e.style.width=t+"px",e.style.height=n+"px",this.getContext(e)}},{key:"getContext",value:function(e){var t=this.GetPixelRatio(),n=e.getContext("2d");return n.scale(t,t),n}},{key:"GetPixelRatio",value:function(){return window.devicePixelRatio||1}}]),e}().setup(t,r,n)}},{key:"displayPin",value:function(e){var t=e.Coordinate.X-15,n=e.Coordinate.Y-30;new y("pin-sharp.png").render(this.renderingContext,t,n,30,30)}},{key:"showNextFloor",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<this.currentRoute.RouteSections.length-1)){t.next=11;break}if(this.currentRoute.RouteSections[n].Floor!==e.Floor||this.currentRoute.RouteSections[n].Building!==e.Building){t.next=8;break}return this.currentFloor=this.currentRoute.RouteSections[n+1].Floor,this.currentBuilding=this.currentRoute.RouteSections[n+1].Building,t.next=7,this.showFloor(this.currentFloor,this.currentBuilding);case 7:return t.abrupt("return",void t.sent);case 8:n++,t.next=1;break;case 11:case"end":return t.stop()}},t,this)}))}},{key:"getInteractiveStairWellMapItemRenderer",value:function(e){var t,n=this,r=[],i=a(this.routeRenderer);try{for(i.s();!(t=i.n()).done;)for(var o=t.value,s=0;s<o.Route.RouteSections.length-1;s++)o.Route.RouteSections[s].Building===o.Route.RouteSections[s+1].Building&&r.push(o.Route.RouteSections[s].Route[o.Route.RouteSections[s].Route.length-1])}catch(h){i.e(h)}finally{i.f()}for(var c=[],u=function(){var t,r=d[l],i=a(n.mapItemRenderer);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.MapItem.Floor===e&&o.MapItem.PathNodes.filter(function(e){return e.Id===r.Id}).length>0&&c.push(o)}}catch(h){i.e(h)}finally{i.f()}},l=0,d=r;l<d.length;l++)u();return c}},{key:"stopAllAnimations",value:function(){var e,t=a(this.routeRenderer);try{for(t.s();!(e=t.n()).done;)e.value.stopAnimation(this.renderingContext)}catch(s){t.e(s)}finally{t.f()}var n,r=a(this.mapItemRenderer);try{for(r.s();!(n=r.n()).done;)n.value.stopAnimation(this.renderingContext)}catch(s){r.e(s)}finally{r.f()}var i,o=a(this.locationRenderer);try{for(o.s();!(i=o.n()).done;)i.value.stopAnimation(this.renderingContext)}catch(s){o.e(s)}finally{o.f()}}},{key:"renderMapItems",value:function(){var e,t=a(this.mapItemRenderer);try{for(t.s();!(e=t.n()).done;)e.value.render(this.renderingContext)}catch(n){t.e(n)}finally{t.f()}}},{key:"renderLocations",value:function(){var e,t=a(this.locationRenderer);try{for(t.s();!(e=t.n()).done;)e.value.render(this.renderingContext)}catch(n){t.e(n)}finally{t.f()}}},{key:"renderRoutes",value:function(e){var t,n=a(this.routeRenderer);try{for(n.s();!(t=n.n()).done;)t.value.render(this.renderingContext,e)}catch(r){n.e(r)}finally{n.f()}}},{key:"onFloorChangeByFloorButton",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.showAnotherFloorOfCurrentBuilding(e.floor,e.building);case 2:case"end":return t.stop()}},t,this)}))}},{key:"showAnotherFloorOfCurrentBuilding",value:function(e,t){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return le.progressIsVisible=!0,n.next=3,this.showFloor(e,t);case 3:le.progressIsVisible=!1;case 4:case"end":return n.stop()}},n,this)}))}},{key:"CenterMap",value:function(e,t){var n=this.calulateMovePosition(e,t);this.panZoomController.smoothMoveTo(n.x,n.y)}},{key:"calulateMovePosition",value:function(e,t){var n=document.getElementById("canvas-wrapper");return{x:n.clientWidth/2-e,y:n.parentElement.parentElement.clientHeight/2-t}}},{key:"MapSize",value:function(){return document.getElementById("map").getBoundingClientRect()}},{key:"FitMap",value:function(){var e=this.MapSize();this.CenterMap(e.width/2,e.height/2)}},{key:"CurrentRoute",get:function(){return this.currentRoute}},{key:"CurrentBuilding",get:function(){return this.currentBuilding}}]),e}()).\u0275fac=function(e){return new(e||P)(g.Hb(v.a))},P.\u0275cmp=g.Bb({type:P,selectors:[["app-map-view"]],outputs:{locationClick:"locationClick",mapScroll:"mapScroll"},decls:4,vars:2,consts:[["id","canvas-wrapper",1,"draggable"],[3,"currentBuilding","currentFloor","floorWithBuilding"],["id","map",3,"click"],["map",""]],template:function(e,t){1&e&&(g.Kb(0,"div",0),g.Kb(1,"app-floor-button",1),g.Wb("floorWithBuilding",function(e){return t.onFloorChangeByFloorButton(e)}),g.Jb(),g.Kb(2,"canvas",2,3),g.Wb("click",function(e){return t.onClick(e)}),g.Jb(),g.Jb()),2&e&&(g.xb(1),g.dc("currentBuilding",t.CurrentBuilding)("currentFloor",t.currentFloor))},directives:[K],styles:["body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{height:100%;width:100%}#canvas-wrapper[_ngcontent-%COMP%]{padding:2px;overflow:hidden;scrollbar-width:none;-ms-overflow-style:none}#canvas-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.draggable[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}"]}),P),B=c("tk/3"),L=["destinationSearchbar"],F=["startSearchBar"];function E(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-button",8),g.Wb("click",function(){return g.hc(n),g.Yb().emitDiscoveryEvent()}),g.Ib(1,"ion-icon",9),g.Jb()}}function A(e,t){1&e&&g.Ib(0,"span",10)}function N(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-button",5),g.Wb("click",function(){return g.hc(n),g.Yb(2).hideRouteSearchBar()}),g.Ib(1,"ion-icon",14),g.Jb()}}function _(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-item",0),g.Kb(1,"ion-searchbar",11,12),g.Wb("click",function(){return g.hc(n),g.Yb().onSearchBarHasFocus("startSearchBar")})("keydown",function(e){return g.hc(n),g.Yb().onKey(e,"startSearchBar")},!1,g.gc),g.Jb(),g.mc(3,N,2,0,"ion-button",13),g.Jb()}if(2&e){var r=g.Yb();g.xb(1),g.dc("value",r.startSearchBarValue),g.xb(2),g.dc("ngIf",r.closeRouteBtnIsVisible)}}var T,j,V,z=((T=function(){function e(){u(this,e),this.discovery=new g.o,this.route=new g.o,this.searchBarFocus=new g.o,this.searchBtnIsVisible=!0,this.routeInputIsVisible=!1,this.closeRouteBtnIsVisible=!1}return d(e,[{key:"ngOnInit",value:function(){}},{key:"showRouteSearchBar",value:function(){this.routeInputIsVisible=!0,this.searchBtnIsVisible=!1,this.closeRouteBtnIsVisible=!0}},{key:"hideRouteSearchBar",value:function(){this.routeInputIsVisible&&(this.routeInputIsVisible=!1,this.searchBtnIsVisible=!0,this.closeRouteBtnIsVisible=!1)}},{key:"routeBtnClick",value:function(){this.routeInputIsVisible?this.emitRouteEvent():this.showRouteSearchBar()}},{key:"emitDiscoveryEvent",value:function(){var e=""===this.destinationSearchbar.value||void 0===this.destinationSearchbar.value;if(!(e=e||null===this.destinationSearchbar.value)){var t=document.activeElement;t&&t.blur&&t.blur(),this.discovery.emit(this.destinationSearchbar.value)}}},{key:"emitRouteEvent",value:function(){var e=""===this.destinationSearchbar.value||void 0===this.destinationSearchbar.value;e=e||null===this.destinationSearchbar.value;var t=""===this.startSearchBar.value||void 0===this.startSearchBar.value;if(t=t||null===this.startSearchBar.value,!e&&!t){var n=[this.startSearchBar.value,this.destinationSearchbar.value],r=document.activeElement;r&&r.blur&&r.blur(),this.route.emit(n)}}},{key:"clearDestinationInput",value:function(){this.destinationSearchbar.value=""}},{key:"clearStartInput",value:function(){this.startSearchBar.value=""}},{key:"setDiscoverySearchbarValue",value:function(e){this.destinationSearchbarValue=e}},{key:"setStartSearchbarValue",value:function(e){this.startSearchBarValue=e}},{key:"onSearchBarHasFocus",value:function(e){this.searchBarFocus.emit(e)}},{key:"onKey",value:function(e,t){"Enter"===e.key&&("destinationSearchbar"===t&&this.emitDiscoveryEvent(),"startSearchBar"===t&&this.emitRouteEvent())}}]),e}()).\u0275fac=function(e){return new(e||T)},T.\u0275cmp=g.Bb({type:T,selectors:[["app-search-input"]],viewQuery:function(e,t){var n;1&e&&(g.rc(L,!0),g.rc(F,!0)),2&e&&(g.fc(n=g.Xb())&&(t.destinationSearchbar=n.first),g.fc(n=g.Xb())&&(t.startSearchBar=n.first))},outputs:{discovery:"discovery",route:"route",searchBarFocus:"searchBarFocus"},decls:8,vars:4,consts:[["lines","none"],["search-icon","navigate-circle-outline","inputmode","text","mode","ios","placeholder","destination","color","","icon-color","dark",3,"value","click","keydown"],["destinationSearchbar",""],["size","default","mode","ios","color","medium",3,"click",4,"ngIf"],["class","vertical-line",4,"ngIf"],["size","default","mode","ios","color","primary",3,"click"],["size","large","slot","icon-only","src","assets/navigation-svgs/directions-24px.svg"],["lines","none",4,"ngIf"],["size","default","mode","ios","color","medium",3,"click"],["size","large","slot","icon-only","name","search","color",""],[1,"vertical-line"],["animated","true","color","","icon-color","dark","inputmode","text","mode","ios","placeholder","start","search-icon","locate-outline",3,"value","click","keydown"],["startSearchBar",""],["size","default","mode","ios","color","primary",3,"click",4,"ngIf"],["size","large","slot","icon-only","name","close-outline"]],template:function(e,t){1&e&&(g.Kb(0,"ion-item",0),g.Kb(1,"ion-searchbar",1,2),g.Wb("click",function(){return t.onSearchBarHasFocus("destinationSearchbar")})("keydown",function(e){return t.onKey(e,"destinationSearchbar")},!1,g.gc),g.Jb(),g.mc(3,E,2,0,"ion-button",3),g.mc(4,A,1,0,"span",4),g.Kb(5,"ion-button",5),g.Wb("click",function(){return t.routeBtnClick()}),g.Ib(6,"ion-icon",6),g.Jb(),g.Jb(),g.mc(7,_,4,2,"ion-item",7)),2&e&&(g.xb(1),g.dc("value",t.destinationSearchbarValue),g.xb(2),g.dc("ngIf",t.searchBtnIsVisible),g.xb(1),g.dc("ngIf",t.searchBtnIsVisible),g.xb(3),g.dc("ngIf",t.routeInputIsVisible))},directives:[l.y,l.J,l.db,f.j,l.h,l.w],styles:["ion-searchbar[_ngcontent-%COMP%]{max-width:300px}"]}),T),W=c("+JbE"),G=c("YD5U"),H=function(){function e(t){u(this,e),this._campus=t,this._addressString=this.getAddressString(this._campus)}return d(e,[{key:"getAddressString",value:function(e){var t="";if(null!==e.edges.Address)for(var n=X(e.edges.Address,function(e){return e.Street}),r=0,i=Object.keys(n);r<i.length;r++){var o=i[r],a=n[o];""!==t&&(t+="; ");var s=a[0].Number;a.length>1&&(s+="-"+a[a.length-1].Number),t+=o+" "+s+", ",t+=n[o][0].PLZ+" "+n[o][0].City}return t}},{key:"Address",get:function(){return this._addressString}},{key:"Name",get:function(){return this._campus.Name}},{key:"ShortName",get:function(){return this._campus.ShortName}},{key:"LatLng",get:function(){return{lat:this._campus.Latitude,lng:this._campus.Longitude}}}]),e}(),X=function(e,t){return e.reduce(function(e,n){var r=t(n);return e[r]||(e[r]=[]),e[r].push(n),e},{})},Y=((V=function(){function e(){u(this,e),this.recentSearches=[],this.latestSearchResult={Name:"",Description:"",Information:[],DetailRouterParams:{},RouteRouterParams:{},LatLng:{lat:0,lng:0}},this.availableCampus=[],this.Route={Coordinates:[],Distance:0,NavigationInstructions:[],Time:0}}return d(e,[{key:"SetCampusAsSearchResultObject",value:function(e){this.latestSearchResult={Name:e.Name,Description:e.ShortName,Information:[["ShortName: ",e.ShortName],["Longitude: ",e.Longitude],["Latitude: ",e.Latitude]],DetailRouterParams:{},RouteRouterParams:{},LatLng:{lat:e.Latitude,lng:e.Longitude}}}},{key:"SetBuildingAsSearchResultObject",value:function(e,t){this.latestSearchResult={Name:e.Name,Description:"Campus:"+e.Campus,Information:[],DetailRouterParams:{building:e.Name},RouteRouterParams:{},LatLng:t}}},{key:"SetLocationAsSearchResultObject",value:function(e,t){var n=[["Building: ",e.Name]];e.Tags&&n.push(["Tags: ",e.Tags.join(", ")]),this.latestSearchResult={Name:e.Name,Description:e.Description,Information:n,DetailRouterParams:{location:e.Name},RouteRouterParams:{start:e.Building+".Entrance",destination:e.Name},LatLng:t}}},{key:"SetGraphHopperRouteAsRoute",value:function(e){var t,n=[],r=a(e.Points.Coordinates);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push([i.Lat,i.Lng])}}catch(o){r.e(o)}finally{r.f()}this.Route={Coordinates:n,Distance:Math.round(e.Distance),NavigationInstructions:e.Instructions,Time:Math.round(e.Time/1e3/60)}}}]),e}()).\u0275fac=function(e){return new(e||V)},V.\u0275prov=g.Db({token:V,factory:V.\u0275fac,providedIn:"root"}),V),Z=((j=function(){function e(){u(this,e)}return d(e,null,[{key:"addRecentSearch",value:function(e,t,n){t.recentSearches.includes(e)&&t.recentSearches.splice(t.recentSearches.indexOf(e),1),t.recentSearches.unshift(e),t.recentSearches.length>3&&t.recentSearches.pop(),n.set(this.recentSearchesKey,JSON.stringify([t.recentSearches])),console.log(t.recentSearches)}},{key:"readRecentSearch",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,e.get(this.recentSearchesKey);case 3:return t.t1=t.sent,n=t.t0.parse.call(t.t0,t.t1),t.abrupt("return",null!=n?n[0]:null);case 6:case"end":return t.stop()}},t,this)}))}}]),e}()).recentSearchesKey="searches",j),q=c("gcOT"),U=c("e8h1"),$=["drawerContent"],Q=["searchDrawer"],ee=["locationDrawer"];function te(e,t){1&e&&g.Ib(0,"ion-progress-bar",37)}function ne(e,t){if(1&e&&(g.Kb(0,"ion-text",38),g.Kb(1,"h5"),g.Kb(2,"span",39),g.nc(3),g.Jb(),g.Jb(),g.Kb(4,"p"),g.Ob(5,40),g.Jb(),g.Kb(6,"p"),g.Rb(7,41),g.Ib(8,"br"),g.Ib(9,"a",42),g.Pb(),g.Jb(),g.Jb()),2&e){var n=g.Yb();g.xb(3),g.oc(n.errorMessage)}}function re(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-item",43),g.Wb("click",function(){g.hc(n);var e=t.$implicit;return g.Yb().recentSearchClick(e)}),g.Kb(1,"ion-label"),g.Kb(2,"h2"),g.nc(3),g.Jb(),g.Jb(),g.Jb()}if(2&e){var r=t.$implicit;g.xb(3),g.oc(r)}}function ie(e,t){if(1&e&&(g.Kb(0,"ion-item"),g.Kb(1,"ion-label"),g.Kb(2,"h2"),g.nc(3),g.Jb(),g.Kb(4,"h3"),g.nc(5),g.Jb(),g.Jb(),g.Jb()),2&e){var n=t.$implicit;g.xb(3),g.qc("",n.ShortName,": ",n.Name,""),g.xb(2),g.oc(n.Address)}}function oe(e,t){if(1&e&&(g.Kb(0,"ion-row"),g.Kb(1,"ion-col"),g.nc(2),g.Jb(),g.Kb(3,"ion-col"),g.nc(4),g.Jb(),g.Jb()),2&e){var n=t.$implicit;g.xb(2),g.oc(n[0]),g.xb(2),g.oc(n[1])}}var ae,se,ce,ue=q.a.Keyboard,le=((se=function(){function e(t,n,r,i,o,a,s){u(this,e),this.dataService=t,this.modalCtrl=n,this.route=r,this.router=i,this.storage=o,this.model=a,this.platform=s,this.availableCampus=[],this.isSubscripted=!1}return d(e,[{key:"ngAfterViewInit",value:function(){this.locationDrawer.SetState(W.a.Hidden),this.searchDrawer.SetState(G.a.GetRecommendedDrawerStateForDevice())}},{key:"ionViewDidEnter",value:function(){var e=this;!1===this.isSubscripted&&(this.isSubscripted=!0,this.route.queryParams.subscribe(function(t){return Object(m.a)(e,void 0,void 0,regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null!=t&&null!=t.location&&t.location.length>0)){e.next=5;break}return this.searchInput.setDiscoverySearchbarValue(t.location),e.next=4,this.onDiscovery(t.location);case 4:return e.abrupt("return",void e.sent);case 5:if(!(null!=t&&null!=t.start&&t.start.length>0&&null!=t.destination&&t.destination.length>0)){e.next=10;break}return e.next=8,this.showNavigation(t.start,t.destination);case 8:e.next=22;break;case 10:if(!(null!=t&&null!=t.building&&t.building.length>0)){e.next=20;break}return e.next=13,this.dataService.get_building(t.building).toPromise();case 13:if(r=e.sent,e.t0=null!==r,!e.t0){e.next=18;break}return e.next=18,this.mapView.showFloor((null===(n=r.Floors)||void 0===n?void 0:n.includes("EG"))?"EG":r.Floors[0],r.Name);case 18:e.next=22;break;case 20:return e.next=22,this.showDiscoveryMode();case 22:case"end":return e.stop()}},e,this)}))}))}},{key:"ngOnInit",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.model.recentSearches.length){e.next=5;break}return e.next=3,Z.readRecentSearch(this.storage);case 3:null!==(t=e.sent)&&(this.model.recentSearches=t,console.log(this.model.recentSearches));case 5:if(e.t0=0===this.model.availableCampus.length,!e.t0){e.next=10;break}return e.next=9,this.dataService.get_campus_search().toPromise();case 9:this.model.availableCampus=e.sent;case 10:n=a(this.model.availableCampus);try{for(n.s();!(r=n.n()).done;)i=r.value,this.availableCampus.push(new H(i))}catch(o){n.e(o)}finally{n.f()}case 12:case"end":return e.stop()}},e,this)}))}},{key:"onDiscovery",value:function(t){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.model.errorMessage="",e.progressIsVisible=!0,n.prev=1,n.next=4,this.mapView.showDiscoveryLocation(t);case 4:return r=n.sent,Z.addRecentSearch(t,this.model,this.storage),n.next=8,this.showLocationDrawer(r);case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),this.handleInputError(n.t0,t);case 13:return n.prev=13,e.progressIsVisible=!1,n.finish(13);case 16:case"end":return n.stop()}},n,this,[[1,10,13,16]])}))}},{key:"onRoute",value:function(t){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,o,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.errorMessage="",e.progressIsVisible=!0,n.prev=1,n.next=4,this.dataService.get_location(t[0]).toPromise();case 4:return r=n.sent,n.next=7,this.dataService.get_route(t[0],t[1]).toPromise();case 7:return i=n.sent,n.next=10,this.mapView.showRoute(i,r);case 10:this.mapView.CenterMap(r.PathNode.Coordinate.X,r.PathNode.Coordinate.Y),n.next=18;break;case 13:n.prev=13,n.t0=n.catch(1),o="",n.t0 instanceof B.d&&((a=n.t0.error.message).includes(t[0])&&(o=t[0]),a.includes(t[1])&&(o.length>0&&(o+=" and "),o+=t[1])),this.handleInputError(n.t0,0===o.length?t.toString():o);case 18:return n.prev=18,e.progressIsVisible=!1,n.finish(18);case 21:case"end":return n.stop()}},n,this,[[1,13,18,21]])}))}},{key:"onDrawerStateChange",value:function(e){void 0!==this.drawerContent&&(this.drawerContent.scrollY=e===W.a.Top)}},{key:"showLocationDrawer",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.locationDrawer.SetState(W.a.Hidden);case 2:if(this.model.latestSearchResult.Name=e.Name,this.model.latestSearchResult.Description=e.Description,this.model.latestSearchResult.Information=e.Tags?[["Tags: ",e.Tags.join(",")]]:[],t.t0=this.platform.is("hybrid"),!t.t0){t.next=9;break}return t.next=9,ue.hide();case 9:return t.next=11,this.searchDrawer.SetState(W.a.Hidden);case 11:return t.next=13,this.locationDrawer.SetState(G.a.GetRecommendedDrawerStateForDevice());case 13:case"end":return t.stop()}},t,this)}))}},{key:"onCloseLocationDrawer",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.locationDrawer.SetState(W.a.Hidden);case 2:return e.next=4,this.searchDrawer.SetState(G.a.GetRecommendedDrawerStateForDevice());case 4:case"end":return e.stop()}},e,this)}))}},{key:"presentAvailableFloorModal",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,i,o,s,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Array,e.next=3,this.dataService.get_buildings_search().toPromise();case 3:n=(n=e.sent).filter(function(e,t){return n.indexOf(e)===t}),r=a(n),e.prev=6,r.s();case 8:if((i=r.n()).done){e.next=16;break}return o=i.value,e.next=12,this.dataService.get_building(o.Name).toPromise();case 12:s=e.sent,t=t.concat(s.Floors);case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),r.e(e.t0);case 21:return e.prev=21,r.f(),e.finish(21);case 24:return t=t.filter(function(e,n){return t.indexOf(e)===n}),e.next=27,this.modalCtrl.create({component:p.a,cssClass:"floor-modal",componentProps:{floors:t}});case 27:return c=e.sent,e.next=30,c.present();case 30:return e.next=32,c.onDidDismiss();case 32:if(u=e.sent,e.t1=u.data,!e.t1){e.next=37;break}return e.next=37,this.mapView.showAnotherFloorOfCurrentBuilding(u.data,this.mapView.CurrentBuilding);case 37:case"end":return e.stop()}},e,this,[[6,18,21,24]])}))}},{key:"handleInputError",value:function(e,t){if(console.log(e),e instanceof B.d){var n=e;this.errorMessage=400===n.status?"Studi-Guide can't find "+t:n.message}else this.errorMessage=e.message;null!=this.mapView&&this.mapView.clearMapCanvas()}},{key:"navigationBtnClick",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null==this.model.latestSearchResult){t.next=16;break}return t.prev=1,t.next=4,this.dataService.get_location(this.model.latestSearchResult.Name).toPromise();case 4:return n=t.sent,t.next=7,this.showNavigation(n.Building+".Entrance",n.Name);case 7:t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),r="",t.t0 instanceof B.d&&t.t0.error.message.includes(this.model.latestSearchResult.Name)&&(r=this.model.latestSearchResult.Name),this.handleInputError(t.t0,0===r.length?this.model.latestSearchResult.Name:r);case 13:return t.prev=13,e.progressIsVisible=!1,t.finish(13);case 16:case"end":return t.stop()}},t,this,[[1,9,13,16]])}))}},{key:"showNavigation",value:function(e,t){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.searchInput.showRouteSearchBar(),this.searchInput.setDiscoverySearchbarValue(t),this.searchInput.setStartSearchbarValue(e),n.next=5,this.onCloseLocationDrawer(null);case 5:return n.next=7,this.onRoute([e,t]);case 7:case"end":return n.stop()}},n,this)}))}},{key:"showDiscoveryMode",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null==this.mapView.CurrentRoute&&null==this.mapView.CurrentBuilding,!e.t0){e.next=5;break}return e.next=4,this.mapView.showDiscoveryMap("","EG");case 4:this.mapView.CenterMap(310,550);case 5:case"end":return e.stop()}},e,this)}))}},{key:"recentSearchClick",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.router.navigate(["tabs/navigation/detail"],{queryParams:{location:e}});case 2:case"end":return t.stop()}},t,this)}))}},{key:"presentMapPage",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.router.navigate(["tabs/navigation/"]);case 2:case"end":return e.stop()}},e,this)}))}},{key:"ProgressIsVisible",get:function(){return e.progressIsVisible}}]),e}()).progressIsVisible=!1,se.\u0275fac=function(e){return new(e||se)(g.Hb(v.a),g.Hb(l.Y),g.Hb(h.a),g.Hb(h.g),g.Hb(U.b),g.Hb(Y),g.Hb(l.ab))},se.\u0275cmp=g.Bb({type:se,selectors:[["app-navigation"]],viewQuery:function(e,t){var n;1&e&&(g.rc(J,!0),g.rc(z,!0),g.rc($,!0),g.rc(Q,!0),g.rc(ee,!0)),2&e&&(g.fc(n=g.Xb())&&(t.mapView=n.first),g.fc(n=g.Xb())&&(t.searchInput=n.first),g.fc(n=g.Xb())&&(t.drawerContent=n.first),g.fc(n=g.Xb())&&(t.searchDrawer=n.first),g.fc(n=g.Xb())&&(t.locationDrawer=n.first))},decls:72,vars:7,consts:function(){return[["translucent",""],["slot","start"],["id","close-open-map","defaultHref","/"],["data-tap-disabled","true","scroll-y","false"],["type","indeterminate","color","secondary",4,"ngIf"],["id","map-content"],["id","error-message",4,"ngIf"],[3,"locationClick"],[3,"stateChange"],["searchDrawer",""],[1,"nav-bottom-drawer"],[1,"drawer-grip"],[1,"ion-padding-top"],[1,"nav-hbar"],[3,"discovery","route"],["drawerContent",""],["shape","round",1,"square-md","ion-no-padding",3,"click"],["slot","icon-only","name","business-outline","size","large"],["shape","round","color","medium",1,"square-md","ion-no-padding",3,"click"],["slot","icon-only","name","layers-outline","size","large"],["shape","round","color","dark",1,"square-md","ion-no-padding"],["slot","icon-only","name","library-outline","size","large"],[1,"ion-no-padding"],["button","",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"ion-padding-vertical"],["state","DrawerState.Hidden"],["locationDrawer",""],[1,"ion-padding-bottom"],["id","locationdrawerContent"],[1,"ion-justify-content-between","ion-align-self-center"],["size","auto"],["id","locationdrawerName"],[1,"ion-justify-content-end","ion-padding-horizontal"],["shape","round","color","medium",1,"square-sm","ion-no-padding","ion-float-right",3,"click"],["slot","icon-only","name","close-outline","size","small"],["id","routeBtn","color","primary","expand","block",3,"click"],["type","indeterminate","color","secondary"],["id","error-message"],[1,"error"],"Make sure your search is spelled correctly.","Should this place be on Studi-Guide? " + "\ufffd#8\ufffd\ufffd/#8\ufffd" + "" + "\ufffd#9\ufffd" + "Request a missing place" + "\ufffd/#9\ufffd" + "",["href","https://github.com/Studi-Guide/Studi-Guide/issues/new/choose"],["button","",3,"click"]]},template:function(e,t){1&e&&(g.Kb(0,"ion-header",0),g.Kb(1,"ion-toolbar"),g.Kb(2,"ion-buttons",1),g.Ib(3,"ion-back-button",2),g.Jb(),g.Jb(),g.Jb(),g.Kb(4,"ion-content",3),g.mc(5,te,1,0,"ion-progress-bar",4),g.Kb(6,"div",5),g.mc(7,ne,10,1,"ion-text",6),g.Kb(8,"app-map-view",7),g.Wb("locationClick",function(e){return t.showLocationDrawer(e)}),g.Jb(),g.Jb(),g.Jb(),g.Kb(9,"app-ionic-bottom-drawer",8,9),g.Wb("stateChange",function(e){return t.onDrawerStateChange(e)}),g.Kb(11,"div",10),g.Kb(12,"div",11),g.Ib(13,"div",12),g.Ib(14,"div",13),g.Kb(15,"app-search-input",14),g.Wb("discovery",function(e){return t.onDiscovery(e)})("route",function(e){return t.onRoute(e)}),g.Jb(),g.Jb(),g.Kb(16,"ion-content",null,15),g.Kb(18,"ion-grid"),g.Kb(19,"ion-list-header"),g.nc(20,"Current Campus"),g.Jb(),g.Kb(21,"ion-row"),g.Kb(22,"ion-col"),g.Kb(23,"ion-button",16),g.Wb("click",function(){return t.presentMapPage()}),g.Ib(24,"ion-icon",17),g.Jb(),g.Jb(),g.Kb(25,"ion-col"),g.Kb(26,"ion-button",18),g.Wb("click",function(){return t.presentAvailableFloorModal()}),g.Ib(27,"ion-icon",19),g.Jb(),g.Jb(),g.Kb(28,"ion-col"),g.Kb(29,"ion-button",20),g.Ib(30,"ion-icon",21),g.Jb(),g.Jb(),g.Ib(31,"ion-col"),g.Jb(),g.Jb(),g.Kb(32,"ion-list",22),g.Kb(33,"ion-list-header"),g.nc(34," Recent Searches "),g.Jb(),g.mc(35,re,4,1,"ion-item",23),g.Jb(),g.Kb(36,"ion-list",22),g.Kb(37,"ion-list-header"),g.nc(38," Choose a Campus "),g.Jb(),g.mc(39,ie,6,3,"ion-item",24),g.Jb(),g.Ib(40,"div",25),g.Ib(41,"div",25),g.Ib(42,"div",25),g.Ib(43,"div",25),g.Ib(44,"div",25),g.Ib(45,"div",25),g.Jb(),g.Jb(),g.Jb(),g.Kb(46,"app-ionic-bottom-drawer",26,27),g.Kb(48,"div",10),g.Kb(49,"div",11),g.Ib(50,"div",12),g.Ib(51,"div",13),g.Ib(52,"div",28),g.Jb(),g.Kb(53,"ion-content"),g.Kb(54,"ion-grid",29),g.Kb(55,"ion-row",30),g.Kb(56,"ion-col",31),g.Kb(57,"ion-text",32),g.nc(58),g.Jb(),g.Jb(),g.Kb(59,"ion-col",33),g.Kb(60,"ion-button",34),g.Wb("click",function(e){return t.onCloseLocationDrawer(e)}),g.Ib(61,"ion-icon",35),g.Jb(),g.Jb(),g.Jb(),g.Kb(62,"ion-row"),g.Kb(63,"ion-col"),g.Kb(64,"ion-button",36),g.Wb("click",function(){return t.navigationBtnClick()}),g.nc(65," Route "),g.Jb(),g.Jb(),g.Jb(),g.Kb(66,"ion-row"),g.Kb(67,"ion-col"),g.nc(68,"Description:"),g.Jb(),g.Kb(69,"ion-col"),g.nc(70),g.Jb(),g.Jb(),g.mc(71,oe,5,2,"ion-row",24),g.Jb(),g.Jb(),g.Jb(),g.Jb()),2&e&&(g.xb(5),g.dc("ngIf",t.ProgressIsVisible),g.xb(2),g.dc("ngIf",t.errorMessage),g.xb(28),g.dc("ngForOf",t.model.recentSearches),g.xb(4),g.dc("ngForOf",t.availableCampus),g.xb(19),g.oc(t.model.latestSearchResult.Name),g.xb(12),g.oc(t.model.latestSearchResult.Description),g.xb(1),g.dc("ngForOf",t.model.latestSearchResult.Information))},styles:["#map-content[_ngcontent-%COMP%]{height:100%;width:100%;position:fixed}.error[_ngcontent-%COMP%]{color:red}#error-message[_ngcontent-%COMP%]{margin-left:20px}#available-floors-btn[_ngcontent-%COMP%]{position:fixed;bottom:0;display:block;z-index:10}.center[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;display:block}ion-progress-bar[_ngcontent-%COMP%]{position:absolute;z-index:9999}.vertical-line[_ngcontent-%COMP%]{border-left:2px solid #9d9fa6;height:38px}.nav-hbar[_ngcontent-%COMP%]{border-top:2px solid var(--ion-color-medium,#9d9fa6);border-bottom:2px solid var(--ion-color-medium,#9d9fa6);border-radius:2px;height:0;width:auto;margin:0 45%}.nav-bottom-drawer[_ngcontent-%COMP%]{background-color:#fff;border-top-left-radius:20px;border-top-right-radius:20px;box-shadow:0 4px 8px 0 rgba(0,0,0,.4),0 6px 20px 0 rgba(0,0,0,.29);height:inherit;z-index:1}.square-md[_ngcontent-%COMP%]{height:64px;width:64px}.square-sm[_ngcontent-%COMP%]{height:32px;width:32px}.square-xs[_ngcontent-%COMP%]{height:16px;width:16px}#locationdrawerContent[_ngcontent-%COMP%]{margin-left:30px;margin-right:30px;position:center}#locationdrawerName[_ngcontent-%COMP%]{font-weight:700}"]}),se),de=((ae=function e(){u(this,e)}).\u0275mod=g.Fb({type:ae}),ae.\u0275inj=g.Eb({factory:function(e){return new(e||ae)},imports:[[f.b,l.V]]}),ae),he=c("4R65"),fe=c("Bfh1"),be=c("AytR"),me=((ce=function(){function e(t,n,r){u(this,e),this.locale=t,this.httpClient=n,this.env=r}return d(e,[{key:"GetRoute",value:function(t,n){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.httpClient.get(this.env.serverUrl+e.serverPathPrefix+e.routePath+"?start="+t.lat+","+t.lng+"&end="+n.lat+","+n.lng+"&locale="+this.locale).toPromise();case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,this)}))}},{key:"GetBounds",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.httpClient.get(this.env.serverUrl+e.serverPathPrefix+e.boundsPath).toPromise();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}}]),e}()).serverPathPrefix="/osm",ce.routePath="/route",ce.boundsPath="/bounds",ce.\u0275fac=function(e){return new(e||ce)(g.Sb(g.v),g.Sb(B.b),g.Sb(be.a))},ce.\u0275prov=g.Db({token:ce,factory:ce.\u0275fac,providedIn:"root"}),ce),ve=["ionSlides"];function pe(e,t){if(1&e&&(g.Kb(0,"ion-slide"),g.Kb(1,"ion-text"),g.Kb(2,"h2"),g.nc(3),g.Jb(),g.Kb(4,"p"),g.nc(5),g.Jb(),g.Jb(),g.Jb()),2&e){var n=t.$implicit;g.xb(3),g.oc(n.Text),g.xb(2),g.pc("",n.Distance,"m")}}var ge,ye,we=((ye=function(){function e(t){u(this,e),this.element=t,this.nextSlide=new g.o,this.previousSlide=new g.o,this.slideOpts={initialSlide:0,speed:400}}return d(e,[{key:"ngOnInit",value:function(){this.hide()}},{key:"onPrevSlide",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this.previousSlide,e.next=3,this.ionSlides.getActiveIndex();case 3:e.t1=e.sent,e.t0.emit.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e,this)}))}},{key:"onNextSlide",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this.nextSlide,e.next=3,this.ionSlides.getActiveIndex();case 3:e.t1=e.sent,e.t0.emit.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e,this)}))}},{key:"hide",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.element.nativeElement.hidden=!0;case 1:case"end":return e.stop()}},e,this)}))}},{key:"show",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.element.nativeElement.hidden=!1;case 1:case"end":return e.stop()}},e,this)}))}}]),e}()).\u0275fac=function(e){return new(e||ye)(g.Hb(g.m))},ye.\u0275cmp=g.Bb({type:ye,selectors:[["app-navigation-instruction-slides"]],viewQuery:function(e,t){var n;1&e&&g.rc(ve,!0),2&e&&g.fc(n=g.Xb())&&(t.ionSlides=n.first)},inputs:{instructions:"instructions"},outputs:{nextSlide:"nextSlide",previousSlide:"previousSlide"},decls:3,vars:2,consts:[["pager","true",3,"options","ionSlideNextEnd","ionSlidePrevEnd"],["ionSlides",""],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(g.Kb(0,"ion-slides",0,1),g.Wb("ionSlideNextEnd",function(){return t.onNextSlide()})("ionSlidePrevEnd",function(){return t.onPrevSlide()}),g.mc(2,pe,6,2,"ion-slide",2),g.Jb()),2&e&&(g.dc("options",t.slideOpts),g.xb(2),g.dc("ngForOf",t.instructions))},directives:[l.N,f.i,l.M,l.R],styles:["[_nghost-%COMP%]{z-index:auto}ion-slide[_ngcontent-%COMP%]{height:100%;width:100%}@media (min-width:992px){ion-slide[_ngcontent-%COMP%]{padding-bottom:2em}}@media (max-width:991.98px){ion-slide[_ngcontent-%COMP%]{padding-bottom:.5em}}"]}),ye),xe=((ge=function(){function e(){u(this,e)}return d(e,[{key:"load",value:function(t,n,r){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t.ready().then(function(){return Object(m.a)(o,void 0,void 0,regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.get(e.LAST_MAP_EVENT_KEY).then(function(e){n.setView([49.452368,11.093299],r),null!=e&&n.flyTo(e.center,e.zoom)});case 2:case"end":return i.stop()}},i)}))});case 1:case"end":return i.stop()}},i)}))}}],[{key:"persist",value:function(e,t){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.set(this.LAST_MAP_EVENT_KEY,t);case 2:case"end":return n.stop()}},n,this)}))}}]),e}()).LAST_MAP_EVENT_KEY="lastOpenStreetMapEventTarget",ge.\u0275fac=function(e){return new(e||ge)},ge.\u0275prov=g.Db({token:ge,factory:ge.\u0275fac,providedIn:"root"}),ge),Se=["drawerContent"],ke=["searchDrawer"],Re=["locationDrawer"],Ce=["routeDrawer"],Ie=["inNavigationDrawer"],Me=["searchInput"],Oe=["navSlides"];function Pe(e,t){1&e&&g.Ib(0,"ion-progress-bar",37)}function De(e,t){if(1&e&&(g.Kb(0,"ion-text",38),g.Kb(1,"h5"),g.Kb(2,"span",39),g.nc(3),g.Jb(),g.Jb(),g.Kb(4,"p"),g.Ob(5,40),g.Jb(),g.Kb(6,"p"),g.Rb(7,41),g.Ib(8,"br"),g.Ib(9,"a",42),g.Pb(),g.Jb(),g.Jb()),2&e){var n=g.Yb();g.xb(3),g.oc(n.errorMessage)}}function Ke(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-item",43),g.Wb("click",function(){g.hc(n);var e=t.$implicit;return g.Yb(2).recentSearchClick(e)}),g.Kb(1,"ion-text"),g.nc(2),g.Jb(),g.Jb()}if(2&e){var r=t.$implicit;g.xb(2),g.oc(r)}}function Je(e,t){if(1&e&&(g.Kb(0,"ion-list",17),g.Kb(1,"ion-list-header"),g.Kb(2,"h2"),g.nc(3,"Recent Searches"),g.Jb(),g.Jb(),g.mc(4,Ke,3,1,"ion-item",18),g.Jb()),2&e){var n=g.Yb();g.xb(4),g.dc("ngForOf",n.model.recentSearches)}}function Be(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-item",43),g.Wb("click",function(){g.hc(n);var e=t.$implicit;return g.Yb().onCampusClick(e)}),g.Kb(1,"ion-label"),g.Kb(2,"h2"),g.nc(3),g.Jb(),g.Kb(4,"h3"),g.nc(5),g.Jb(),g.Jb(),g.Jb()}if(2&e){var r=t.$implicit;g.xb(3),g.qc("",r.ShortName,": ",r.Name,""),g.xb(2),g.oc(r.Address)}}function Le(e,t){if(1&e&&(g.Kb(0,"ion-row"),g.Kb(1,"ion-col"),g.nc(2),g.Jb(),g.Kb(3,"ion-col"),g.nc(4),g.Jb(),g.Jb()),2&e){var n=t.$implicit;g.xb(2),g.oc(n[0]),g.xb(2),g.oc(n[1])}}function Fe(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-button",44),g.Wb("click",function(){return g.hc(n),g.Yb().onLaunchNavigation()}),g.nc(1," Go "),g.Jb()}}function Ee(e,t){if(1&e){var n=g.Lb();g.Kb(0,"ion-item",43),g.Wb("click",function(){g.hc(n);var e=t.$implicit;return g.Yb().onNavigationInstructionClick(e)}),g.Kb(1,"ion-label"),g.nc(2),g.Jb(),g.Kb(3,"ion-text"),g.nc(4),g.Jb(),g.Jb()}if(2&e){var r=t.$implicit;g.xb(2),g.oc(r.Text),g.xb(2),g.pc("",r.Distance,"m")}}var Ae=q.a.Keyboard,Ne=he.icon({iconRetinaUrl:"leaflet/marker-icon-2x.png",iconUrl:"leaflet/marker-icon.png",shadowUrl:"leaflet/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});he.Marker.prototype.options.icon=Ne;var _e,Te,je=((Te=function(){function e(t,n,r,i,o,a,s,c,l){u(this,e),this._dataService=t,this.router=n,this.model=r,this.storage=i,this.dataService=o,this.geolocation=a,this.openStreetMapService=s,this.lastOpenStreetMapCenterPersistence=c,this.platform=l,this.searchMarker=[],this.routes=[],this.availableCampus=[],this.progressIsVisible=!1,this.currentPositionMarker=null,this.isInitialized=!1,this.DEFAULT_ZOOM=17,this.MAX_ZOOM=18,this.MIN_ZOOM=14,this.isHybridPlatform=this.platform.is("hybrid")}return d(e,[{key:"ngOnInit",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.model.recentSearches&&0!==this.model.recentSearches.length){e.next=5;break}return e.next=3,Z.readRecentSearch(this.storage);case 3:null!==(t=e.sent)&&(this.model.recentSearches=t,console.log(this.model.recentSearches));case 5:if(e.t0=this.model.availableCampus&&0!==this.model.availableCampus.length,e.t0){e.next=10;break}return e.next=9,this.dataService.get_campus_search().toPromise();case 9:this.model.availableCampus=e.sent;case 10:if(!this.model.availableCampus){e.next=13;break}n=a(this.model.availableCampus);try{for(n.s();!(r=n.n()).done;)i=r.value,this.availableCampus.push(new H(i))}catch(o){n.e(o)}finally{n.f()}case 13:return e.next=15,Promise.all([this.searchDrawer.SetState(G.a.GetRecommendedDrawerStateForDevice()),this.locationDrawer.SetState(W.a.Hidden),this.routeDrawer.SetState(W.a.Hidden),this.inNavigationDrawer.SetState(W.a.Hidden)]);case 15:case"end":return e.stop()}},e,this)}))}},{key:"ionViewDidEnter",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.isInitialized,e.t0){e.next=5;break}return e.next=4,this.initializeMap(this.router);case 4:this.isInitialized=!0;case 5:return e.prev=5,e.next=8,this.geolocation.getCurrentPosition();case 8:t=e.sent,null===this.currentPositionMarker?this.currentPositionMarker=he.marker([t.coords.latitude,t.coords.longitude]).addTo(this.map).bindPopup("Position"):this.currentPositionMarker.setLatLng([t.coords.latitude,t.coords.longitude]),e.next=15;break;case 12:e.prev=12,e.t1=e.catch(5),console.log("Error getting location",e.t1);case 15:case"end":return e.stop()}},e,this,[[5,12]])}))}},{key:"initializeMap",value:function(t){var n;return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){var i,o,s,c,u,l,d,h,f,b=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return l=function(e){t.navigate(["tabs/navigation/detail"],{queryParams:{building:e.target.options.className}}).then(function(){return console.log(e.latlng,e.target.options.className)})},r.next=3,this.openStreetMapService.GetBounds();case 3:return i=r.sent,o=he.latLng(i.SouthWest.Lat,i.SouthWest.Lng),s=he.latLng(i.NorthEast.Lat,i.NorthEast.Lng),c=he.latLngBounds(o,s),console.log(i,c),this.map=he.map("leafletMap",{maxBounds:c,maxZoom:this.MAX_ZOOM,minZoom:this.MIN_ZOOM,zoomControl:!this.platform.is("hybrid")}),this.map.on("moveend",function(e){xe.persist(b.storage,{center:e.target.getCenter(),zoom:e.target.getZoom()})}),r.next=12,this.lastOpenStreetMapCenterPersistence.load(this.storage,this.map,this.DEFAULT_ZOOM);case 12:if(he.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"edupala.com \xa9 Angular LeafLet"}).addTo(this.map),r.t0=this.platform.is("hybrid"),!r.t0){r.next=18;break}return r.next=17,this.delay(500);case 17:this.map.invalidateSize();case 18:return r.next=20,this._dataService.get_buildings_search().toPromise();case 20:if(null!==(u=r.sent)){d=a(u);try{for(d.s();!(h=d.n()).done;)null!==(f=h.value).Body&&f.Body.length>0&&he.polygon(e.convertToLeafLetCoordinates(f.Body),{className:f.Name,color:null!==(n=f.Color)&&void 0!==n?n:"#0083C6"}).addTo(this.map).on("click",l)}catch(m){d.e(m)}finally{d.f()}}case 22:case"end":return r.stop()}},r,this)}))}},{key:"ngOnDestroy",value:function(){this.map.remove()}},{key:"onSearch",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,o,s,c,u,l,d,h,f,b,m,v,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.model.errorMessage="",this.progressIsVisible=!0,t.prev=1,this.clearSearchMarkers(),t.prev=3,t.next=6,this.dataService.get_location(e).toPromise();case 6:if(!(n=t.sent)){t.next=18;break}return t.next=10,this.dataService.get_building(n.Building).toPromise();case 10:return r=t.sent,i=this.getCenterCoordinateFromBody(r.Body),this.model.SetLocationAsSearchResultObject(n,{lat:i.Latitude,lng:i.Longitude}),this.searchMarker.push(this.showMarker(i.Latitude,i.Longitude,"Room "+n.Name,!0)),this.map.flyTo(this.model.latestSearchResult.LatLng,this.DEFAULT_ZOOM),t.next=17,this.showElementDrawer();case 17:return t.abrupt("return",void Z.addRecentSearch(e,this.model,this.storage));case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(3),console.log(t.t0);case 23:return t.prev=23,t.next=26,this.dataService.get_building(e,!1).toPromise();case 26:if(!(o=t.sent)){t.next=35;break}return s=this.getCenterCoordinateFromBody(o.Body),this.model.SetBuildingAsSearchResultObject(o,{lat:s.Latitude,lng:s.Longitude}),this.map.flyTo(this.model.latestSearchResult.LatLng,this.DEFAULT_ZOOM),this.searchMarker.push(this.showMarker(s.Latitude,s.Longitude,"Building "+o.Name,!0)),t.next=34,this.showElementDrawer();case 34:return t.abrupt("return",void Z.addRecentSearch(e,this.model,this.storage));case 35:t.next=40;break;case 37:t.prev=37,t.t1=t.catch(23),console.log(t.t1);case 40:return t.prev=40,t.next=43,this.dataService.get_campus(e,!1).toPromise();case 43:if(!(c=t.sent)){t.next=51;break}return this.model.SetCampusAsSearchResultObject(c),this.searchMarker.push(this.showMarker(c.Latitude,c.Longitude,"Campus "+c.Name,!0)),this.map.flyTo([c.Latitude,c.Longitude],this.DEFAULT_ZOOM),t.next=50,this.showElementDrawer();case 50:return t.abrupt("return",void Z.addRecentSearch(e,this.model,this.storage));case 51:t.next=56;break;case 53:t.prev=53,t.t2=t.catch(40),console.log(t.t2);case 56:return t.next=58,this.dataService.get_buildings_search(e).toPromise();case 58:if(!(null!==(u=t.sent)&&u.length>0)){t.next=65;break}Z.addRecentSearch(e,this.model,this.storage),l=a(u);try{for(l.s();!(d=l.n()).done;)h=d.value,f=this.getCenterCoordinateFromBody(h.Body),this.searchMarker.push(this.showMarker(f.Latitude,f.Longitude,h.Name,!1))}catch(g){l.e(g)}finally{l.f()}t.next=69;break;case 65:return t.next=67,this.dataService.get_campus_search(e).toPromise();case 67:if(null!==(b=t.sent)&&b.length>0){Z.addRecentSearch(e,this.model,this.storage),m=a(b);try{for(m.s();!(v=m.n()).done;)p=v.value,this.searchMarker.push(this.showMarker(p.Latitude,p.Longitude,p.Name,!1))}catch(g){m.e(g)}finally{m.f()}}case 69:t.next=74;break;case 71:t.prev=71,t.t3=t.catch(1),this.handleInputError(t.t3,e);case 74:return t.prev=74,this.progressIsVisible=!1,t.finish(74);case 77:case"end":return t.stop()}},t,this,[[1,71,74,77],[3,20],[23,37],[40,53]])}))}},{key:"onRoute",value:function(e){}},{key:"recentSearchClick",value:function(e){}},{key:"onDrawerStateChange",value:function(e){void 0!==this.drawerContent&&(this.drawerContent.scrollY=e===W.a.Top)}},{key:"onCloseLocationDrawer",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.searchInput.clearDestinationInput(),e.next=3,this.locationDrawer.SetState(W.a.Hidden);case 3:return e.next=5,this.searchDrawer.SetState(G.a.GetRecommendedDrawerStateForDevice());case 5:this.clearSearchMarkers();case 6:case"end":return e.stop()}},e,this)}))}},{key:"onCloseRouteDrawer",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.clearRoutes(),e.next=3,this.routeDrawer.SetState(W.a.Hidden);case 3:return e.next=5,this.locationDrawer.SetState(G.a.GetRecommendedDrawerStateForDevice());case 5:this.map.flyTo(this.model.latestSearchResult.LatLng,this.DEFAULT_ZOOM);case 6:case"end":return e.stop()}},e,this)}))}},{key:"showElementDrawer",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.isHybridPlatform,!e.t0){e.next=4;break}return e.next=4,Ae.hide();case 4:return e.next=6,this.searchDrawer.SetState(W.a.Hidden);case 6:return e.next=8,this.locationDrawer.SetState(G.a.GetRecommendedDrawerStateForDevice());case 8:case"end":return e.stop()}},e,this)}))}},{key:"onCampusClick",value:function(e){this.map.flyTo(e.LatLng,this.DEFAULT_ZOOM)}},{key:"onRouteBtnClick",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.geolocation.getCurrentPosition();case 2:return t=e.sent,console.log(t),e.next=6,this.openStreetMapService.GetRoute({lat:t.coords.latitude,lng:t.coords.longitude},this.model.latestSearchResult.LatLng);case 6:return n=e.sent,console.log(n),this.model.SetGraphHopperRouteAsRoute(n[0]),e.next=11,this.locationDrawer.SetState(W.a.Hidden);case 11:return e.next=13,this.routeDrawer.SetState(G.a.GetRecommendedDrawerStateForDevice());case 13:return r=he.polyline(this.model.Route.Coordinates,{color:"red"}).addTo(this.map),this.map.flyTo(r.getCenter(),this.DEFAULT_ZOOM),e.next=17,this.map.fitBounds(r.getBounds());case 17:this.routes.push(r);case 18:case"end":return e.stop()}},e,this)}))}},{key:"onLaunchNavigation",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.routeDrawer.SetState(W.a.Hidden);case 2:return this.navSlides.instructions=this.model.Route.NavigationInstructions,this.navSlides.show(),e.next=6,this.inNavigationDrawer.SetState(G.a.GetRecommendedDrawerStateForDevice());case 6:this.map.flyTo(this.model.Route.Coordinates[this.model.Route.NavigationInstructions[0].Interval[0]],this.MAX_ZOOM);case 7:case"end":return e.stop()}},e,this)}))}},{key:"onSlideChange",value:function(e){this.onNavigationInstructionClick(this.model.Route.NavigationInstructions[e])}},{key:"onEndRouteClick",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.inNavigationDrawer.SetState(W.a.Hidden);case 2:return e.next=4,this.locationDrawer.SetState(G.a.GetRecommendedDrawerStateForDevice());case 4:this.clearRoutes(),this.map.flyTo(this.model.latestSearchResult.LatLng,this.DEFAULT_ZOOM);case 6:case"end":return e.stop()}},e,this)}))}},{key:"detailsBtnClick",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.router.navigate(["tabs/navigation/detail"],{queryParams:0===this.routes.length?this.model.latestSearchResult.DetailRouterParams:this.model.latestSearchResult.RouteRouterParams});case 2:case"end":return e.stop()}},e,this)}))}},{key:"onNavigationInstructionClick",value:function(e){this.map.flyTo(this.model.Route.Coordinates[e.Interval[0]],this.MAX_ZOOM)}},{key:"handleInputError",value:function(e,t){if(e instanceof B.d){var n=e;this.errorMessage=400===n.status?"Studi-Guide can't find "+t:n.message}else this.errorMessage=e.message}},{key:"showMarker",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3?arguments[3]:void 0,i=he.marker([e,t]).addTo(this.map);return n?r?i.bindPopup(n).openPopup():i.bindPopup(n):i}},{key:"getCenterCoordinateFromBody",value:function(e){var t,n=[],r=a(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push([i.Latitude,i.Longitude])}}catch(c){r.e(c)}finally{r.f()}var o=new he.Polygon(n).addTo(this.map),s={Longitude:o.getCenter().lng,Latitude:o.getCenter().lat};return o.remove(),s}},{key:"clearSearchMarkers",value:function(){var e,t=a(this.searchMarker);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.map.removeLayer(n)}}catch(r){t.e(r)}finally{t.f()}}},{key:"clearRoutes",value:function(){var e,t=a(this.routes);try{for(t.s();!(e=t.n()).done;)e.value.remove()}catch(n){t.e(n)}finally{t.f()}this.routes=[],this.navSlides.hide()}},{key:"UseDrawerForNavigation",value:function(){return!(G.a.GetRecommendedDrawerStateForDevice()===W.a.Bottom)}},{key:"delay",value:function(e){return new Promise(function(t){return setTimeout(t,e)})}},{key:"onSearchFocus",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.platform.is("hybrid"),!e.t0){e.next=4;break}return e.next=4,this.searchDrawer.SetState(W.a.Top);case 4:case"end":return e.stop()}},e,this)}))}}],[{key:"convertToLeafLetCoordinates",value:function(e){var t,n=[],r=a(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push({lat:i.Latitude,lng:i.Longitude})}}catch(o){r.e(o)}finally{r.f()}return n}}]),e}()).\u0275fac=function(e){return new(e||Te)(g.Hb(v.a),g.Hb(h.g),g.Hb(Y),g.Hb(U.b),g.Hb(v.a),g.Hb(fe.a),g.Hb(me),g.Hb(xe),g.Hb(l.ab))},Te.\u0275cmp=g.Bb({type:Te,selectors:[["app-map-page"]],viewQuery:function(e,t){var n;1&e&&(g.rc(Se,!0),g.rc(ke,!0),g.rc(Re,!0),g.rc(Ce,!0),g.rc(Ie,!0),g.rc(Me,!0),g.rc(Oe,!0)),2&e&&(g.fc(n=g.Xb())&&(t.drawerContent=n.first),g.fc(n=g.Xb())&&(t.searchDrawer=n.first),g.fc(n=g.Xb())&&(t.locationDrawer=n.first),g.fc(n=g.Xb())&&(t.routeDrawer=n.first),g.fc(n=g.Xb())&&(t.inNavigationDrawer=n.first),g.fc(n=g.Xb())&&(t.searchInput=n.first),g.fc(n=g.Xb())&&(t.navSlides=n.first))},decls:112,vars:14,consts:function(){return[[3,"nextSlide","previousSlide"],["navSlides",""],["data-tap-disabled","true","scroll-y","false"],["type","indeterminate","color","secondary",4,"ngIf"],["id","map-content"],["id","error-message",4,"ngIf"],["id","leafletMap"],["id","searchDrawer",3,"stateChange"],["searchDrawer",""],[1,"nav-bottom-drawer"],[1,"drawer-grip"],[1,"ion-padding-top"],[1,"nav-hbar"],[3,"discovery","route","searchBarFocus"],["searchInput",""],["drawerContent",""],["class","ion-no-padding",4,"ngIf"],[1,"ion-no-padding"],["button","",3,"click",4,"ngFor","ngForOf"],[1,"ion-padding-vertical"],["id","locationDrawer","state","DrawerState.Hidden"],["locationDrawer",""],[1,"ion-padding-bottom"],["id","locationdrawerContent"],[1,"ion-justify-content-between","ion-align-self-center"],[1,"ion-justify-content-end","ion-padding-horizontal"],["shape","round","color","medium",1,"square-sm","ion-no-padding","ion-float-right",3,"click"],["slot","icon-only","name","close-outline","size","small"],["color","primary","expand","block",3,"click"],["id","routeBtn","color","primary","expand","block",3,"click"],[4,"ngFor","ngForOf"],["id","routeDrawer","state","DrawerState.Hidden"],["routeDrawer",""],["color","success","expand","block",3,"click",4,"ngIf"],["id","inNavigationDrawer","state","DrawerState.Hidden"],["inNavigationDrawer",""],["color","danger","expand","block",3,"click"],["type","indeterminate","color","secondary"],["id","error-message"],[1,"error"],"Make sure your search is spelled correctly.","Should this place be on Studi-Guide? " + "\ufffd#8\ufffd\ufffd/#8\ufffd" + "" + "\ufffd#9\ufffd" + "Request a missing place" + "\ufffd/#9\ufffd" + "",["href","https://github.com/Studi-Guide/Studi-Guide/issues/new/choose"],["button","",3,"click"],["color","success","expand","block",3,"click"]]},template:function(e,t){1&e&&(g.Kb(0,"app-navigation-instruction-slides",0,1),g.Wb("nextSlide",function(e){return t.onSlideChange(e)})("previousSlide",function(e){return t.onSlideChange(e)}),g.Jb(),g.Kb(2,"ion-content",2),g.mc(3,Pe,1,0,"ion-progress-bar",3),g.Kb(4,"div",4),g.mc(5,De,10,1,"ion-text",5),g.Ib(6,"div",6),g.Jb(),g.Jb(),g.Kb(7,"app-ionic-bottom-drawer",7,8),g.Wb("stateChange",function(e){return t.onDrawerStateChange(e)}),g.Kb(9,"div",9),g.Kb(10,"div",10),g.Ib(11,"div",11),g.Ib(12,"div",12),g.Jb(),g.Kb(13,"app-search-input",13,14),g.Wb("discovery",function(e){return t.onSearch(e)})("route",function(e){return t.onRoute(e)})("searchBarFocus",function(e){return t.onSearchFocus(e)}),g.Jb(),g.Kb(15,"ion-content",null,15),g.mc(17,Je,5,1,"ion-list",16),g.Kb(18,"ion-list",17),g.Kb(19,"ion-list-header"),g.Kb(20,"h2"),g.nc(21,"Choose a Campus"),g.Jb(),g.Jb(),g.mc(22,Be,6,3,"ion-item",18),g.Jb(),g.Ib(23,"div",19),g.Ib(24,"div",19),g.Ib(25,"div",19),g.Ib(26,"div",19),g.Ib(27,"div",19),g.Ib(28,"div",19),g.Jb(),g.Jb(),g.Jb(),g.Kb(29,"app-ionic-bottom-drawer",20,21),g.Kb(31,"div",9),g.Kb(32,"div",10),g.Ib(33,"div",11),g.Ib(34,"div",12),g.Ib(35,"div",22),g.Jb(),g.Kb(36,"ion-content"),g.Kb(37,"ion-grid",23),g.Kb(38,"ion-row",24),g.Kb(39,"ion-col"),g.Kb(40,"ion-label"),g.Kb(41,"h1"),g.nc(42),g.Jb(),g.Jb(),g.Kb(43,"ion-text"),g.nc(44),g.Jb(),g.Jb(),g.Kb(45,"ion-col",25),g.Kb(46,"ion-button",26),g.Wb("click",function(e){return t.onCloseLocationDrawer(e)}),g.Ib(47,"ion-icon",27),g.Jb(),g.Jb(),g.Jb(),g.Kb(48,"ion-row"),g.Kb(49,"ion-col"),g.Kb(50,"ion-button",28),g.Wb("click",function(){return t.detailsBtnClick()}),g.nc(51," Details "),g.Jb(),g.Jb(),g.Kb(52,"ion-col"),g.Kb(53,"ion-button",29),g.Wb("click",function(){return t.onRouteBtnClick()}),g.nc(54," Route "),g.Jb(),g.Jb(),g.Jb(),g.mc(55,Le,5,2,"ion-row",30),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Kb(56,"app-ionic-bottom-drawer",31,32),g.Kb(58,"div",9),g.Kb(59,"div",10),g.Ib(60,"div",11),g.Ib(61,"div",12),g.Ib(62,"div",22),g.Kb(63,"ion-grid"),g.Kb(64,"ion-row",24),g.Kb(65,"ion-col"),g.Kb(66,"ion-label"),g.Kb(67,"h1"),g.nc(68),g.Jb(),g.Jb(),g.Kb(69,"ion-text"),g.nc(70,"From My Location"),g.Jb(),g.Jb(),g.Kb(71,"ion-col",25),g.Kb(72,"ion-button",26),g.Wb("click",function(e){return t.onCloseRouteDrawer(e)}),g.Ib(73,"ion-icon",27),g.Jb(),g.Jb(),g.Jb(),g.Kb(74,"ion-row"),g.Kb(75,"ion-col"),g.Kb(76,"ion-label"),g.Kb(77,"h2"),g.nc(78),g.Jb(),g.Jb(),g.Kb(79,"ion-text"),g.nc(80),g.Jb(),g.Jb(),g.Kb(81,"ion-col"),g.mc(82,Fe,2,0,"ion-button",33),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Kb(83,"ion-content"),g.Kb(84,"ion-list"),g.mc(85,Ee,5,2,"ion-item",18),g.Jb(),g.Ib(86,"div",19),g.Ib(87,"div",19),g.Ib(88,"div",19),g.Ib(89,"div",19),g.Ib(90,"div",19),g.Ib(91,"div",19),g.Ib(92,"div",19),g.Ib(93,"div",19),g.Jb(),g.Jb(),g.Jb(),g.Kb(94,"app-ionic-bottom-drawer",34,35),g.Kb(96,"div",9),g.Kb(97,"div",10),g.Ib(98,"div",11),g.Ib(99,"div",12),g.Ib(100,"div",22),g.Kb(101,"ion-grid"),g.Kb(102,"ion-row"),g.Kb(103,"ion-col"),g.Kb(104,"ion-label"),g.Kb(105,"h2"),g.nc(106),g.Jb(),g.Jb(),g.Kb(107,"ion-text"),g.nc(108),g.Jb(),g.Jb(),g.Kb(109,"ion-col"),g.Kb(110,"ion-button",36),g.Wb("click",function(){return t.onEndRouteClick()}),g.nc(111," End Route "),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Jb(),g.Jb()),2&e&&(g.xb(3),g.dc("ngIf",t.progressIsVisible),g.xb(2),g.dc("ngIf",t.errorMessage),g.xb(12),g.dc("ngIf",t.model.recentSearches.length>0),g.xb(5),g.dc("ngForOf",t.availableCampus),g.xb(20),g.oc(t.model.latestSearchResult.Name),g.xb(2),g.oc(t.model.latestSearchResult.Description),g.xb(11),g.dc("ngForOf",t.model.latestSearchResult.Information),g.xb(13),g.pc("To ",t.model.latestSearchResult.Name,""),g.xb(10),g.pc("",t.model.Route.Time," min"),g.xb(2),g.pc("",t.model.Route.Distance," m"),g.xb(2),g.dc("ngIf",!t.UseDrawerForNavigation()),g.xb(3),g.dc("ngForOf",t.model.Route.NavigationInstructions),g.xb(21),g.pc("",t.model.Route.Time," min"),g.xb(2),g.pc("",t.model.Route.Distance," m"))},directives:[we,l.p,f.j,G.a,z,l.B,l.C,f.i,l.u,l.I,l.o,l.A,l.R,l.h,l.w,l.E,l.y],styles:["#map-content[_ngcontent-%COMP%]{height:100%;width:100%;position:fixed}.error[_ngcontent-%COMP%]{color:red}#error-message[_ngcontent-%COMP%]{margin-left:20px}#leafletMap[_ngcontent-%COMP%]{height:100%;width:100%;z-index:0}#leafletMap[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}#available-floors-btn[_ngcontent-%COMP%]{position:fixed;bottom:0;display:block;z-index:10}.draggable[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.center[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;display:block}ion-progress-bar[_ngcontent-%COMP%]{position:absolute;z-index:9999}.vertical-line[_ngcontent-%COMP%]{border-left:2px solid #9d9fa6;height:38px}.nav-hbar[_ngcontent-%COMP%]{border-top:2px solid var(--ion-color-medium,#9d9fa6);border-bottom:2px solid var(--ion-color-medium,#9d9fa6);border-radius:2px;height:0;width:auto;margin:0 45%}.nav-bottom-drawer[_ngcontent-%COMP%]{background-color:var(--ion-color-white,#fff);border-top-left-radius:20px;border-top-right-radius:20px;box-shadow:0 4px 8px 0 rgba(0,0,0,.4),0 6px 20px 0 rgba(0,0,0,.29);height:inherit}.square-md[_ngcontent-%COMP%]{height:64px;width:64px}.square-sm[_ngcontent-%COMP%]{height:32px;width:32px}.square-xs[_ngcontent-%COMP%]{height:16px;width:16px}#locationdrawerContent[_ngcontent-%COMP%]{margin-left:30px;margin-right:30px;position:center}#locationdrawerName[_ngcontent-%COMP%]{font-weight:700}#inNavigationDrawer[_ngcontent-%COMP%]{z-index:1}#locationDrawer[_ngcontent-%COMP%]{z-index:2}#routeDrawer[_ngcontent-%COMP%]{z-index:3}#searchDrawer[_ngcontent-%COMP%]{z-index:4}"]}),Te),Ve=((_e=function e(){u(this,e)}).\u0275mod=g.Fb({type:_e}),_e.\u0275inj=g.Eb({factory:function(e){return new(e||_e)},imports:[[l.V,f.b,b.a,h.i.forChild([{path:"detail",component:le},{path:"",component:je}]),de]]}),_e);g.kc(le,[l.v,l.U,l.i,l.f,l.g,l.p,f.j,l.E,l.R,J,G.a,z,l.u,l.C,l.I,l.o,l.h,l.w,l.B,f.i,l.y,l.A],[])},wyfB:function(e,t){function n(e){return e&&e.ownerSVGElement&&e.getCTM}e.exports=function(e,t){if(!n(e))throw new Error("svg element is required for svg.panzoom to work");var r=e.ownerSVGElement;if(!r)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");return t.disableKeyboardInteraction||r.setAttribute("tabindex",0),{getBBox:function(){var t=e.getBBox();return{left:t.x,top:t.y,width:t.width,height:t.height}},getScreenCTM:function(){return r.getCTM()||r.getScreenCTM()},getOwner:function(){return r},applyTransform:function(t){e.setAttribute("transform","matrix("+t.scale+" 0 0 "+t.scale+" "+t.x+" "+t.y+")")},initTransform:function(t){var n=e.getCTM();null===n&&(n=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),t.x=n.e,t.y=n.f,t.scale=n.a,r.removeAttributeNS(null,"viewBox")}}},e.exports.canAttach=n}}])}();